diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/at90c8534/Makefile.am avr-libc-r2546/avr/lib/avr2/at90c8534/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/at90c8534/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/at90c8534/Makefile.am	2018-05-22 09:17:47.129986900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90c8534.a
-nodist_libat90c8534_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90c8534_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/at90s1200/Makefile.am avr-libc-r2546/avr/lib/avr2/at90s1200/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/at90s1200/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/at90s1200/Makefile.am	2018-05-22 09:17:46.058692400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s1200.a
-nodist_libat90s1200_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s1200_a_SOURCES =   \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/at90s4414/Makefile.am avr-libc-r2546/avr/lib/avr2/at90s4414/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/at90s4414/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/at90s4414/Makefile.am	2018-05-22 09:17:46.668472300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s4414.a
-nodist_libat90s4414_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s4414_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/at90s4434/Makefile.am avr-libc-r2546/avr/lib/avr2/at90s4434/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/at90s4434/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/at90s4434/Makefile.am	2018-05-22 09:17:46.784086300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s4434.a
-nodist_libat90s4434_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s4434_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/at90s8515/Makefile.am avr-libc-r2546/avr/lib/avr2/at90s8515/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/at90s8515/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/at90s8515/Makefile.am	2018-05-22 09:17:46.900208900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s8515.a
-nodist_libat90s8515_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s8515_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/at90s8535/Makefile.am avr-libc-r2546/avr/lib/avr2/at90s8535/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/at90s8535/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/at90s8535/Makefile.am	2018-05-22 09:17:47.014736900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s8535.a
-nodist_libat90s8535_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s8535_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/attiny11/Makefile.am avr-libc-r2546/avr/lib/avr2/attiny11/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/attiny11/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/attiny11/Makefile.am	2018-05-22 09:17:46.184165300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny11.a
-nodist_libattiny11_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny11_a_SOURCES =   \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/attiny12/Makefile.am avr-libc-r2546/avr/lib/avr2/attiny12/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/attiny12/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/attiny12/Makefile.am	2018-05-22 09:17:46.306003900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny12.a
-nodist_libattiny12_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny12_a_SOURCES =   \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/attiny15/Makefile.am avr-libc-r2546/avr/lib/avr2/attiny15/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/attiny15/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/attiny15/Makefile.am	2018-05-22 09:17:46.431071500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny15.a
-nodist_libattiny15_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny15_a_SOURCES =   \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/attiny28/Makefile.am avr-libc-r2546/avr/lib/avr2/attiny28/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/attiny28/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/attiny28/Makefile.am	2018-05-22 09:17:46.554294400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny28.a
-nodist_libattiny28_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny28_a_SOURCES =   \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2313/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2313/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2313/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2313/Makefile.am	2018-05-22 09:17:47.842211400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s2313.a
-nodist_libat90s2313_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s2313_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2323/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2323/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2323/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2323/Makefile.am	2018-05-22 09:17:47.957454300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s2323.a
-nodist_libat90s2323_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s2323_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2333/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2333/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2333/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2333/Makefile.am	2018-05-22 09:17:48.072696600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s2333.a
-nodist_libat90s2333_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s2333_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2343/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2343/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s2343/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s2343/Makefile.am	2018-05-22 09:17:48.187514700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s2343.a
-nodist_libat90s2343_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s2343_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s4433/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s4433/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/at90s4433/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/at90s4433/Makefile.am	2018-05-22 09:17:48.302514000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90s4433.a
-nodist_libat90s4433_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90s4433_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/attiny22/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/attiny22/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/attiny22/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/attiny22/Makefile.am	2018-05-22 09:17:48.418376200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny22.a
-nodist_libattiny22_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny22_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/attiny26/Makefile.am avr-libc-r2546/avr/lib/avr2/tiny-stack/attiny26/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr2/tiny-stack/attiny26/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr2/tiny-stack/attiny26/Makefile.am	2018-05-22 09:17:48.533276500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny26.a
-nodist_libattiny26_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny26_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/at86rf401/Makefile.am avr-libc-r2546/avr/lib/avr25/at86rf401/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/at86rf401/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/at86rf401/Makefile.am	2018-05-22 09:17:49.133376300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat86rf401.a
-nodist_libat86rf401_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat86rf401_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/ata5272/Makefile.am avr-libc-r2546/avr/lib/avr25/ata5272/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/ata5272/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/ata5272/Makefile.am	2018-05-22 09:17:49.247095600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5272.a
-nodist_libata5272_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5272_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/ata6616c/Makefile.am avr-libc-r2546/avr/lib/avr25/ata6616c/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/ata6616c/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/ata6616c/Makefile.am	2018-05-22 09:17:49.361467500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6616c.a
-nodist_libata6616c_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6616c_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny4313/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny4313/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny4313/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny4313/Makefile.am	2018-05-22 09:17:49.476469000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny4313.a
-nodist_libattiny4313_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny4313_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny43u/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny43u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny43u/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny43u/Makefile.am	2018-05-22 09:17:49.590451800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny43u.a
-nodist_libattiny43u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny43u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny44/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny44/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny44/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny44/Makefile.am	2018-05-22 09:17:49.704481700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny44.a
-nodist_libattiny44_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny44_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny441/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny441/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny441/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny441/Makefile.am	2018-05-22 09:17:49.935226300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny441.a
-nodist_libattiny441_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny441_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny44a/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny44a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny44a/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny44a/Makefile.am	2018-05-22 09:17:49.819964100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny44a.a
-nodist_libattiny44a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny44a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny45/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny45/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny45/Makefile.am	2016-02-09 00:08:50.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny45/Makefile.am	2018-05-22 09:17:50.051491900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny45.a
-nodist_libattiny45_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny45_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny461/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny461/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny461/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny461/Makefile.am	2018-05-22 09:17:50.166514500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny461.a
-nodist_libattiny461_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny461_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny461a/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny461a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny461a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny461a/Makefile.am	2018-05-22 09:17:50.281815400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny461a.a
-nodist_libattiny461a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny461a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny48/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny48/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny48/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny48/Makefile.am	2018-05-22 09:17:50.396504400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny48.a
-nodist_libattiny48_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny48_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny828/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny828/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny828/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny828/Makefile.am	2018-05-22 09:17:50.511196800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny828.a
-nodist_libattiny828_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny828_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny84/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny84/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny84/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny84/Makefile.am	2018-05-22 09:17:50.625625500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny84.a
-nodist_libattiny84_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny84_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny841/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny841/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny841/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny841/Makefile.am	2018-05-22 09:17:50.855555200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny841.a
-nodist_libattiny841_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny841_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny84a/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny84a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny84a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny84a/Makefile.am	2018-05-22 09:17:50.739439800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny84a.a
-nodist_libattiny84a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny84a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny85/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny85/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny85/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny85/Makefile.am	2018-05-22 09:17:50.971190600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny85.a
-nodist_libattiny85_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny85_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny861/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny861/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny861/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny861/Makefile.am	2018-05-22 09:17:51.086930600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny861.a
-nodist_libattiny861_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny861_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny861a/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny861a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny861a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny861a/Makefile.am	2018-05-22 09:17:51.202565700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny861a.a
-nodist_libattiny861a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny861a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny87/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny87/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny87/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny87/Makefile.am	2018-05-22 09:17:51.317808000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny87.a
-nodist_libattiny87_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny87_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/attiny88/Makefile.am avr-libc-r2546/avr/lib/avr25/attiny88/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/attiny88/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/attiny88/Makefile.am	2018-05-22 09:17:51.433172900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny88.a
-nodist_libattiny88_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny88_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny13/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny13/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny13/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny13/Makefile.am	2018-05-22 09:17:52.549403400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny13.a
-nodist_libattiny13_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny13_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny13a/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny13a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny13a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny13a/Makefile.am	2018-05-22 09:17:52.663812200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny13a.a
-nodist_libattiny13a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny13a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny2313/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny2313/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny2313/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny2313/Makefile.am	2018-05-22 09:17:52.778787000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny2313.a
-nodist_libattiny2313_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny2313_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny2313a/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny2313a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny2313a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny2313a/Makefile.am	2018-05-22 09:17:52.894500000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny2313a.a
-nodist_libattiny2313a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny2313a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny24/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny24/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny24/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny24/Makefile.am	2018-05-22 09:17:53.008558800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny24.a
-nodist_libattiny24_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny24_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny24a/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny24a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny24a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny24a/Makefile.am	2018-05-22 09:17:53.124436300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny24a.a
-nodist_libattiny24a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny24a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny25/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny25/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny25/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny25/Makefile.am	2018-05-22 09:17:53.239861300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny25.a
-nodist_libattiny25_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny25_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny261/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny261/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny261/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny261/Makefile.am	2018-05-22 09:17:53.355108500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny261.a
-nodist_libattiny261_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny261_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny261a/Makefile.am avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny261a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr25/tiny-stack/attiny261a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr25/tiny-stack/attiny261a/Makefile.am	2018-05-22 09:17:53.471206600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny261a.a
-nodist_libattiny261a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny261a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr3/at43usb355/Makefile.am avr-libc-r2546/avr/lib/avr3/at43usb355/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr3/at43usb355/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr3/at43usb355/Makefile.am	2018-05-22 09:17:54.145233200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat43usb355.a
-nodist_libat43usb355_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat43usb355_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr3/at76c711/Makefile.am avr-libc-r2546/avr/lib/avr3/at76c711/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr3/at76c711/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr3/at76c711/Makefile.am	2018-05-22 09:17:54.258367000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat76c711.a
-nodist_libat76c711_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat76c711_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr31/at43usb320/Makefile.am avr-libc-r2546/avr/lib/avr31/at43usb320/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr31/at43usb320/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr31/at43usb320/Makefile.am	2018-05-22 09:17:54.786046200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat43usb320.a
-nodist_libat43usb320_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat43usb320_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr31/atmega103/Makefile.am avr-libc-r2546/avr/lib/avr31/atmega103/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr31/atmega103/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr31/atmega103/Makefile.am	2018-05-22 09:17:54.671564500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega103.a
-nodist_libatmega103_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega103_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/at90usb162/Makefile.am avr-libc-r2546/avr/lib/avr35/at90usb162/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/at90usb162/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/at90usb162/Makefile.am	2018-05-22 09:17:55.314518200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90usb162.a
-nodist_libat90usb162_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90usb162_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/at90usb82/Makefile.am avr-libc-r2546/avr/lib/avr35/at90usb82/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/at90usb82/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/at90usb82/Makefile.am	2018-05-22 09:17:55.200309200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90usb82.a
-nodist_libat90usb82_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90usb82_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/ata5505/Makefile.am avr-libc-r2546/avr/lib/avr35/ata5505/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/ata5505/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/ata5505/Makefile.am	2018-05-22 09:17:55.429761100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5505.a
-nodist_libata5505_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5505_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/ata6617c/Makefile.am avr-libc-r2546/avr/lib/avr35/ata6617c/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/ata6617c/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/ata6617c/Makefile.am	2018-05-22 09:17:55.544258400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6617c.a
-nodist_libata6617c_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6617c_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/ata664251/Makefile.am avr-libc-r2546/avr/lib/avr35/ata664251/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/ata664251/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/ata664251/Makefile.am	2018-05-22 09:17:55.659323100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata664251.a
-nodist_libata664251_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata664251_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/atmega16u2/Makefile.am avr-libc-r2546/avr/lib/avr35/atmega16u2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/atmega16u2/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/atmega16u2/Makefile.am	2018-05-22 09:17:55.888548800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16u2.a
-nodist_libatmega16u2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16u2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/atmega32u2/Makefile.am avr-libc-r2546/avr/lib/avr35/atmega32u2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/atmega32u2/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/atmega32u2/Makefile.am	2018-05-22 09:17:56.002954500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32u2.a
-nodist_libatmega32u2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32u2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/atmega8u2/Makefile.am avr-libc-r2546/avr/lib/avr35/atmega8u2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/atmega8u2/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/atmega8u2/Makefile.am	2018-05-22 09:17:55.773835000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega8u2.a
-nodist_libatmega8u2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega8u2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/attiny1634/Makefile.am avr-libc-r2546/avr/lib/avr35/attiny1634/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/attiny1634/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/attiny1634/Makefile.am	2018-05-22 09:17:56.232390500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny1634.a
-nodist_libattiny1634_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny1634_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr35/attiny167/Makefile.am avr-libc-r2546/avr/lib/avr35/attiny167/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr35/attiny167/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr35/attiny167/Makefile.am	2018-05-22 09:17:56.117479700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny167.a
-nodist_libattiny167_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny167_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm1/Makefile.am avr-libc-r2546/avr/lib/avr4/at90pwm1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm1/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/at90pwm1/Makefile.am	2018-05-22 09:17:59.108059600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm1.a
-nodist_libat90pwm1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm2/Makefile.am avr-libc-r2546/avr/lib/avr4/at90pwm2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm2/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/at90pwm2/Makefile.am	2018-05-22 09:17:59.223345900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm2.a
-nodist_libat90pwm2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm2b/Makefile.am avr-libc-r2546/avr/lib/avr4/at90pwm2b/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm2b/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/at90pwm2b/Makefile.am	2018-05-22 09:17:59.336889000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm2b.a
-nodist_libat90pwm2b_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm2b_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm3/Makefile.am avr-libc-r2546/avr/lib/avr4/at90pwm3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm3/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/at90pwm3/Makefile.am	2018-05-22 09:17:59.452365500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm3.a
-nodist_libat90pwm3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm3b/Makefile.am avr-libc-r2546/avr/lib/avr4/at90pwm3b/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm3b/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/at90pwm3b/Makefile.am	2018-05-22 09:17:59.566439200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm3b.a
-nodist_libat90pwm3b_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm3b_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm81/Makefile.am avr-libc-r2546/avr/lib/avr4/at90pwm81/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/at90pwm81/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/at90pwm81/Makefile.am	2018-05-22 09:17:59.680663700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm81.a
-nodist_libat90pwm81_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm81_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/ata6285/Makefile.am avr-libc-r2546/avr/lib/avr4/ata6285/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/ata6285/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/ata6285/Makefile.am	2018-05-22 09:17:56.934824400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6285.a
-nodist_libata6285_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6285_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/ata6286/Makefile.am avr-libc-r2546/avr/lib/avr4/ata6286/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/ata6286/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/ata6286/Makefile.am	2018-05-22 09:17:57.049090200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6286.a
-nodist_libata6286_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6286_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/ata6289/Makefile.am avr-libc-r2546/avr/lib/avr4/ata6289/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/ata6289/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/ata6289/Makefile.am	2018-05-22 09:17:57.163576600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6289.a
-nodist_libata6289_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6289_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/ata6612c/Makefile.am avr-libc-r2546/avr/lib/avr4/ata6612c/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/ata6612c/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/ata6612c/Makefile.am	2018-05-22 09:17:57.277117800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6612c.a
-nodist_libata6612c_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6612c_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega48/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega48/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega48/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega48/Makefile.am	2018-05-22 09:17:57.391440600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega48.a
-nodist_libatmega48_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega48_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega48a/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega48a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega48a/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega48a/Makefile.am	2018-05-22 09:17:57.506008900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega48a.a
-nodist_libatmega48a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega48a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega48p/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega48p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega48p/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega48p/Makefile.am	2018-05-22 09:17:57.848709100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega48p.a
-nodist_libatmega48p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega48p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega48pa/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega48pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega48pa/Makefile.am	2016-02-09 00:08:51.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega48pa/Makefile.am	2018-05-22 09:17:57.619591700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega48pa.a
-nodist_libatmega48pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega48pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega48pb/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega48pb/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega48pb/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega48pb/Makefile.am	2018-05-22 09:17:57.734336000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega48pb.a
-nodist_libatmega48pb_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega48pb_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega8/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega8/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega8/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega8/Makefile.am	2018-05-22 09:17:57.963218700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega8.a
-nodist_libatmega8_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega8_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega8515/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega8515/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega8515/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega8515/Makefile.am	2018-05-22 09:17:58.766803300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega8515.a
-nodist_libatmega8515_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega8515_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega8535/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega8535/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega8535/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega8535/Makefile.am	2018-05-22 09:17:58.880497100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega8535.a
-nodist_libatmega8535_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega8535_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega88/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega88/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega88/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega88/Makefile.am	2018-05-22 09:17:58.193102200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega88.a
-nodist_libatmega88_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega88_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega88a/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega88a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega88a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega88a/Makefile.am	2018-05-22 09:17:58.307093700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega88a.a
-nodist_libatmega88a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega88a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega88p/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega88p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega88p/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega88p/Makefile.am	2018-05-22 09:17:58.421774000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega88p.a
-nodist_libatmega88p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega88p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega88pa/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega88pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega88pa/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega88pa/Makefile.am	2018-05-22 09:17:58.536513000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega88pa.a
-nodist_libatmega88pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega88pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega88pb/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega88pb/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega88pb/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega88pb/Makefile.am	2018-05-22 09:17:58.651849200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega88pb.a
-nodist_libatmega88pb_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega88pb_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega8a/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega8a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega8a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega8a/Makefile.am	2018-05-22 09:17:58.079045300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega8a.a
-nodist_libatmega8a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega8a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr4/atmega8hva/Makefile.am avr-libc-r2546/avr/lib/avr4/atmega8hva/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr4/atmega8hva/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr4/atmega8hva/Makefile.am	2018-05-22 09:17:58.994432700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega8hva.a
-nodist_libatmega8hva_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega8hva_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90can32/Makefile.am avr-libc-r2546/avr/lib/avr5/at90can32/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90can32/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90can32/Makefile.am	2018-05-22 09:18:01.099119500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90can32.a
-nodist_libat90can32_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90can32_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90can64/Makefile.am avr-libc-r2546/avr/lib/avr5/at90can64/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90can64/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90can64/Makefile.am	2018-05-22 09:18:01.214044700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90can64.a
-nodist_libat90can64_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90can64_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90pwm161/Makefile.am avr-libc-r2546/avr/lib/avr5/at90pwm161/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90pwm161/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90pwm161/Makefile.am	2018-05-22 09:18:01.557698700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm161.a
-nodist_libat90pwm161_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm161_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90pwm216/Makefile.am avr-libc-r2546/avr/lib/avr5/at90pwm216/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90pwm216/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90pwm216/Makefile.am	2018-05-22 09:18:01.328437300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm216.a
-nodist_libat90pwm216_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm216_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90pwm316/Makefile.am avr-libc-r2546/avr/lib/avr5/at90pwm316/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90pwm316/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90pwm316/Makefile.am	2018-05-22 09:18:01.442755800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90pwm316.a
-nodist_libat90pwm316_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90pwm316_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90scr100/Makefile.am avr-libc-r2546/avr/lib/avr5/at90scr100/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90scr100/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90scr100/Makefile.am	2018-05-22 09:18:01.671940900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90scr100.a
-nodist_libat90scr100_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90scr100_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90usb646/Makefile.am avr-libc-r2546/avr/lib/avr5/at90usb646/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90usb646/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90usb646/Makefile.am	2018-05-22 09:18:01.787182500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90usb646.a
-nodist_libat90usb646_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90usb646_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at90usb647/Makefile.am avr-libc-r2546/avr/lib/avr5/at90usb647/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at90usb647/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at90usb647/Makefile.am	2018-05-22 09:18:01.902222200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90usb647.a
-nodist_libat90usb647_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90usb647_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/at94k/Makefile.am avr-libc-r2546/avr/lib/avr5/at94k/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/at94k/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/at94k/Makefile.am	2018-05-22 09:18:02.017796400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat94k.a
-nodist_libat94k_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat94k_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata5702m322/Makefile.am avr-libc-r2546/avr/lib/avr5/ata5702m322/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata5702m322/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata5702m322/Makefile.am	2018-05-22 09:18:02.133603800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5702m322.a
-nodist_libata5702m322_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5702m322_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata5782/Makefile.am avr-libc-r2546/avr/lib/avr5/ata5782/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata5782/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata5782/Makefile.am	2018-05-22 09:18:02.247203000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5782.a
-nodist_libata5782_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5782_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata5790/Makefile.am avr-libc-r2546/avr/lib/avr5/ata5790/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata5790/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata5790/Makefile.am	2018-05-22 09:18:02.362230900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5790.a
-nodist_libata5790_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5790_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata5790n/Makefile.am avr-libc-r2546/avr/lib/avr5/ata5790n/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata5790n/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata5790n/Makefile.am	2018-05-22 09:18:02.477061400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5790n.a
-nodist_libata5790n_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5790n_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata5795/Makefile.am avr-libc-r2546/avr/lib/avr5/ata5795/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata5795/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata5795/Makefile.am	2018-05-22 09:18:02.591383600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5795.a
-nodist_libata5795_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5795_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata5831/Makefile.am avr-libc-r2546/avr/lib/avr5/ata5831/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata5831/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata5831/Makefile.am	2018-05-22 09:18:02.704888500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata5831.a
-nodist_libata5831_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata5831_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata6613c/Makefile.am avr-libc-r2546/avr/lib/avr5/ata6613c/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata6613c/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata6613c/Makefile.am	2018-05-22 09:18:02.820038300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6613c.a
-nodist_libata6613c_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6613c_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/ata6614q/Makefile.am avr-libc-r2546/avr/lib/avr5/ata6614q/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/ata6614q/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/ata6614q/Makefile.am	2018-05-22 09:18:02.936315700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libata6614q.a
-nodist_libata6614q_a_SOURCES = $(eeprom_asm_sources)
+nodist_libata6614q_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16/Makefile.am	2018-05-22 09:18:03.051921700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16.a
-nodist_libatmega16_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega161/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega161/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega161/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega161/Makefile.am	2018-05-22 09:18:03.280405700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega161.a
-nodist_libatmega161_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega161_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega162/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega162/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega162/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega162/Makefile.am	2018-05-22 09:18:03.396799500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega162.a
-nodist_libatmega162_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega162_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega163/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega163/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega163/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega163/Makefile.am	2018-05-22 09:18:03.511267900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega163.a
-nodist_libatmega163_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega163_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega164a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega164a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega164a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega164a/Makefile.am	2018-05-22 09:18:03.625706200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega164a.a
-nodist_libatmega164a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega164a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega164p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega164p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega164p/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega164p/Makefile.am	2018-05-22 09:18:03.740033100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega164p.a
-nodist_libatmega164p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega164p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega164pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega164pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega164pa/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega164pa/Makefile.am	2018-05-22 09:18:03.855234700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega164pa.a
-nodist_libatmega164pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega164pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega165/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega165/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega165/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega165/Makefile.am	2018-05-22 09:18:03.971186900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega165.a
-nodist_libatmega165_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega165_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega165a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega165a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega165a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega165a/Makefile.am	2018-05-22 09:18:04.086671200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega165a.a
-nodist_libatmega165a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega165a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega165p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega165p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega165p/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega165p/Makefile.am	2018-05-22 09:18:04.201530600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega165p.a
-nodist_libatmega165p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega165p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega165pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega165pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega165pa/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega165pa/Makefile.am	2018-05-22 09:18:04.316005500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega165pa.a
-nodist_libatmega165pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega165pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega168/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega168/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega168/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega168/Makefile.am	2018-05-22 09:18:04.431120200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega168.a
-nodist_libatmega168_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega168_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega168a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega168a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega168a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega168a/Makefile.am	2018-05-22 09:18:04.546849000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega168a.a
-nodist_libatmega168a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega168a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega168p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega168p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega168p/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega168p/Makefile.am	2018-05-22 09:18:04.662551800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega168p.a
-nodist_libatmega168p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega168p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega168pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega168pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega168pa/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega168pa/Makefile.am	2018-05-22 09:18:04.776274800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega168pa.a
-nodist_libatmega168pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega168pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega169/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega169/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega169/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega169/Makefile.am	2018-05-22 09:18:04.890773000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega169.a
-nodist_libatmega169_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega169_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega169a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega169a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega169a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega169a/Makefile.am	2018-05-22 09:18:05.006098100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega169a.a
-nodist_libatmega169a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega169a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega169p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega169p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega169p/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega169p/Makefile.am	2018-05-22 09:18:05.121357200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega169p.a
-nodist_libatmega169p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega169p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega169pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega169pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega169pa/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega169pa/Makefile.am	2018-05-22 09:18:05.236362700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega169pa.a
-nodist_libatmega169pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega169pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16a/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16a/Makefile.am	2018-05-22 09:18:03.166072600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16a.a
-nodist_libatmega16a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hva/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16hva/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hva/Makefile.am	2016-02-09 00:08:52.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16hva/Makefile.am	2018-05-22 09:18:05.351065600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16hva.a
-nodist_libatmega16hva_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16hva_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hva2/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16hva2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hva2/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16hva2/Makefile.am	2018-05-22 09:18:05.465189300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16hva2.a
-nodist_libatmega16hva2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16hva2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hvb/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16hvb/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hvb/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16hvb/Makefile.am	2018-05-22 09:18:05.581099600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16hvb.a
-nodist_libatmega16hvb_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16hvb_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hvbrevb/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16hvbrevb/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16hvbrevb/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16hvbrevb/Makefile.am	2018-05-22 09:18:05.695452000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16hvbrevb.a
-nodist_libatmega16hvbrevb_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16hvbrevb_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16m1/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16m1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16m1/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16m1/Makefile.am	2018-05-22 09:18:05.809434100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16m1.a
-nodist_libatmega16m1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16m1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega16u4/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega16u4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega16u4/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega16u4/Makefile.am	2018-05-22 09:18:05.923935400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega16u4.a
-nodist_libatmega16u4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega16u4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32/Makefile.am	2018-05-22 09:18:06.039646800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32.a
-nodist_libatmega32_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega323/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega323/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega323/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega323/Makefile.am	2018-05-22 09:18:06.269333600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega323.a
-nodist_libatmega323_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega323_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega324a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega324a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega324a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega324a/Makefile.am	2018-05-22 09:18:06.384583900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega324a.a
-nodist_libatmega324a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega324a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega324p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega324p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega324p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega324p/Makefile.am	2018-05-22 09:18:06.499997500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega324p.a
-nodist_libatmega324p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega324p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega324pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega324pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega324pa/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega324pa/Makefile.am	2018-05-22 09:18:06.614638100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega324pa.a
-nodist_libatmega324pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega324pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega325/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega325/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega325/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega325/Makefile.am	2018-05-22 09:18:06.729179100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega325.a
-nodist_libatmega325_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega325_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3250/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3250/Makefile.am	2018-05-22 09:18:07.217265000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3250.a
-nodist_libatmega3250_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3250_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3250a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3250a/Makefile.am	2018-05-22 09:18:07.331853400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3250a.a
-nodist_libatmega3250a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3250a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3250p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3250p/Makefile.am	2018-05-22 09:18:07.447162400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3250p.a
-nodist_libatmega3250p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3250p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3250pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3250pa/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3250pa/Makefile.am	2018-05-22 09:18:07.561528100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3250pa.a
-nodist_libatmega3250pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3250pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega325a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega325a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega325a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega325a/Makefile.am	2018-05-22 09:18:06.844891800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega325a.a
-nodist_libatmega325a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega325a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega325p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega325p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega325p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega325p/Makefile.am	2018-05-22 09:18:06.959312100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega325p.a
-nodist_libatmega325p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega325p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega325pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega325pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega325pa/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega325pa/Makefile.am	2018-05-22 09:18:07.102324600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega325pa.a
-nodist_libatmega325pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega325pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega328/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega328/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega328/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega328/Makefile.am	2018-05-22 09:18:07.676246600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega328.a
-nodist_libatmega328_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega328_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega328p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega328p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega328p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega328p/Makefile.am	2018-05-22 09:18:07.791293400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega328p.a
-nodist_libatmega328p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega328p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega329/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega329/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega329/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega329/Makefile.am	2018-05-22 09:18:07.905565000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega329.a
-nodist_libatmega329_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega329_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3290/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3290/Makefile.am	2018-05-22 09:18:08.367307100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3290.a
-nodist_libatmega3290_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3290_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3290a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3290a/Makefile.am	2018-05-22 09:18:08.482145900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3290a.a
-nodist_libatmega3290a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3290a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3290p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3290p/Makefile.am	2018-05-22 09:18:08.597410900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3290p.a
-nodist_libatmega3290p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3290p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega3290pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega3290pa/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega3290pa/Makefile.am	2018-05-22 09:18:08.712313700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega3290pa.a
-nodist_libatmega3290pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega3290pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega329a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega329a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega329a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega329a/Makefile.am	2018-05-22 09:18:08.022380800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega329a.a
-nodist_libatmega329a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega329a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega329p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega329p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega329p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega329p/Makefile.am	2018-05-22 09:18:08.138186900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega329p.a
-nodist_libatmega329p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega329p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega329pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega329pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega329pa/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega329pa/Makefile.am	2018-05-22 09:18:08.252066600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega329pa.a
-nodist_libatmega329pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega329pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32a/Makefile.am	2018-05-22 09:18:06.154091300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32a.a
-nodist_libatmega32a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32c1/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32c1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32c1/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32c1/Makefile.am	2018-05-22 09:18:08.827555900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32c1.a
-nodist_libatmega32c1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32c1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32hvb/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32hvb/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32hvb/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32hvb/Makefile.am	2018-05-22 09:18:08.941847400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32hvb.a
-nodist_libatmega32hvb_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32hvb_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32hvbrevb/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32hvbrevb/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32hvbrevb/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32hvbrevb/Makefile.am	2018-05-22 09:18:09.056539900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32hvbrevb.a
-nodist_libatmega32hvbrevb_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32hvbrevb_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32m1/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32m1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32m1/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32m1/Makefile.am	2018-05-22 09:18:09.172332000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32m1.a
-nodist_libatmega32m1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32m1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32u4/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32u4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32u4/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32u4/Makefile.am	2018-05-22 09:18:09.287952500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32u4.a
-nodist_libatmega32u4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32u4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega32u6/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega32u6/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega32u6/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega32u6/Makefile.am	2018-05-22 09:18:09.402621400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega32u6.a
-nodist_libatmega32u6_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega32u6_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega406/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega406/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega406/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega406/Makefile.am	2018-05-22 09:18:09.517899300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega406.a
-nodist_libatmega406_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega406_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64/Makefile.am	2018-05-22 09:18:09.861219400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64.a
-nodist_libatmega64_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega640/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega640/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega640/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega640/Makefile.am	2018-05-22 09:18:10.090676000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega640.a
-nodist_libatmega640_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega640_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega644/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega644/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega644/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega644/Makefile.am	2018-05-22 09:18:10.206230700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega644.a
-nodist_libatmega644_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega644_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega644a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega644a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega644a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega644a/Makefile.am	2018-05-22 09:18:10.320610000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega644a.a
-nodist_libatmega644a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega644a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega644p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega644p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega644p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega644p/Makefile.am	2018-05-22 09:18:10.434666600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega644p.a
-nodist_libatmega644p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega644p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega644pa/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega644pa/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega644pa/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega644pa/Makefile.am	2018-05-22 09:18:10.549002200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega644pa.a
-nodist_libatmega644pa_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega644pa_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega644rfr2/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega644rfr2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega644rfr2/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega644rfr2/Makefile.am	2018-05-22 09:18:09.632599800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega644rfr2.a
-nodist_libatmega644rfr2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega644rfr2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega645/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega645/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega645/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega645/Makefile.am	2018-05-22 09:18:10.663530500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega645.a
-nodist_libatmega645_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega645_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega6450/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega6450/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega6450/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega6450/Makefile.am	2018-05-22 09:18:11.008004600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega6450.a
-nodist_libatmega6450_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega6450_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega6450a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega6450a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega6450a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega6450a/Makefile.am	2018-05-22 09:18:11.124299400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega6450a.a
-nodist_libatmega6450a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega6450a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega6450p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega6450p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega6450p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega6450p/Makefile.am	2018-05-22 09:18:11.239542600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega6450p.a
-nodist_libatmega6450p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega6450p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega645a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega645a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega645a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega645a/Makefile.am	2018-05-22 09:18:10.778321300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega645a.a
-nodist_libatmega645a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega645a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega645p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega645p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega645p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega645p/Makefile.am	2018-05-22 09:18:10.892991000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega645p.a
-nodist_libatmega645p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega645p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega649/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega649/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega649/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega649/Makefile.am	2018-05-22 09:18:11.354677200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega649.a
-nodist_libatmega649_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega649_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega6490/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega6490/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega6490/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega6490/Makefile.am	2018-05-22 09:18:11.699133400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega6490.a
-nodist_libatmega6490_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega6490_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega6490a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega6490a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega6490a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega6490a/Makefile.am	2018-05-22 09:18:11.814057300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega6490a.a
-nodist_libatmega6490a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega6490a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega6490p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega6490p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega6490p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega6490p/Makefile.am	2018-05-22 09:18:11.928394100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega6490p.a
-nodist_libatmega6490p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega6490p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega649a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega649a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega649a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega649a/Makefile.am	2018-05-22 09:18:11.468943300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega649a.a
-nodist_libatmega649a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega649a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega649p/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega649p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega649p/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega649p/Makefile.am	2018-05-22 09:18:11.583247800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega649p.a
-nodist_libatmega649p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega649p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64a/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64a/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64a/Makefile.am	2018-05-22 09:18:09.976017700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64a.a
-nodist_libatmega64a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64c1/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64c1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64c1/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64c1/Makefile.am	2018-05-22 09:18:12.043474400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64c1.a
-nodist_libatmega64c1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64c1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64hve/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64hve/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64hve/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64hve/Makefile.am	2018-05-22 09:18:12.158082400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64hve.a
-nodist_libatmega64hve_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64hve_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64hve2/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64hve2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64hve2/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64hve2/Makefile.am	2018-05-22 09:18:12.273339300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64hve2.a
-nodist_libatmega64hve2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64hve2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64m1/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64m1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64m1/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64m1/Makefile.am	2018-05-22 09:18:12.386745500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64m1.a
-nodist_libatmega64m1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64m1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/atmega64rfr2/Makefile.am avr-libc-r2546/avr/lib/avr5/atmega64rfr2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/atmega64rfr2/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/atmega64rfr2/Makefile.am	2018-05-22 09:18:09.746864900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega64rfr2.a
-nodist_libatmega64rfr2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega64rfr2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr5/m3000/Makefile.am avr-libc-r2546/avr/lib/avr5/m3000/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr5/m3000/Makefile.am	2016-02-09 00:08:53.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr5/m3000/Makefile.am	2018-05-22 09:18:12.502393300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libm3000.a
-nodist_libm3000_a_SOURCES = $(eeprom_asm_sources)
+nodist_libm3000_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/at90can128/Makefile.am avr-libc-r2546/avr/lib/avr51/at90can128/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/at90can128/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/at90can128/Makefile.am	2018-05-22 09:18:17.734417600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90can128.a
-nodist_libat90can128_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90can128_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/at90usb1286/Makefile.am avr-libc-r2546/avr/lib/avr51/at90usb1286/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/at90usb1286/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/at90usb1286/Makefile.am	2018-05-22 09:18:17.849661100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90usb1286.a
-nodist_libat90usb1286_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90usb1286_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/at90usb1287/Makefile.am avr-libc-r2546/avr/lib/avr51/at90usb1287/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/at90usb1287/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/at90usb1287/Makefile.am	2018-05-22 09:18:17.966930200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libat90usb1287.a
-nodist_libat90usb1287_a_SOURCES = $(eeprom_asm_sources)
+nodist_libat90usb1287_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega128/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega128/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega128/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega128/Makefile.am	2018-05-22 09:18:16.698234100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega128.a
-nodist_libatmega128_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega128_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega1280/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega1280/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega1280/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega1280/Makefile.am	2018-05-22 09:18:16.928192700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega1280.a
-nodist_libatmega1280_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega1280_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega1281/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega1281/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega1281/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega1281/Makefile.am	2018-05-22 09:18:17.044114800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega1281.a
-nodist_libatmega1281_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega1281_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega1284/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega1284/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega1284/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega1284/Makefile.am	2018-05-22 09:18:17.158659900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega1284.a
-nodist_libatmega1284_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega1284_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega1284p/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega1284p/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega1284p/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega1284p/Makefile.am	2018-05-22 09:18:17.274338100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega1284p.a
-nodist_libatmega1284p_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega1284p_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega1284rfr2/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega1284rfr2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega1284rfr2/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega1284rfr2/Makefile.am	2018-05-22 09:18:17.503472800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega1284rfr2.a
-nodist_libatmega1284rfr2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega1284rfr2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega128a/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega128a/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega128a/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega128a/Makefile.am	2018-05-22 09:18:16.812579300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega128a.a
-nodist_libatmega128a_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega128a_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega128rfa1/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega128rfa1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega128rfa1/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega128rfa1/Makefile.am	2018-05-22 09:18:17.389137900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega128rfa1.a
-nodist_libatmega128rfa1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega128rfa1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr51/atmega128rfr2/Makefile.am avr-libc-r2546/avr/lib/avr51/atmega128rfr2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr51/atmega128rfr2/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr51/atmega128rfr2/Makefile.am	2018-05-22 09:18:17.619600700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega128rfr2.a
-nodist_libatmega128rfr2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega128rfr2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr6/atmega2560/Makefile.am avr-libc-r2546/avr/lib/avr6/atmega2560/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr6/atmega2560/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr6/atmega2560/Makefile.am	2018-05-22 09:18:18.753278500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega2560.a
-nodist_libatmega2560_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega2560_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr6/atmega2561/Makefile.am avr-libc-r2546/avr/lib/avr6/atmega2561/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr6/atmega2561/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr6/atmega2561/Makefile.am	2018-05-22 09:18:18.868589100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega2561.a
-nodist_libatmega2561_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega2561_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr6/atmega2564rfr2/Makefile.am avr-libc-r2546/avr/lib/avr6/atmega2564rfr2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr6/atmega2564rfr2/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr6/atmega2564rfr2/Makefile.am	2018-05-22 09:18:18.985497300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega2564rfr2.a
-nodist_libatmega2564rfr2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega2564rfr2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avr6/atmega256rfr2/Makefile.am avr-libc-r2546/avr/lib/avr6/atmega256rfr2/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avr6/atmega256rfr2/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avr6/atmega256rfr2/Makefile.am	2018-05-22 09:18:19.100918300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatmega256rfr2.a
-nodist_libatmega256rfr2_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatmega256rfr2_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny10/Makefile.am avr-libc-r2546/avr/lib/avrtiny/attiny10/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny10/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrtiny/attiny10/Makefile.am	2018-05-22 09:18:28.227035700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny10.a
-nodist_libattiny10_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny10_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny20/Makefile.am avr-libc-r2546/avr/lib/avrtiny/attiny20/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny20/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrtiny/attiny20/Makefile.am	2018-05-22 09:18:28.341206200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny20.a
-nodist_libattiny20_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny20_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny4/Makefile.am avr-libc-r2546/avr/lib/avrtiny/attiny4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny4/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrtiny/attiny4/Makefile.am	2018-05-22 09:18:27.879728200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny4.a
-nodist_libattiny4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny40/Makefile.am avr-libc-r2546/avr/lib/avrtiny/attiny40/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny40/Makefile.am	2016-02-09 00:08:56.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrtiny/attiny40/Makefile.am	2018-05-22 09:18:28.456184400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny40.a
-nodist_libattiny40_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny40_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny5/Makefile.am avr-libc-r2546/avr/lib/avrtiny/attiny5/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny5/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrtiny/attiny5/Makefile.am	2018-05-22 09:18:27.994618000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny5.a
-nodist_libattiny5_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny5_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny9/Makefile.am avr-libc-r2546/avr/lib/avrtiny/attiny9/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrtiny/attiny9/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrtiny/attiny9/Makefile.am	2018-05-22 09:18:28.111391300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libattiny9.a
-nodist_libattiny9_a_SOURCES = $(eeprom_asm_sources)
+nodist_libattiny9_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16a4/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega16a4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16a4/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega16a4/Makefile.am	2018-05-22 09:18:19.705452000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega16a4.a
-nodist_libatxmega16a4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega16a4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16a4u/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega16a4u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16a4u/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega16a4u/Makefile.am	2018-05-22 09:18:19.821284200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega16a4u.a
-nodist_libatxmega16a4u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega16a4u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16c4/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega16c4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16c4/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega16c4/Makefile.am	2018-05-22 09:18:19.936222000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega16c4.a
-nodist_libatxmega16c4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega16c4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16d4/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega16d4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega16d4/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega16d4/Makefile.am	2018-05-22 09:18:20.051855900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega16d4.a
-nodist_libatxmega16d4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega16d4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32a4/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32a4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32a4/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32a4/Makefile.am	2018-05-22 09:18:20.167218600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32a4.a
-nodist_libatxmega32a4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32a4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32a4u/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32a4u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32a4u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32a4u/Makefile.am	2018-05-22 09:18:20.283479900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32a4u.a
-nodist_libatxmega32a4u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32a4u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32c3/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32c3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32c3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32c3/Makefile.am	2018-05-22 09:18:20.398740700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32c3.a
-nodist_libatxmega32c3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32c3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32c4/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32c4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32c4/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32c4/Makefile.am	2018-05-22 09:18:20.513410500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32c4.a
-nodist_libatxmega32c4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32c4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32d3/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32d3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32d3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32d3/Makefile.am	2018-05-22 09:18:20.628671400 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32d3.a
-nodist_libatxmega32d3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32d3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32d4/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32d4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32d4/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32d4/Makefile.am	2018-05-22 09:18:20.743913700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32d4.a
-nodist_libatxmega32d4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32d4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32e5/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega32e5/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega32e5/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega32e5/Makefile.am	2018-05-22 09:18:20.860031000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega32e5.a
-nodist_libatxmega32e5_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega32e5_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega8e5/Makefile.am avr-libc-r2546/avr/lib/avrxmega2/atxmega8e5/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega2/atxmega8e5/Makefile.am	2016-02-09 00:08:54.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega2/atxmega8e5/Makefile.am	2018-05-22 09:18:19.590193000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega8e5.a
-nodist_libatxmega8e5_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega8e5_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega3/Makefile.am avr-libc-r2546/avr/lib/avrxmega3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega3/Makefile.am	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/avr/lib/avrxmega3/Makefile.am	2018-05-22 09:18:21.634852000 +0400
@@ -0,0 +1,107 @@
+# Copyright (c) 2004,  Theodore A. Roth
+# Copyright (c) 2005, 2008, 2009  Anatoly Sokolov
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+# * Redistributions of source code must retain the above copyright
+#   notice, this list of conditions and the following disclaimer.
+# * Redistributions in binary form must reproduce the above copyright
+#   notice, this list of conditions and the following disclaimer in
+#   the documentation and/or other materials provided with the
+#   distribution.
+# * Neither the name of the copyright holders nor the names of
+#   contributors may be used to endorse or promote products derived
+#   from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+# POSSIBILITY OF SUCH DAMAGE.
+#
+
+SUBDIRS = 
+
+AVR_TARGET          = avrxmega3
+AVR_TARGET_DEFS     = -D__COMPILING_AVR_LIBC__
+AVR_TARGET_CFLAGS   = -mcall-prologues -Os
+AVR_TARGET_ASFLAGS  = 
+AVR_INSTALL_DIR     = avrxmega3
+
+VPATH = $(top_srcdir)/libc/stdlib:$(top_srcdir)/libc/pmstring:$(top_srcdir)/libc/string:$(top_srcdir)/libc/misc:$(top_srcdir)/libc/stdio:$(top_srcdir)/libm/fplib:$(top_srcdir)/libc/time
+
+if HAS_avrxmega3
+
+AVRLIB_DEVLIST =
+
+AM_CPPFLAGS = -I$(top_srcdir)/common -I$(top_srcdir)/include -I$(top_builddir)/include
+
+AVRLIB_CFLAGS = @CDEBUG@ -Wall -W -Wstrict-prototypes -mmcu=$(AVR_TARGET) $(AVR_TARGET_DEFS) $(AVR_TARGET_CFLAGS)
+
+AVRLIB_ASFLAGS = -x assembler-with-cpp @ASDEBUG@ -mmcu=$(AVR_TARGET) $(AVR_TARGET_DEFS) $(AVR_TARGET_ASFLAGS)
+
+AM_CFLAGS = $(AVRLIB_CFLAGS)
+AM_CCASFLAGS = $(AM_CPPFLAGS) $(AVRLIB_ASFLAGS)
+
+__install_dir = $(prefix)/avr/lib/$(AVR_INSTALL_DIR)
+
+avrdir = $(__install_dir)
+avrlibdir = $(__install_dir)
+
+avr_LIBRARIES = \
+	libc.a \
+	libprintf_min.a \
+	libprintf_flt.a \
+	libscanf_min.a \
+	libscanf_flt.a \
+	libm.a
+
+include $(top_srcdir)/libc/stdlib/Rules.am
+include $(top_srcdir)/libc/pmstring/Rules.am
+include $(top_srcdir)/libc/string/Rules.am
+include $(top_srcdir)/libc/misc/Rules.am
+include $(top_srcdir)/libc/stdio/Rules.am
+include $(top_srcdir)/libm/fplib/Rules.am
+include $(top_srcdir)/libc/time/Rules.am
+
+nodist_libc_a_SOURCES = \
+	$(stdlib_a_c_sources) \
+	$(stdlib_a_asm_sources) \
+	$(pmstring_a_c_sources) \
+	$(pmstring_a_asm_sources) \
+	$(string_a_c_sources) \
+	$(string_a_asm_sources) \
+	$(misc_a_c_sources) \
+	$(misc_a_asm_sources) \
+	$(stdio_a_c_sources) \
+	$(stdio_a_asm_sources) \
+	$(libm_a_c_sources) \
+	$(libm_a_asm_sources) \
+	$(time_a_c_sources) \
+	$(time_a_asm_sources)
+
+nodist_libm_a_SOURCES = \
+	$(libm_a_c_sources) \
+	$(libm_a_asm_sources)
+
+libc_a_LIBADD = \
+	$(stdio_a_libadd) \
+	$(misc_a_libadd)
+
+libc_a_DEPENDENCIES = \
+	$(stdio_a_libadd) \
+	$(misc_a_libadd)
+
+else
+
+echo all distdir install installdirs clean distclean uninstall check:
+
+endif
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega3/short-calls/Makefile.am avr-libc-r2546/avr/lib/avrxmega3/short-calls/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega3/short-calls/Makefile.am	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/avr/lib/avrxmega3/short-calls/Makefile.am	2018-05-22 09:18:21.856634800 +0400
@@ -0,0 +1,107 @@
+# Copyright (c) 2004,  Theodore A. Roth
+# Copyright (c) 2005, 2008, 2009  Anatoly Sokolov
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+# * Redistributions of source code must retain the above copyright
+#   notice, this list of conditions and the following disclaimer.
+# * Redistributions in binary form must reproduce the above copyright
+#   notice, this list of conditions and the following disclaimer in
+#   the documentation and/or other materials provided with the
+#   distribution.
+# * Neither the name of the copyright holders nor the names of
+#   contributors may be used to endorse or promote products derived
+#   from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+# POSSIBILITY OF SUCH DAMAGE.
+#
+
+SUBDIRS = 
+
+AVR_TARGET          = avrxmega3
+AVR_TARGET_DEFS     = -D__COMPILING_AVR_LIBC__
+AVR_TARGET_CFLAGS   = -mshort-calls -mcall-prologues -Os
+AVR_TARGET_ASFLAGS  = 
+AVR_INSTALL_DIR     = avrxmega3/short-calls
+
+VPATH = $(top_srcdir)/libc/stdlib:$(top_srcdir)/libc/pmstring:$(top_srcdir)/libc/string:$(top_srcdir)/libc/misc:$(top_srcdir)/libc/stdio:$(top_srcdir)/libm/fplib:$(top_srcdir)/libc/time
+
+if HAS_avrxmega3
+
+AVRLIB_DEVLIST =
+
+AM_CPPFLAGS = -I$(top_srcdir)/common -I$(top_srcdir)/include -I$(top_builddir)/include
+
+AVRLIB_CFLAGS = @CDEBUG@ -Wall -W -Wstrict-prototypes -mmcu=$(AVR_TARGET) $(AVR_TARGET_DEFS) $(AVR_TARGET_CFLAGS)
+
+AVRLIB_ASFLAGS = -x assembler-with-cpp @ASDEBUG@ -mmcu=$(AVR_TARGET) $(AVR_TARGET_DEFS) $(AVR_TARGET_ASFLAGS)
+
+AM_CFLAGS = $(AVRLIB_CFLAGS)
+AM_CCASFLAGS = $(AM_CPPFLAGS) $(AVRLIB_ASFLAGS)
+
+__install_dir = $(prefix)/avr/lib/$(AVR_INSTALL_DIR)
+
+avrdir = $(__install_dir)
+avrlibdir = $(__install_dir)
+
+avr_LIBRARIES = \
+	libc.a \
+	libprintf_min.a \
+	libprintf_flt.a \
+	libscanf_min.a \
+	libscanf_flt.a \
+	libm.a
+
+include $(top_srcdir)/libc/stdlib/Rules.am
+include $(top_srcdir)/libc/pmstring/Rules.am
+include $(top_srcdir)/libc/string/Rules.am
+include $(top_srcdir)/libc/misc/Rules.am
+include $(top_srcdir)/libc/stdio/Rules.am
+include $(top_srcdir)/libm/fplib/Rules.am
+include $(top_srcdir)/libc/time/Rules.am
+
+nodist_libc_a_SOURCES = \
+	$(stdlib_a_c_sources) \
+	$(stdlib_a_asm_sources) \
+	$(pmstring_a_c_sources) \
+	$(pmstring_a_asm_sources) \
+	$(string_a_c_sources) \
+	$(string_a_asm_sources) \
+	$(misc_a_c_sources) \
+	$(misc_a_asm_sources) \
+	$(stdio_a_c_sources) \
+	$(stdio_a_asm_sources) \
+	$(libm_a_c_sources) \
+	$(libm_a_asm_sources) \
+	$(time_a_c_sources) \
+	$(time_a_asm_sources)
+
+nodist_libm_a_SOURCES = \
+	$(libm_a_c_sources) \
+	$(libm_a_asm_sources)
+
+libc_a_LIBADD = \
+	$(stdio_a_libadd) \
+	$(misc_a_libadd)
+
+libc_a_DEPENDENCIES = \
+	$(stdio_a_libadd) \
+	$(misc_a_libadd)
+
+else
+
+echo all distdir install installdirs clean distclean uninstall check:
+
+endif
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64a3/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64a3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64a3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64a3/Makefile.am	2018-05-22 09:18:22.093830200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64a3.a
-nodist_libatxmega64a3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64a3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64a3u/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64a3u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64a3u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64a3u/Makefile.am	2018-05-22 09:18:22.209177900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64a3u.a
-nodist_libatxmega64a3u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64a3u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64a4u/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64a4u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64a4u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64a4u/Makefile.am	2018-05-22 09:18:22.323444300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64a4u.a
-nodist_libatxmega64a4u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64a4u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64b1/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64b1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64b1/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64b1/Makefile.am	2018-05-22 09:18:22.439144600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64b1.a
-nodist_libatxmega64b1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64b1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64b3/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64b3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64b3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64b3/Makefile.am	2018-05-22 09:18:22.554673900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64b3.a
-nodist_libatxmega64b3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64b3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64c3/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64c3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64c3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64c3/Makefile.am	2018-05-22 09:18:22.669075500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64c3.a
-nodist_libatxmega64c3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64c3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64d3/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64d3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64d3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64d3/Makefile.am	2018-05-22 09:18:22.784411500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64d3.a
-nodist_libatxmega64d3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64d3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64d4/Makefile.am avr-libc-r2546/avr/lib/avrxmega4/atxmega64d4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega4/atxmega64d4/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega4/atxmega64d4/Makefile.am	2018-05-22 09:18:22.899837500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64d4.a
-nodist_libatxmega64d4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64d4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega5/atxmega64a1/Makefile.am avr-libc-r2546/avr/lib/avrxmega5/atxmega64a1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega5/atxmega64a1/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega5/atxmega64a1/Makefile.am	2018-05-22 09:18:23.538374100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64a1.a
-nodist_libatxmega64a1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64a1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega5/atxmega64a1u/Makefile.am avr-libc-r2546/avr/lib/avrxmega5/atxmega64a1u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega5/atxmega64a1u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega5/atxmega64a1u/Makefile.am	2018-05-22 09:18:23.654121600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega64a1u.a
-nodist_libatxmega64a1u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega64a1u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128a3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128a3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128a3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128a3/Makefile.am	2018-05-22 09:18:24.070091300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128a3.a
-nodist_libatxmega128a3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128a3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128a3u/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128a3u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128a3u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128a3u/Makefile.am	2018-05-22 09:18:24.185404900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128a3u.a
-nodist_libatxmega128a3u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128a3u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128b1/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128b1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128b1/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128b1/Makefile.am	2018-05-22 09:18:24.301176300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128b1.a
-nodist_libatxmega128b1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128b1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128b3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128b3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128b3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128b3/Makefile.am	2018-05-22 09:18:24.416094000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128b3.a
-nodist_libatxmega128b3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128b3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128c3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128c3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128c3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128c3/Makefile.am	2018-05-22 09:18:24.531474300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128c3.a
-nodist_libatxmega128c3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128c3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128d3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128d3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128d3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128d3/Makefile.am	2018-05-22 09:18:24.648434700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128d3.a
-nodist_libatxmega128d3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128d3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128d4/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega128d4/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega128d4/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega128d4/Makefile.am	2018-05-22 09:18:24.763817500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128d4.a
-nodist_libatxmega128d4_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128d4_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192a3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega192a3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192a3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega192a3/Makefile.am	2018-05-22 09:18:24.879605300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega192a3.a
-nodist_libatxmega192a3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega192a3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192a3u/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega192a3u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192a3u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega192a3u/Makefile.am	2018-05-22 09:18:24.994389300 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega192a3u.a
-nodist_libatxmega192a3u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega192a3u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192c3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega192c3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192c3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega192c3/Makefile.am	2018-05-22 09:18:25.110045200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega192c3.a
-nodist_libatxmega192c3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega192c3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192d3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega192d3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega192d3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega192d3/Makefile.am	2018-05-22 09:18:25.226536100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega192d3.a
-nodist_libatxmega192d3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega192d3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3/Makefile.am	2018-05-22 09:18:25.341839500 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega256a3.a
-nodist_libatxmega256a3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega256a3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3b/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3b/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3b/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3b/Makefile.am	2018-05-22 09:18:25.571483800 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega256a3b.a
-nodist_libatxmega256a3b_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega256a3b_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3bu/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3bu/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3bu/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3bu/Makefile.am	2018-05-22 09:18:25.687558900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega256a3bu.a
-nodist_libatxmega256a3bu_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega256a3bu_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3u/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256a3u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega256a3u/Makefile.am	2018-05-22 09:18:25.456355700 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega256a3u.a
-nodist_libatxmega256a3u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega256a3u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256c3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega256c3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256c3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega256c3/Makefile.am	2018-05-22 09:18:25.803110200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega256c3.a
-nodist_libatxmega256c3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega256c3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256d3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega256d3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega256d3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega256d3/Makefile.am	2018-05-22 09:18:25.918714000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega256d3.a
-nodist_libatxmega256d3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega256d3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega384c3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega384c3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega384c3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega384c3/Makefile.am	2018-05-22 09:18:26.034507600 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega384c3.a
-nodist_libatxmega384c3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega384c3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega384d3/Makefile.am avr-libc-r2546/avr/lib/avrxmega6/atxmega384d3/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega6/atxmega384d3/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega6/atxmega384d3/Makefile.am	2018-05-22 09:18:26.149821000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega384d3.a
-nodist_libatxmega384d3_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega384d3_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega7/atxmega128a1/Makefile.am avr-libc-r2546/avr/lib/avrxmega7/atxmega128a1/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega7/atxmega128a1/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega7/atxmega128a1/Makefile.am	2018-05-22 09:18:27.198351900 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128a1.a
-nodist_libatxmega128a1_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128a1_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega7/atxmega128a1u/Makefile.am avr-libc-r2546/avr/lib/avrxmega7/atxmega128a1u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega7/atxmega128a1u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega7/atxmega128a1u/Makefile.am	2018-05-22 09:18:27.312597200 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128a1u.a
-nodist_libatxmega128a1u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128a1u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/avrxmega7/atxmega128a4u/Makefile.am avr-libc-r2546/avr/lib/avrxmega7/atxmega128a4u/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/avrxmega7/atxmega128a4u/Makefile.am	2016-02-09 00:08:55.000000000 +0300
+++ avr-libc-r2546/avr/lib/avrxmega7/atxmega128a4u/Makefile.am	2018-05-22 09:18:27.429204100 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = libatxmega128a4u.a
-nodist_libatxmega128a4u_a_SOURCES = $(eeprom_asm_sources)
+nodist_libatxmega128a4u_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr/lib/Makefile.am avr-libc-r2546/avr/lib/Makefile.am
--- avr-libc-2.0.0-orig/avr/lib/Makefile.am	2016-02-09 00:08:56.000000000 +0300
+++ avr-libc-r2546/avr/lib/Makefile.am	2018-05-22 09:18:28.823647700 +0400
@@ -27,4 +27,4 @@
 # POSSIBILITY OF SUCH DAMAGE.
 #
 
-SUBDIRS =  avr2 avr2/tiny-stack avr25 avr25/tiny-stack avr3 avr31 avr35 avr4 avr5 avr51 avr6 avrxmega2 avrxmega4 avrxmega5 avrxmega6 avrxmega7 avrtiny
+SUBDIRS =  avr2 avr2/tiny-stack avr25 avr25/tiny-stack avr3 avr31 avr35 avr4 avr5 avr51 avr6 avrxmega2 avrxmega3 avrxmega3/short-calls avrxmega4 avrxmega5 avrxmega6 avrxmega7 avrtiny
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/avr-libc.spec avr-libc-r2546/avr-libc.spec
--- avr-libc-2.0.0-orig/avr-libc.spec	2016-02-09 00:12:57.000000000 +0300
+++ avr-libc-r2546/avr-libc.spec	2018-05-22 09:41:57.014264900 +0400
@@ -36,7 +36,7 @@
 ## avr-libc.spec.  Generated from avr-libc.spec.in by configure.
 ##
 
-%define libc_version 2.0.0
+%define libc_version 2.0.0svn
 
 # We don't want rpm stripping any files
 %define __spec_install_post %{nil}
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog avr-libc-r2546/ChangeLog
--- avr-libc-2.0.0-orig/ChangeLog	2016-02-09 00:07:14.000000000 +0300
+++ avr-libc-r2546/ChangeLog	2018-05-22 08:51:53.000000000 +0400
@@ -1,199 +1,93 @@
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+2017-08-18  basil
 
-	* configure.ac: Release version 2.0.0.
-
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* doc/api/rel-method.dox: Mention major number 2.
-
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* doc/api/overview.dox: Remove obsolete sentence claiming
-	SimulAVR were unmaintained.
-
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* configure.ac: Bump version to 2.0.0, in preparation of the
-	upcoming release.
-
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* doc/api/dox_html_header: Drop the alphabetical index from the
-	top bar, as it does not work as expected when setting
-	DISABLE_INDEX in the config file (it only yielded the very first
-	index block, i.e. names starting with an underscore). Since
-	there's now a search field, the value of the index is questionable
-	anyway.
-
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* doc/api/doxygen.config.in (MARKDOWN_SUPPORT): Turn off markdown
-	support, as it clashes with the use of __FOO__-style macro names.
-	* include/util/delay.h.in: Rephrase and reformat the documentation
-	of _delay_ms() and _delay_us().  This fixes the remaining doxygen
-	warnings.
-
-2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* doc/api/main_page.dox: Update copyright year.
-
-2016-02-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	Fix most of the doxygen warnings.
-	* doc/examples/asmdemo/asmdemo.dox: (Dito.)
-	* include/avr/boot.h: (Dito.)
-	* include/avr/fuse.h: (Dito.)
-	* include/avr/lock.h: (Dito.)
-	* include/avr/pgmspace.h: (Dito.)
-	* include/avr/power.h: (Dito.)
-	* include/avr/sleep.h: (Dito.)
-	* include/avr/wdt.h: (Dito.)
-	* include/errno.h: (Dito.)
-	* include/math.h: (Dito.)
-	* include/setjmp.h: (Dito.)
-	* include/stdint.h: (Dito.)
-	* include/stdio.h: (Dito.)
-	* include/stdlib.h: (Dito.)
-	* include/string.h: (Dito.)
-	* include/time.h: (Dito.)
-	* include/util/delay.h.in: (Dito.)
-	* libc/pmstring/memchr_P.S: (Dito.)
-	* libc/pmstring/memcmp_P.S: (Dito.)
-	* libc/pmstring/memcmp_PF.S: (Dito.)
-	* libc/pmstring/memcpy_P.S: (Dito.)
-	* libc/pmstring/memcpy_PF.S: (Dito.)
-	* libc/pmstring/memrchr_P.S: (Dito.)
-	* libc/pmstring/strcasecmp_P.S: (Dito.)
-	* libc/pmstring/strcasecmp_PF.S: (Dito.)
-	* libc/pmstring/strcat_P.S: (Dito.)
-	* libc/pmstring/strcat_PF.S: (Dito.)
-	* libc/pmstring/strchr_P.S: (Dito.)
-	* libc/pmstring/strchrnul_P.S: (Dito.)
-	* libc/pmstring/strcmp_P.S: (Dito.)
-	* libc/pmstring/strcmp_PF.S: (Dito.)
-	* libc/pmstring/strcpy_P.S: (Dito.)
-	* libc/pmstring/strcpy_PF.S: (Dito.)
-	* libc/pmstring/strcspn_P.S: (Dito.)
-	* libc/pmstring/strlcat_P.S: (Dito.)
-	* libc/pmstring/strlcat_PF.S: (Dito.)
-	* libc/pmstring/strlcpy_P.S: (Dito.)
-	* libc/pmstring/strlcpy_PF.S: (Dito.)
-	* libc/pmstring/strlen_P.S: (Dito.)
-	* libc/pmstring/strlen_PF.S: (Dito.)
-	* libc/pmstring/strncasecmp_P.S: (Dito.)
-	* libc/pmstring/strncasecmp_PF.S: (Dito.)
-	* libc/pmstring/strncat_P.S: (Dito.)
-	* libc/pmstring/strncat_PF.S: (Dito.)
-	* libc/pmstring/strncmp_P.S: (Dito.)
-	* libc/pmstring/strncmp_PF.S: (Dito.)
-	* libc/pmstring/strncpy_P.S: (Dito.)
-	* libc/pmstring/strncpy_PF.S: (Dito.)
-	* libc/pmstring/strnlen_P.S: (Dito.)
-	* libc/pmstring/strnlen_PF.S: (Dito.)
-	* libc/pmstring/strpbrk_P.S: (Dito.)
-	* libc/pmstring/strrchr_P.S: (Dito.)
-	* libc/pmstring/strsep_P.S: (Dito.)
-	* libc/pmstring/strspn_P.S: (Dito.)
-	* libc/pmstring/strstr_P.S: (Dito.)
-	* libc/pmstring/strstr_PF.S: (Dito.)
-	* libc/pmstring/strtok_P.c: (Dito.)
-	* libc/pmstring/strtok_rP.S: (Dito.)
-	* libc/stdlib/atexit.c: (Dito.)
-	* libc/string/memccpy.S: (Dito.)
-	* libc/string/memmem.S: (Dito.)
-	* libc/string/strcasestr.S: (Dito.)
-	* libc/string/strtok.c: (Dito.)
-
-2016-02-06  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
-
-	* doc/api/doxygen.config.in: Update doxygen infrastructur to Doxygen 1.8.7
-	* doc/api/dox.css: Ditto.
-	* doc/api/dox_html_footer: Ditto.
-	* doc/api/dox_html_header: Ditto.
-
-2016-02-05  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
-
-	patch #8902: Xmega's PROTECTED_WRITE is incorrect for IO registers
-	whose address is more than one byte
-	* include/avr/xmega.h (_PROTECTED_WRITE): Update constraint for
-	IO register to allow more than 1 byte address. Cast CCP signature and
-	value to be written to avoid un-optimal load.
-
-2016-01-28  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
-
-	Added new devices.
-	* configure.ac: Add ATA5702M322, ATA5782, ATA5790N, ATA5831, ATA6613C,
-	ATA6614Q, ATmega64HVE2, ATxmega8E5, ATxmega32C3, ATxmega32D3
-	and ATxmega32E5 devices.
-	* devtools/gen-avr-lib-tree.sh: Likewise.
-	* devtools/iosym/Makefile.am: Add assembly macro files for new devices.
-	* doc/api/main_page.dox: Document new device support.
-	* doc/api/using-tools.dox: Likewise.
-	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
-	* include/avr/io.h: Add hooks for new devices.
-	* include/avr/ioa5702m322.h: New device header file.
-	* include/avr/ioa5782.h: Ditto.
-	* include/avr/ioa5790n.h: Ditto.
-	* include/avr/ioa5831.h: Ditto.
-	* include/avr/ioa6613c.h: Ditto.
-	* include/avr/ioa6614q.h: Ditto.
-	* include/avr/iom64hve2.h: Ditto.
-	* include/avr/iox32c3.h: Ditto.
-	* include/avr/iox32d3.h: Ditto.
-	* include/avr/iox32e5.h: Ditto.
-	* include/avr/iox8e5.h: Ditto.
-	* crt1/iosym/ata5702m322.S: Generated.
-	* crt1/iosym/ata5782.S: Ditto.
-	* crt1/iosym/ata5790n.S: Ditto.
-	* crt1/iosym/ata5831.S: Ditto.
-	* crt1/iosym/ata6613c.S: Ditto.
-	* crt1/iosym/ata6614q.S: Ditto.
-	* crt1/iosym/atmega64hve2.S: Ditto.
-	* crt1/iosym/atxmega32c3.S: Ditto.
-	* crt1/iosym/atxmega32d3.S: Ditto.
-	* crt1/iosym/atxmega32e5.S: Ditto.
-	* crt1/iosym/atxmega8e5.S: Ditto.
-
-2016-01-28  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
-
-	Fixed distcheck errors.
-	* crt1/iosym/Makefile.am (EXTRA_DIST): Add missed device files.
-	* devtools/Device.am: Donot distribute libdev and lib<dev> sources.
-	* libc/Makefile.am (DIST_SUBDIRS): Add misc directory for distribution.
-
-2016-01-25  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
-
-	* configure.ac: Add ATA6612C, ATA6617C, ATA664251, ATmega48PB and
-	ATmega88PB devices.
-	* devtools/gen-avr-lib-tree.sh: Likewise.
-	* devtools/generate_iosym.sh: Likewise.
-	* doc/api/main_page.dox: Document new device support.
-	* doc/api/using-tools.dox: Likewise.
-	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
-	* include/avr/io.h: Add hooks for new devices.
-	* include/avr/ioa6612c.h: Newfile.
-	* include/avr/ioa6617c.h: Ditto.
-	* include/avr/ioa664251.h: Ditto.
-	* include/avr/iom48pb.h: Ditto.
-	* include/avr/iom88pb.h: Ditto.
-	* crt1/iosym/ata6612c.S: Generated.
-	* crt1/iosym/ata6617c.S: Ditto.
-	* crt1/iosym/ata664251.S: Ditto.
-	* crt1/iosym/atmega48pb.S: Ditto.
-	* crt1/iosym/atmega88pb: Ditto.
-
-2016-01-25  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
-
-	* configure.ac: Add ATA6616C, ATtiny441 and ATtiny841 devices.
-	* devtools/gen-avr-lib-tree.sh: Likewise.
-	* devtools/generate_iosym.sh: Likewise.
-	* doc/api/main_page.dox: Document new device support.
-	* doc/api/using-tools.dox: Likewise.
-	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
-	* include/avr/io.h: Add hooks for new devices.
-	* include/avr/ioa6616c.h: Newfile.
-	* include/avr/iotn441.h: Ditto.
-	* include/avr/iotn841.h: Ditto.
-	* crt1/iosym/ata6616c.S: Generated.
-	* crt1/iosym/attiny441.S: Ditto.
-	* crt1/iosym/attiny841.S: Ditto.
+	Fix for bug #51755: iotn441.h & iotn841.h missing definitions for PUEA[0-7] and PUEB[0-3]
+	* include/avr/iotn441.h: Add defines for PUEA[0-7] and PUEB[0-3]
+	* include/avr/iotn841.h: Likewise.
+
+2017-07-05  Georg-Johann Lay <avr@gjlay.de>
+
+	patch #9400: Add multilib support for avrxmega3 + avrxmega3/short-calls.
+	* configure.ac (CHECK_AVR_DEVICE): Add one for avrxmega3.
+	(AM_CONDITIONAL): Add one for HAS_avrxmega3.
+	(AC_CONFIG_FILES): Add avr/lib/avrxmega3/Makefile,
+	avr/lib/avrxmega3/short-calls/Makefile.
+	* devtools/gen-avr-lib-tree.sh (CFLAGS_SHORT_CALLS): New.
+	(AVRXMEGA3_DEV_INFO): New.
+	(AVRXMEGA3SC_DEV_INFO): New.
+	(AVR_ARH_INFO): Add entries avrxmega3, avrxmega3/short-calls.
+	* include/avr/pgmspace.h (__AVR_HAVE_RAMPD__): Fix comment.
+
+2017-06-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/faq.dox (faq_reg_usage): Document differences for
+	AVR_TINY architecture.
+
+2017-06-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Georg-Johann Lay:
+	patch #9187: [AVR_TINY]: Support 16-bit xtoa functons and more string functions.
+	* common/asmdef.h (X_sbiw): New asm macro.
+	* common/macros.inc (X_sbiw): New asm macro.
+	* libc/misc/itoa.S: Don't restrict to !AVR_TINY.
+	* libc/misc/itoa_ncheck.S: Same.
+	* libc/misc/utoa.S: Same.
+	* libc/misc/utoa_ncheck.S: Same. And use X_sbiw instead of sbiw.
+	* libc/string/strlcat.S: Same.
+	* libc/string/strncat.S: Same.
+	* libc/string/strrev.S: Same.
+	* libc/string/strrchr.S: Same.
+	* libc/string/memchr.S: Don't restrict to !AVR_TINY.
+	[AVR_TINY]: Use "ld __tmp_reg__,-R" instead of "sbiw R,1".
+	* libc/string/strcat.S: Same.
+	* libc/string/strchr.S: Same.
+	* libc/string/memrchr.S: Don't restrict to !AVR_TINY.
+	(r0): Use __tmp_reg__ instead.
+	(adiw ZL,0): Use X_sbiw ZL,0 for comparison against 0 instead.
+	* libc/string/strchrnul.S: Don't restrict to !AVR_TINY.
+	(r0): Use __tmp_reg__ instead.
+	[AVR_TINY]: Use "ld __tmp_reg__,-R" instead of "sbiw R,1".
+	* libc/string/strpbrk.S: Same.
+	* libc/string/strstr.S: Don't restrict to !AVR_TINY.
+	Use X_sbiw instead of sbiw.
+	(chr2): Define to __tmp_reg__ instead of to r0.
+	* libc/string/strtok_r.S: Don't restrict to !AVR_TINY.
+	Use X_sbiw instead of sbiw.
+	(dch) [AVR_TINY]: Push / pop r18 around function.
+	[AVR_TINY]: Use "ld __tmp_reg__,R+" instead of "adiw R,1".
+
+2017-06-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Britton Kerin:
+	patch #8650: another small doc fix in atomic.h
+	* include/util/atomic.h: Improve documentation.
+
+2017-06-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Britton Kerin:
+	patch #8649: small documentation fixes in
+	* include/util/atomic.h: Improve documentation.
+
+2017-06-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Karol Babioch:
+	patch #8536: Fix a typo within <stdio.h>
+	* include/stdio.h: Fix small typo.
+
+2017-06-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Georg-Johann Lay:
+	patch #8729: [avr/interrupt.h] Add ISR_NOICF, ISR_FLATTEN. Fix namespace of identifiers.
+	* include/avr/interrupt.h: Add ISR_NOICF, ISR_FLATTEN
+
+2017-03-31  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/util/eu_dst.h: Fix reversed DST decision logic for March
+	and October.
+
+2017-03-07  Pitchumani Sivanupandi <pitchumani.sivanupandi@microchip.com>
+
+	Fix for bug #50439: avr/iom32u4.h does not define PRTIM4
+	* include/avr/iom16u4.h (PRTIM4): Define.
+	(__AVR_HAVE_PRR1): Update definition.
+	(__AR_HAVE_PRR1_PRTIM4): Define.
+	* include/avr/iom33u4.h: Likewise.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2010 avr-libc-r2546/ChangeLog-2010
--- avr-libc-2.0.0-orig/ChangeLog-2010	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2010	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,864 @@
+2010-12-16  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    Fix for bug #31270.
+    * doc/examples/twitest/twitest.dox: Fix stale document link.
+    * NEWS: Add to fixed bug list.
+
+2010-12-16  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    Fix for bug #29235.
+    * include/avr/power.h: Rearrange commas to be -pedantic safe.
+    * NEWS: Add to fixed bug list.
+
+2010-12-13  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    Fix for Atmel bug #12314.
+    * include/avr/iox192a3.h: Fix field names and macro names.
+    * include/avr/iox128a3.h: Same.
+    * include/avr/iox128a1.h: Same.
+    * include/avr/iox64a3.h: Same.
+    * include/avr/iox64a1.h: Same.
+    * include/avr/iox32d4.h: Same.
+    * include/avr/iox32a4.h: Same.
+    * include/avr/iox16d4.h: Same.
+    * include/avr/iox16a4.h: Same.
+    * include/avr/iox256a3b.h: Same.
+    * include/avr/iox256a3.h: Same.
+    * NEWS: Add to fixed bug list.
+
+2010-12-13  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    Fix for Atmel bug #11793.
+    * include/avr/iox32a4.h: Fix 4086 to 4096.
+    * include/avr/iox16a4.h: Same.
+    * include/avr/iox256a3b.h: Same.
+    * include/avr/iox256a3.h: Same.
+    * include/avr/iox192a3.h: Same.
+    * include/avr/iox128a3.h: Same.
+    * include/avr/iox128a1.h: Same.
+    * include/avr/iox64a3.h: Same.
+    * include/avr/iox64a1.h: Same.
+    * NEWS: Add to fixed bug list.
+
+2010-11-24  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    * doc/api/main_page.dox: Add blank line to fix indentation in HTML docs.
+
+2010-11-24  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Workaround for LaTeX build error after upgrading doxygen to
+	version 1.7.x
+	* doc/api/Makefile.am: replace the \renewcommand for
+	\cftchapfont and \cftchappagefont, respectively, by a
+	\newcommand.
+
+2010-11-23  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    * doc/api/rel-method.dox: Escape all instances of @svn to silence
+    doxygen warnings.
+
+2010-11-22  Eric B. Weddington  <eric.weddington@atmel.com>
+
+    * configure.ac: Fix 2.64 cross compile detection for AVR by not trying to
+    compile fopen. This fix came from Newlib's config/override.m4. For some
+    reason autoconf 2.64 (and possibly above) puts in a check for the compiler
+    output file extension and creates a test program that has the fopen
+    function. Of course, this fails when avr-gcc is used to compile the test
+    program.
+
+2010-11-16  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix Atmel bug #12536.
+	* include/avr/iox64d3.h: Remove CALCTRL definitions.
+	* include/avr/iox64a3.h: Same.
+	* include/avr/iox64a1.h: Same.
+	* include/avr/iox32d4.h: Same.
+	* include/avr/iox32a4.h: Same.
+	* include/avr/iox256a3b.h: Same.
+	* include/avr/iox256a3.h: Same.
+	* include/avr/iox192d3.h: Same.
+	* include/avr/iox192a3.h: Same.
+	* include/avr/iox16d4.h: Same.
+	* include/avr/iox16a4.h: Same.
+	* include/avr/iox128d3.h: Same.
+	* include/avr/iox128a3.h: Same.
+	* include/avr/iox128a1.h: Same.
+	* NEWS: Add to fixed bugs list.
+
+2010-11-08  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom3000.h: Fix typo.
+
+2010-11-08  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom169pa.h: Rename UBRR0* definitions to remove a duplicate.
+	* libc/pmstring/strcasecmp_PF.S: Fix warning at end of file.
+	* include/avr/iom16hva2.h: Fix SPI interrupt vector names.
+	* include/avr/iom3000.h: Comment out duplicate definitions.
+
+2010-11-05  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* common/asmdef.h: Add conditional compilation to not compile for
+	ATiny10 family.
+	* common/ctoasm.inc: Same.
+	* libc/misc/eeupd_byte.S: Same.
+	* libc/misc/itoa.S: Same.
+	* libc/misc/utoa.S: Same.
+	* libc/pmstring/memchr_P.S: Same.
+	* libc/pmstring/memcmp_P.S: Same.
+	* libc/pmstring/memcmp_PF.S: Same.
+	* libc/pmstring/memcpy_P.S: Same.
+	* libc/pmstring/memcpy_PF.S: Same.
+	* libc/pmstring/memrchr_P.S: Same.
+	* libc/pmstring/strcasecmp_P.S: Same.
+	* libc/pmstring/strcasecmp_PF.S: Same.
+	* libc/pmstring/strcat_P.S: Same.
+	* libc/pmstring/strcat_PF.S: Same.
+	* libc/pmstring/strchr_P.S: Same.
+	* libc/pmstring/strchrnul_P.S: Same.
+	* libc/pmstring/strcmp_P.S: Same.
+	* libc/pmstring/strcmp_PF.S: Same.
+	* libc/pmstring/strcpy_P.S: Same.
+	* libc/pmstring/strcpy_PF.S: Same.
+	* libc/pmstring/strcspn_P.S: Same.
+	* libc/pmstring/strlcat_P.S: Same.
+	* libc/pmstring/strlcat_PF.S: Same.
+	* libc/pmstring/strlcpy_P.S: Same.
+	* libc/pmstring/strlcpy_PF.S: Same.
+	* libc/pmstring/strlen_P.S: Same.
+	* libc/pmstring/strlen_PF.S: Same.
+	* libc/pmstring/strncasecmp_P.S: Same.
+	* libc/pmstring/strncasecmp_PF.S: Same.
+	* libc/pmstring/strncat_P.S: Same.
+	* libc/pmstring/strncat_PF.S: Same.
+	* libc/pmstring/strncmp_P.S: Same.
+	* libc/pmstring/strncmp_PF.S: Same.
+	* libc/pmstring/strncpy_P.S: Same.
+	* libc/pmstring/strncpy_PF.S: Same.
+	* libc/pmstring/strnlen_P.S: Same.
+	* libc/pmstring/strnlen_PF.S: Same.
+	* libc/pmstring/strpbrk_P.S: Same.
+	* libc/pmstring/strrchr_P.S: Same.
+	* libc/pmstring/strsep_P.S: Same.
+	* libc/pmstring/strspn_P.S: Same.
+	* libc/pmstring/strstr_P.S: Same.
+	* libc/pmstring/strstr_PF.S: Same.
+	* libc/pmstring/strtok_P.c: Same.
+	* libc/pmstring/strtok_rP.S: Same.
+	* libc/stdio/fputs_p.c: Same.
+	* libc/stdio/puts_p.c: Same.
+	* libc/stdio/ultoa_invert.S: Same.
+	* libc/stdio/vfprintf.c: Same.
+	* libc/stdio/vfscanf.c: Same.
+	* libc/stdlib/ftoa_engine.S: Same.
+	* libc/stdlib/setjmp.S: Same.
+	* libc/stdlib/strtod.c: Same.
+	* libc/string/ffsll.S: Same.
+	* libc/string/memccpy.S: Same.
+	* libc/string/memchr.S: Same.
+	* libc/string/memmem.S: Same.
+	* libc/string/memrchr.S: Same.
+	* libc/string/strcasestr.S: Same.
+	* libc/string/strcat.S: Same.
+	* libc/string/strchr.S: Same.
+	* libc/string/strchrnul.S: Same.
+	* libc/string/strcspn.S: Same.
+	* libc/string/strlcpy.S: Same.
+	* libc/string/strncat.S: Same.
+	* libc/string/strpbrk.S: Same.
+	* libc/string/strrchr.S: Same.
+	* libc/string/strrev.S: Same.
+	* libc/string/strsep.S: Same.
+	* libc/string/strspn.S: Same.
+	* libc/string/strstr.S: Same.
+	* libc/string/strtok_r.S: Same.
+	* libm/fplib/acos.S: Same.
+	* libm/fplib/addsf3x.S: Same.
+	* libm/fplib/asin.S: Same.
+	* libm/fplib/atan.S: Same.
+	* libm/fplib/atan2.S: Same.
+	* libm/fplib/cbrt.S: Same.
+	* libm/fplib/ceil.S: Same.
+	* libm/fplib/divsf3x.S: Same.
+	* libm/fplib/exp.S: Same.
+	* libm/fplib/fdim.S: Same.
+	* libm/fplib/fixsfsi.S: Same.
+	* libm/fplib/floatsisf.S: Same.
+	* libm/fplib/floatundisf.S: Same.
+	* libm/fplib/floor.S: Same.
+	* libm/fplib/fma.S: Same.
+	* libm/fplib/fmax.S: Same.
+	* libm/fplib/fmin.S: Same.
+	* libm/fplib/fmod.S: Same.
+	* libm/fplib/fp_cmp.S: Same.
+	* libm/fplib/fp_mpack.S: Same.
+	* libm/fplib/fp_powser.S: Same.
+	* libm/fplib/fp_pscA.S: Same.
+	* libm/fplib/fp_pscB.S: Same.
+	* libm/fplib/fp_round.S: Same.
+	* libm/fplib/fp_sinus.S: Same.
+	* libm/fplib/fp_split3.S: Same.
+	* libm/fplib/fp_trunc.S: Same.
+	* libm/fplib/frexp.S: Same.
+	* libm/fplib/isinf.S: Same.
+	* libm/fplib/ldexp.S: Same.
+	* libm/fplib/log.S: Same.
+	* libm/fplib/lrint.S: Same.
+	* libm/fplib/lround.S: Same.
+	* libm/fplib/modf.S: Same.
+	* libm/fplib/mulsf3x.S: Same.
+	* libm/fplib/pow.S: Same.
+	* libm/fplib/round.S: Same.
+	* libm/fplib/sin.S: Same.
+	* libm/fplib/sinh.S: Same.
+	* libm/fplib/sqrt.S: Same.
+	* libm/fplib/tanh.S: Same.
+
+2010-10-26  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	Thanks to Eric Weddington for the patch.
+	* common/macros.inc: __tmp_reg__ and __zero_reg__
+	redefined for tiny target.
+	* include/avr/iom3000.h: Define _VECTORS_SIZE.
+
+2010-10-13  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* include/util/delay.h.in: Functions _delay_ms and 
+	_delay_us are modified. They now calculate new _ticks
+	value when builtin_avr_delay_cycle() is used. Macros
+	__DELAY_ROUND_DOWN__, __DELAY_ROUND_CLOSEST__ control
+	round up/closest of _ticks. __DELAY_BACKWARD_COMPATIBLE__
+	macro enables backward compatibility. This macro will be
+	deprecated.
+
+2010-09-28  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* include/avr/iotn88.h: Fix RAMEND.
+
+2010-09-22  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* doc/examples/twitest/twitest.c: Fix endaddr calculation
+	in ee24xx_write_page function.
+
+2010-09-22  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* doc/examples/stdiodemo/defines.h: Modify comment
+
+2010-09-22  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	Fix for bugs #30552 and #30569. 
+	Thanks to Frederic Nadeau for the patch.
+	* include/avr/iom16u4.h: Modify ADCTS3 to 3.
+	* include/avr/iom32u4.h: Add definition for ADCW.
+	Add__ASSEMBLER__ macro for ADC.
+	Modify ADCTS3 to 3
+	* include/avr/iotn43u.h: Add definition for ADCW.
+	Add__ASSEMBLER__ macro for ADC.
+
+2010-09-21  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* include/avr/io90pwm2b.h: Modified SPM_PAGESIZE to 64 bytes.
+	* include/avr/io90pwm3b.h: Same.
+
+2010-09-20  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* include/iom16m1.h: Add definitions for CANSIT, CANIDT and
+	CANIDM.
+	* include/iom32m1.h: Same.
+	* include/iom64m1.h: Same.
+	* include/iom32c1.h: Same.
+	* include/iom64c1.h: Same.
+
+2010-09-20  Anitha Boyapati  <anitha.boyapati@atmel.com>
+
+	* include/avr/wdt.h: Add definitions for ATmega325P and
+	ATmega3250P
+
+2010-08-22  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Atmel internal issue.
+	* include/avr/iotn87.h (BODS, BODSE): Fix value.
+	* include/avr/iotn167.h (BODS, BODSE): Same.
+
+2010-08-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Andr'e:
+	bug #30783 Missing prototype in power.h
+	* include/avr/power.h: Add prototype for clock_prescale_set()
+	for the second block (prescaler reachable by IN/OUT
+	instructions).
+
+2010-06-24  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/Makefile.am (avr_HEADERS): Add iom3000.h.
+
+2010-06-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Bump version to 1.7.1, after releasing.
+
+2010-06-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Released avr-libc-1.7.0.
+
+2010-06-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Bump version date in preparation for releasing
+	avr-libc 1.7.0.
+
+2010-06-15  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix bug #30148.
+	* include/avr/iox128a1.h: Rename HIRES.CTRL to HIRES.CTRLA.
+	* NEWS: Add to fixed bug list.
+
+2010-06-15  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* configure.ac: Change ATxemga32A4 from avrxmega3 to avrxmega2.
+	* devtools/gen-avr-lib-tree.sh: Same.
+	* doc/api/using-tools.dox: Same.
+
+2010-06-14  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* LICENSE: Update copyright year.
+
+2010-06-14  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/pgmspace.h: Remove new features regarding new segments.
+	Feature not yet ready. Correct comment.
+
+2010-06-13  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/pgmspace.h: Remove the #error for architectures that
+	don't support segmented progmem access.
+
+2010-06-12  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Special thanks to Carlos Lamas and Jan Waclawek for contributing
+	code in patch #6352 (that should've gotten in a long time ago).
+	* libc/pmstring/Files.am: Add new files to list.
+	* libc/pmstring/memcmp_PF.S: New file.
+	* libc/pmstring/memcpy_PF.S: Same.
+	* libc/pmstring/strcasecmp_PF.S: Same.
+	* libc/pmstring/strcat_PF.S: Same.
+	* libc/pmstring/strcmp_PF.S: Same.
+	* libc/pmstring/strcpy_PF.S: Same.
+	* libc/pmstring/strlcat_PF.S: Same.
+	* libc/pmstring/strlcpy_PF.S: Same.
+	* libc/pmstring/strlen_PF.S: Same.
+	* libc/pmstring/strncasecmp_PF.S: Same.
+	* libc/pmstring/strncat_PF.S: Same.
+	* libc/pmstring/strncmp_PF.S: Same.
+	* libc/pmstring/strncpy_PF.S: Same.
+	* libc/pmstring/strnlen_PF.S: Same.
+	* libc/pmstring/strstr_PF.S: Same.
+	* include/avr/pgmspace.h: Add support for far program memory
+	functions and macros.
+	* NEWS: Add news items.
+
+2010-06-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Atmel bug #11742.
+	* include/avr/iox128a1u.h: Change EBI_CS_ASPACE* to
+	EBI_CS_ASIZE*.
+	* include/avr/iox128a1.h: Same.
+	* include/avr/iox128a3.h: Same.
+	* include/avr/iox128d3.h: Same.
+	* include/avr/iox16a4.h: Same.
+	* include/avr/iox16d4.h: Same.
+	* include/avr/iox192a3.h: Same.
+	* include/avr/iox192d3.h: Same.
+	* include/avr/iox256a3.h: Same.
+	* include/avr/iox256a3b.h: Same.
+	* include/avr/iox256d3.h: Same.
+	* include/avr/iox32a4.h: Same.
+	* include/avr/iox32d4.h: Same.
+	* include/avr/iox64a1.h: Same.
+	* include/avr/iox64a1u.h: Same.
+	* include/avr/iox64a3.h: Same.
+	* include/avr/iox64d3.h: Same.
+
+2010-06-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Atmel bug #11738.
+	* include/avr/iox128d3.h (ADC_FLUSH_bm, ADC_ENABLE_bp): Add missing
+	definitions.
+	* include/avr/iox16d4.h: Same.
+	* include/avr/iox192d3.h: Same.
+	* include/avr/iox32d4.h: Same.
+	* include/avr/iox64d3.h: Same.
+
+2010-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #30104: power.h - Missing "power_usart1_/enable/disable()"
+	functions for ATmega644
+	* include/avr/power.h: Fix macros for ATmega644A/P/PA
+
+2010-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Jan Waclawek:
+	Document issues around compiler optimizations and code reordering
+	* doc/api/optimize.dox: New file.
+	* doc/api/doxygen.config.in: Add optimize.dox.
+	* include/avr/cpufunc.h (_MemoryBarrier): xref to optim_code_reorder
+	* include/avr/interrupt.h: (Ditto.)
+	* include/util/atomic.h: (Ditto.)
+
+2010-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/rel-method.dox: Adapt to our new release numbering scheme.
+
+2010-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* tests/simulate/avr/eeprom-1.c: Remove the old AT90S2313 simulator
+	bug workaround, as the workaround doesn't work anymore now while the
+	original code does.
+
+2010-06-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #26767.
+	* include/avr/iox256a3b.h: Added corrected names for GPIO registers.
+	* include/avr/iox128a1.h: Same.
+	* include/avr/iox128a3.h: Same.
+	* include/avr/iox16a4.h: Same.
+	* include/avr/iox16d4.h: Same.
+	* include/avr/iox192a3.h: Same.
+	* include/avr/iox256a3.h: Same.
+	* include/avr/iox32a4.h: Same.
+	* include/avr/iox64a1.h: Same.
+	* include/avr/iox64a3.h: Same.
+
+2010-06-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #28582.
+	* include/avr/iox256a3b.h: Add 3 missing double-word registers.
+	* NEWS: Add to fixed bugs list.
+
+2010-06-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #29502.
+	* include/avr/iox128a1.h (TC_EVACT_FRW_gc): Fix name to TC_EVACT_FRQ_gc.
+	* NEWS: Add to fixed bugs list.
+
+2010-06-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #29653.
+	* include/avr/iousbxx2.h (PUD): Add bit definition.
+	* NEWS: Add to fixed bugs list.
+
+2010-06-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Move some testscripts around.
+	* tests/simulate/other/malloc-01.c -> tests/simulate/stdlib/malloc-8.c
+	* tests/simulate/other/realloc-01.c -> tests/simulate/stdlib/realloc-3.c
+
+2010-06-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* libc/stdlib/malloc.c: Fix a bug introduced in r2131 that could
+	cause the freelist to be discarded.
+
+2010-06-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* tests/simulate/other/realloc-01.c: Cut out some bits when compling for
+	an AT90S8515 to avoid resource exhaustion (the ATmega128 version still
+	contains everything).
+	* tests/simulate/printf/sprintf-2.c: (Ditto.)
+	* tests/simulate/printf/sprintf-3.c: (Ditto.)
+	* tests/simulate/printf/sprintf-4.c: (Ditto.)
+	* tests/simulate/scanf/sscanf-l.c: (Ditto.)
+	* tests/simulate/scanf/sscanf_flt-fnn.c: (Ditto.)
+
+2010-06-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #28921: pointer to function > 128k flash
+	* doc/api/faq.dox (faq_funcptr_gt128kib): Add entry describing
+	that -mrelax is needed for the trampolines to work as designed.
+
+2010-06-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Don Kinzer:
+	bug #30018: Errors in include files
+	* include/avr/iotn40.h: Fix stray characters in macro names.
+	* include/avr/iom649p.h: (Ditto.)
+	* include/avr/iom169pa.h: (Ditto.)
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Various documentation fixes, mostly cosmetic.
+	* include/avr/cpufunc.h: Fix doc grouping.
+	* include/util/delay_basic.h: Slightly reorder, so it actually
+	generates documentation again.
+	* doc/api/rel-method.dox: Update for our SVN repository.
+	* doc/api/malloc.dox: Fix doxygen warning.
+	* doc/api/tools-install.dox: (Ditto.)
+	* doc/api/faq.dox: (Ditto.)
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #30085: memcpy_P on XMega does not clr NVM.CMD before copy
+	* include/avr/pgmspace.h: Mention that for Xmega devices,
+	these functions require NVM.CMD being set to 0x00.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/interrupt.h (cli, sei): Add a memory barrier,
+	and cross-reference <util/atomic.h>.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Implement new header file: <avr/cpufunc.h>
+	* include/avr/cpufunc.h: New file.
+	* include/avr/Makefile.am (avr_HEADERS): Add cpufunc.h.
+	* doc/api/doxygen.config.in (INPUT): Add avr/cpufunc.h.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Bob Paddock:
+	patch #6891: Add XMega software reset to the FAQ section on software
+	reset
+	* doc/api/faq.dox (faq_softreset): Mention the Xmega RST.CTRL method.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Ruwan Jayanetti:
+	patch #6194: Twitest updated to handle larger EEPROM devices
+	* doc/examples/twitest/twitest.c: Implement the
+	WORD_ADDRESS_16BIT option.
+	* doc/examples/twitest/twitest.dox: Document the new option.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Gerben van den Broeke:
+	patch #6555: malloc improvement
+	* libc/stdlib/malloc.c (malloc): Speed up reallocations.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Krzysztof Kosciuszkiewicz:
+	patch #6690: Shorten calculation of dallas 1-wire crc
+	* include/util/crc16.h (_crc_ibutton_update): no need to
+	use the T flag bit to save bit 0 of the operand
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Tero Sinervo:
+	patch #6791: Minor fixes to stdio.h documentation
+	* include/stdio.h: Fix spelling mistakes.
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Heike C. Zimmerer:
+	patch #6897: Allow <util/setbaud.h> to be used with assembler source
+	* include/util/setbaud.h: Add assembler snippets (no UL suffix
+	added to numbers)
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Add test scripts for <util/crc16.h>
+	* tests/simulate/util/crc16-1.c: New file.
+	* tests/simulate/util/crc16-2.c: (Ditto.)
+	* tests/simulate/util/crc16-3.c: (Ditto.)
+	* tests/simulate/util/crc16-4.c: (Ditto.)
+
+2010-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Don Kinzer:
+	bug #29950: ATtiny167 SPM_PAGESIZE Discrepancy
+	* include/avr/iotn167.h: Bump SPM_PAGESIZE.
+
+2010-06-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #27235, malloc: Several things go wrong
+	* libc/stdlib/malloc.c (malloc): Revert the patch
+	from r2123, as it is no longer needed.
+	* libc/stdlib/malloc.c (free): When freeing the
+	topmost chunk of the heap, reduce __brkval again,
+	returning the area from the heap entirely.
+	* doc/api/malloc.dox: Mention that the heap is now
+	reduced if possible.
+	* tests/simulate/regression/bug-27242.c: Adapt testscript
+	to match the new behaviour.
+	* tests/simulate/stdlib/malloc-1.c: (Ditto.)
+	* tests/simulate/stdlib/malloc-6.c: (Ditto.)
+	* tests/simulate/stdlib/malloc-7.c: (Ditto.)
+	* tests/simulate/stdlib/realloc-2.c: New file (test whether
+	subsequent allocation does not extend the heap).
+	* tests/simulate/regression/bug-28135.c: New file, another
+	regression test (actual bugfix from bug #28135 is no longer
+	needed)
+
+2010-06-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	More testscripts: test free() works as expected.
+	* tests/simulate/stdlib/malloc-5.c: New file.
+	* tests/simulate/stdlib/malloc-6.c: (Ditto.)
+	* tests/simulate/stdlib/malloc-7.c: (Ditto.)
+
+2010-06-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Stefan Ernst:
+	bug #27243: malloc: small error in comment
+	* stdlib/malloc.c: Fix comment.
+
+2010-06-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Aleksandar Kanchev:
+	bug #27242: realloc: serious error when size shrinks
+	* stdlib/realloc.c: Change freelist calculation.
+	* tests/simulate/regression/bug-27242.c: New file.
+
+2010-06-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* tests/simulate/stdlib/malloc-4.c: New file.
+
+2010-06-04  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Patch submitted by Stefan Ernst:
+	patch #6895: Improved malloc behaviour when expanding used area
+	bug #27235: malloc: Several things go wrong (part 1)
+	* stdlib/malloc.c: Improve allocation strategy.
+	* tests/simulate/regression/bug-27235-1.c: New file.
+
+2010-06-04  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Add some initial malloc and realloc tests to test
+	suite.
+	* tests/simulate/stdlib/malloc-1.c: New file.
+	* tests/simulate/stdlib/malloc-2.c: (Ditto.)
+	* tests/simulate/stdlib/malloc-3.c: (Ditto.)
+	* tests/simulate/stdlib/realloc-1.c: (Ditto.)
+
+2010-04-16  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+        Fix bug #28574.
+	* include/avr/iox128d3.h - Modify EVSYS_t and ADC_t structures to 
+	  include reserved registers.	
+	* include/avr/iox16d4.h  - Same.
+	* include/avr/iox192d3.h - Same.
+	* include/avr/iox256d3.h - Same.
+	* include/avr/iox32d4.h  - Same.
+	* include/avr/iox64d3.h  - Same.
+
+2010-04-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac (CHECK_BUILTIN_DELAY_CYCLES): Reimplement as a
+	compiler + grep pipeline rather than through AC_LINK_IFELSE, as we
+	cannot rely on a working linker while building the library.
+
+2010-04-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* devtools/gen-avr-lib-tree.sh: Fix directory name for ATxmega64A1U.
+
+2010-04-06  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+        Fix bug #28584.
+	* include/avr/iocanxx.h - Add word definitions CANIE and CANEN.
+
+2010-04-06  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+        Fix bug #28627.
+	* include/avr/power.h - ATmega32U2 defined for clock_prescale_set.
+
+2010-04-06  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+        Fix bug #28901.
+        * include/avr/iox128a1.h - Removed GPIO and CPU memory map entries.
+        * include/avr/iox128a1u.h - Same.
+        * include/avr/iox128a3.h - Same.
+        * include/avr/iox128d3.h - Same.
+        * include/avr/iox16a4.h - Same.
+        * include/avr/iox16d4.h - Same.
+        * include/avr/iox192a3.h - Same.
+        * include/avr/iox192d3.h - Same.
+        * include/avr/iox256a3.h - Same.
+        * include/avr/iox256a3b.h - Same.
+        * include/avr/iox256d3.h - Same.
+        * include/avr/iox32a4.h - Same.
+        * include/avr/iox32d4.h - Same.
+        * include/avr/iox64a1.h - Same.
+        * include/avr/iox64a3.h - Same.
+        * include/avr/iox64d3.h - Same.
+
+2010-04-05  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #27367.
+	* include/avr/iom8.h: Add RAMSTART definition.
+	* include/avr/iom16.h: Same.
+	* include/avr/iom32.h: Same.
+	* include/avr/iom164.h: Same.
+	* include/avr/iom324.h: Same.
+	* include/avr/iom644.h: Same.
+	* include/avr/iom644p.h: Same.
+	* include/avr/iom328p.h: Same.
+	* include/avr/iom48.h: Same.
+	* include/avr/iom48p.h: Same.
+	* include/avr/iom88.h: Same.
+	* include/avr/iom88p.h: Same.
+	* include/avr/iom168.h: Same.
+	* include/avr/iom168p.h: Same.
+	* include/avr/iom325.h: Same.
+	* include/avr/iom645.h: Same.
+	* include/avr/iom3250.h: Same.
+	* include/avr/iom6450.h: Same.
+	* include/avr/iotn2313.h: Same.
+	* include/avr/iom8515.h: Same.
+	* include/avr/iom8535.h: Same.
+	* include/avr/iotn13.h: Same.
+	* include/avr/iotn24.h: Same.
+	* include/avr/iotn25.h: Same.
+	* include/avr/iotn44.h: Same.
+	* include/avr/iotn45.h: Same.
+	* include/avr/iotn84.h: Same.
+	* include/avr/iotn85.h: Same.
+	* include/avr/iotn261.h: Same.
+	* include/avr/iotn461.h: Same.
+	* include/avr/iotn861.h: Same.
+	* include/avr/iotn88.h: Same.
+	* include/avr/iotn48.h: Same.
+	* include/avr/iom1281.h: Same.
+	* include/avr/iom1284p.h: Same.
+	* NEW: Add to fixed bug list.
+
+2010-03-30  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* crt1/gcrt1.S: Add more interrupt vectors to cover the ATxmega128A1U
+	device.
+
+2010-03-30  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* xml/avrgcc-header: Modify XMEGA portion of script to not generate CPU
+	and GPIO definitions that include references to non-existent structures.
+	This is a partial fix for bug #28901, for future header files.
+
+2010-03-28  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Add support for new device: m3000.
+	* configure.ac: Add support for new device.
+	* devtools/gen-avr-lib-tree.sh: Same.
+	* include/avr/io.h: Same.
+	* doc/api/main_page.dox: Same.
+	* doc/api/using-tools.dox: Same.
+	* include/avr/iom3000.h: New file.
+	* NEWS: Add news item.
+
+2010-03-28  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Add support for new devices: attiny84a, atmega325a, atmega3250a,
+	atmega329a, atmega3290a.
+	* configure.ac: Add support for new devices.
+	* devtools/gen-avr-lib-tree.sh: Same.
+	* include/avr/io.h: Same.
+	* doc/api/main_page.dox: Same.
+	* doc/api/using-tools.dox: Same.
+	* include/avr/power.h: Same.
+	* include/avr/wdt.h: Same.
+	* include/avr/sleep.h: Same.
+	* include/avr/eeprom.h: Same.
+	* NEWS: Add news item.
+
+2010-03-25  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Add support for new architecture: avrtiny10. Add support for new devices:
+	attiny4, attiny5, attiny9, attiny10, attiny20, attiny40.
+	* configure.ac: Add support for new devices.
+	* devtools/gen-avr-lib-tree.sh: Same.
+	* include/avr/Makefile.am: Same.
+	* include/avr/io.h: Same.
+	* doc/api/main_page.dox: Same.
+	* doc/api/using-tools.dox: Same.
+	* include/avr/power.h: Same.
+	* include/avr/sleep.h: Same.
+	* NEWS: Add news item.
+
+2010-03-25  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Add support for new devices: ATxmega128A1U, ATxmega64A1U.
+	* configure.ac: Add support for new devices.
+	* devtools/gen-avr-lib-tree.sh: Same.
+	* include/avr/Makefile.am: Same.
+	* include/avr/io.h: Same.
+	* doc/api/main_page.dox: Same.
+	* doc/api/using-tools.dox: Same.
+	* include/avr/power.h: Same.
+	* include/avr/wdt.h: Same.
+	* include/avr/sleep.h: Same.
+	* include/avr/eeprom.h: Same.
+	* NEWS: Add news item.
+
+2010-03-22  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iox64a1u.h: New file.
+
+2010-03-20  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/fuse.h: Add definition of FUSES for XMEGA devices.
+	* include/avr/iox128a1u.h: Regenerate file. New definitions, corrections.
+
+2010-03-19  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iotn20.h: New file.
+	* include/avr/iotn40.h: New file.
+
+2010-03-17  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Probe the compiler for the availability of the
+	__builtin_avr_delay_cycles() function, and modify the header files
+	<util/delay.h> and <avr/builtins.h> appropriately.  Note that the
+	modification is done by setting __HAS_DELAY_CYCLES on top of those
+	files, which has been left overridable from the compiler
+	environment (i.e., commandline -D option) on purpose.  Note also
+	that _delay_us() and _delay_ms() can only use
+	__builtin_avr_delay_cycles() if optimization is enabled as they'd
+	otherwise try to pass a floating-point argument to it which is not
+	allowed.  (The compiler does not seem to be able to convert it
+	into an unsigned long internally, not even with a type cast.)
+	However, not enabling optimization for them yields garbage timing
+	anyway, due to moving the compile-time constant floating-point
+	calculations from the compiler into the AVR.
+	* configure.ac: Add detection of __builtin_avr_delay_cycles
+	* include/util/delay.h.in: repocopied from delay.h
+	* include/util/Makefile.am: added delay.h.in
+	* include/avr/builtins.h.in: New file.
+	* include/avr/Makefile.am: added builtins.h.in
+
+2010-03-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix bug #28575.
+	* include/avr/iousb162.h (LFUSE_DEFAULT, HFUSE_DEFAULT, EFUSE_DEFAULT):
+	Fix definition.
+	* include/avr/iousb82.h: Same.
+	* include/avr/iousb647.h: Same.
+	* include/avr/iousb646.h: Same.
+	* NEWS: Add to fixed bug list.
+
+2010-03-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix bug #28812.
+	* include/avr/iotn48.h: Fix values of TWS3-7.
+	* NEWS: Add to fixed bug list.
+
+2010-02-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #28756: Bug in AVR libc 1.6.7 (power.h for 8-bit AVR)
+	* include/avr/power.h (clock_prescale_set): Implement as an inline
+	function rather than a macro so it syntactically becomes a true
+	function.
+
+2010-01-22  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iox128a1u.h: Add new file.
+
+2010-01-21  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #28688: using_tools.dox fails to build due to extra underscore
+	* doc/api/Makefile.am: added logic to detect which filename
+	doxygen did generate; while being here, fix the table layout as
+	well
+
+2010-01-20  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Rotate ChangeLogs.
+	* ChangeLog-2009: New file.
+	* ChangeLog: Clear for 2010.
+	* Makefile.am (EXTRA_DIST): Add ChangeLog-2009.
+
+For older changes see ChangeLog-2009
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2011 avr-libc-r2546/ChangeLog-2011
--- avr-libc-2.0.0-orig/ChangeLog-2011	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2011	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,448 @@
+2012-01-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/faq.dox (faq_assign_chain): fix spelling of \endcode, so
+	this actually compiles again :/  (bug #35226)
+	* dox/api/Makefile.am: Add forgotten optimize.dox.
+
+2011-09-26  Eric B. Weddington <eric.weddington@atmel.com>
+
+	(Patch re-applied after being backed out temporarily.)
+	Partial fix for bug #32945.
+	* common/macros.inc (LPM_R0_ZPLUS_* macros): Replace condition of
+	BIG_CODE with __AVR_HAVE_ELPM__.
+
+2011-12-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Bump version version for post-release.
+
+2011-12-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Released avr-libc-1.8.0.
+	* configure.ac: Bump version.
+
+2011-12-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/pgmspace.h: Do only include the deprecated prog_*
+	typedefs if the user requests this by defining
+	__PROG_TYPES_COMPAT__.  If they are generally defined, users are
+	being spammed with warning messages as soon as they include the
+	header file, regardless of whether they want to use these typedefs
+	or not.  Also, it's not good style to deprecate the old typedefs
+	but then use them ourselves, so make PGM_P and PGM_VOID_P use
+	the correct definitions.
+
+2011-12-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/iotnx5.h (TIMER1_OVF_vect_num): add definition,
+	replacing the misspelled duplicate for TIMER1_OVF_vect
+
+2011-12-29  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* libc/string/strlcat.S: add !__AVR_TINY__ protection
+
+2011-12-28  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #32773: stdiodemo source code is broken
+	* doc/examples/stdiodemo/lcd.c: pass an argument when calling
+	hd44780_wait_ready()
+	* doc/examples/stdiodemo/Makefile: don't attempt to build the
+	EEPROM load files, as there are now EEPROM data
+
+2011-12-25  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Fix for bug #34514: misspelled in math.h
+	Thanks to Naotaka Fujita.
+	* include/math.h: Fix typo in documentation.
+	* NEWS: Add to fixed bug list.
+
+2011-12-24  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Fix for bug #35093. Thanks to Eric Mertens for the patch.
+	* libc/pmstring/strlcat_P.S: Fix X pointer decriment.
+	* libc/string/strlcat.S: Fix X pointer decriment.
+	* tests/regression/bug-35093.c: New file.
+	* NEWS: Add to fixed bug list.
+
+2011-12-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #35020: stdint.h: signed types need explicit "signed"
+	* include/stdint.h: explicitly declare int*_t types as signed
+
+2011-11-02  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iox64a1.h (enum TC_EVACT_enum): Fix typo in enum list.
+	Compared to iox128a1.h. Thanks to Francois Costin for the fix.
+
+2011-10-19  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/faq.dox (faq_assign_chain): Add paragraph about avoiding
+	IO register assignment chains.
+
+2011-10-13  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/faq.dox (faq_eeprom_corruption): Remove the remarks about
+	the EEPROM being erased pagewise, as they are not true.
+
+2011-09-26  Eric B. Weddington <eric.weddington@atmel.com>
+
+	Partial fix for bug #33716.
+	* include/avr/pgmspace.h: Deprecate typedefs with __progmem__ attribute.
+	Document as such.
+
+2011-09-26  Eric B. Weddington <eric.weddington@atmel.com>
+
+	Fix for bug #33858.
+	* include/avr/power.h: Add condition for _AVR_ATmega328_.
+	* NEWS: Add to fixed bug list.
+
+2011-09-26  Eric B. Weddington <eric.weddington@atmel.com>
+
+	Fix for bug #33920.
+	* include/avr/iotn167.h (ICR): Define ICR to be a word register.
+	* NEWS: Add to fixed bug list.
+
+2011-09-22  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac (avr_libc_revision, avr_libc_reldate): Bump in
+	preparation of an 1.7.2rc.
+	* configure.ac (avr_libc_revision_suffix): New macro.
+
+2011-09-14  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #34047: missing math.h include in delay.h
+	* util/delay.h.in: include <math.h>
+
+2011-09-14  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* util/delay.h.in: Fall back to the historic algorithm when
+	compiling within a freestanding environment.
+
+2011-05-23  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Reported by Heike C. Zimmerer:
+	patch #7362: iom16a.h: USART vectors inconsistently named
+	for ATmega16A
+	* include/avr/iom16a.h: Add backwards-compatible USART
+	interrupt vector names.
+
+2011-05-23  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Reported by Palauqui Georges:
+	patch #7531: Bad name of bit in TCCR0A : WGM0 instead of CTC0
+	for ATtinyX61
+	* include/avr/iotnx61.h: Add new name CTC0 for bit 0 of
+	TCCR0A.
+
+2011-05-14  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Reported by Markus Lampert:
+	* include/avr/iousbxx2.h: Add new names for CLKSTA, CLKSEL0,
+	CLKSEL1 (old names have been without the `L').
+
+2011-05-12  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Patch #7226. Thanks to Avik Juneja for the patch.
+	* include/avr/iom8u2.h: Add UPOE register definition and bits.
+	* include/avr/power.h: Add ATmega8u2-16u2-32u2 devices in conditional.
+	* NEWS: Add to contributed patches list.
+
+2011-05-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #33130. Thanks to Antoine Mercier-Linteau for the patch.
+	* doc/examples/twitest/twitest.c: Check for reception of NAK.
+
+2011-05-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #32650.
+	* include/util/delay.h.in: Add math.h to list of includes.
+	* NEWS: Add to fixed bug list.
+
+2011-05-11  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #32675.
+	* include/avr/power.h: Add TIM1 to power_all_enable() and
+	power_all_disable().
+	* NEWS: Add to fixed bug list.
+
+2011-05-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/pgmspace.h: Reorder so __strlen_P is declared by
+	the time it is attempted to be used.
+	* libc/stdlib/dtostre.c: Part #2 of fix for bug #32988: make
+	`s' a `const char *' as it is pointing to a constant (flash)
+	string.
+
+2011-05-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #32988.
+	* include/avr/pgmspace.h: Add const keyword to PSTR definition.
+	* NEWS: Add to fixed bug list.
+
+2011-05-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #33230.
+	* include/avr/sleep.h: Move conditionals for devices attiny261,
+	attiny261a, attiny461, attiny461a, attiny861, attiny861a to
+	correct location.
+	* NEWS: Add to fixed bug list.
+
+2011-05-09  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #33238.
+	* include/avr/iom8u2.h: Fix _VECTORS_SIZE value.
+	* include/avr/iom16u2.h: Same.
+	* include/avr/iom32u2.h: Same.
+	* NEWS: Add to fixed bug list.
+
+2011-03-17  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iotn11.h: Poison deprecated items.
+	* include/avr/iotn12.h: Same.
+	* include/avr/iotn13.h: Same.
+	* include/avr/iotn15.h: Same.
+	* include/avr/iotn22.h: Same.
+	* include/avr/iotn2313.h: Same. Also: remove duplicate definitions.
+	* include/avr/iotn26.h: Same.
+	* include/avr/iotn28.h: Same.
+
+2011-03-16  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom3290.h: Poison deprecated items.
+	* include/avr/iom32m1.h: Same.
+	* include/avr/iom64.h: Same.
+	* include/avr/iom645.h: Same.
+	* include/avr/iom6450.h: Same.
+	* include/avr/iom649.h: Same.
+	* include/avr/iom8.h: Same.
+	* include/avr/iom8515.h: Same.
+	* include/avr/iom8535.h: Same.
+	* include/avr/iomx8.h: Same.
+	* include/avr/iomxx4.h: Same.
+	* include/avr/iomxx0_1: Same. Also add missing vector number
+	definitions.
+
+2011-03-15  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom323.h: Poison deprecated items.
+	* include/avr/iom325.h: Same.
+	* include/avr/iom3250.h: Same.
+	* include/avr/iom329.h: Same.
+
+2011-03-08  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom32.h: Poison deprecated items.
+
+2011-03-08  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+	Fix for bug #32698.
+	* include/avr/power.h: Fix #endif error for Xmega A series.
+
+2011-03-06  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom163.h: Poison deprecated items.
+	* include/avr/iom165.h: Same.
+	* include/avr/iom165p.h: Same.
+	* include/avr/iom169.h: Same.
+	* include/avr/iom169p.h: Same.
+
+2011-03-05  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom162.h: Poison deprecated items.
+
+2011-03-05  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom161.h: Poison deprecated items.
+
+2011-03-05  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom16.h: Poison deprecated items.
+
+2011-03-04  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom103.h: Poison deprecated items.
+
+2011-03-04  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* include/avr/iom128.h: Poison deprecated items.
+
+2011-03-02  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #23234.
+	* include/avr/iousbxx2.h: Add *_vect_num definitions.
+	* include/avr/iousbxx6_7.h: Same.
+	* include/avr/iotnx61.h: Same.
+	* include/avr/iotn43u.h: Same.
+	* include/avr/iotn48.h: Same.
+	* include/avr/iotn88.h: Same.
+	* include/avr/iotnx4.h: Same.
+	* include/avr/iotnx5.h: Same.
+	* include/avr/iotn28.h: Same.
+	* include/avr/iotn26.h: Same.
+	* include/avr/iotn11.h: Same.
+	* include/avr/iotn12.h: Same.
+	* include/avr/iotn13.h: Same.
+	* include/avr/iotn15.h: Same.
+	* include/avr/iotn167.h: Same.
+	* include/avr/iotn22.h: Same.
+	* include/avr/iotn2313.h: Same.
+	* include/avr/iom103.h: Same.
+	* include/avr/iom128.h: Same.
+	* include/avr/iom1284.h: Same.
+	* include/avr/iom16.h: Same.
+	* include/avr/iom161.h: Same.
+	* include/avr/iom162.h: Same.
+	* include/avr/iom163.h: Same.
+	* include/avr/iomxxhva.h: Same.
+	* include/avr/iomxx4.h: Same.
+	* include/avr/iomxx0_1.h: Same.
+	* include/avr/iomx8.h: Same.
+	* include/avr/iom88p.h: Same.
+	* include/avr/iom8535.h: Same.
+	* include/avr/iom8515.h: Same.
+	* include/avr/iom165.h: Same.
+	* include/avr/iom8.h: Same.
+	* include/avr/iom6490.h: Same.
+	* include/avr/iom165p.h: Same.
+	* include/avr/iom649.h: Same.
+	* include/avr/iom168p.h: Same.
+	* include/avr/iom169.h: Same.
+	* include/avr/iom169p.h: Same.
+	* include/avr/iom32.h: Same.
+	* include/avr/iom323.h: Same.
+	* include/avr/iom325.h: Same.
+	* include/avr/iom3250.h: Same.
+	* include/avr/iom328p.h: Same.
+	* include/avr/iom329.h: Same.
+	* include/avr/iom3290.h: Same.
+	* include/avr/iom32hvbrevb.h: Same.
+	* include/avr/iom32u4.h: Same.
+	* include/avr/iom406.h: Same.
+	* include/avr/iom48p.h: Same.
+	* include/avr/iom64.h: Same.
+	* include/avr/iom645.h: Same.
+	* include/avr/iom6450.h: Same.
+	* include/avr/iocanxx.h: Same.
+	* include/avr/io90pwm1.h: Same.
+	* include/avr/io90pwm216.h: Same.
+	* include/avr/io1200.h: Same.
+	* include/avr/io2343.h: Same.
+	* include/avr/io2323.h: Same.
+	* include/avr/io86r401.h: Same.
+	* include/avr/io2313.h: Same.
+	* include/avr/io2333.h: Same.
+	* include/avr/io4434.h: Same.
+	* include/avr/io4433.h: Same.
+	* include/avr/io4414.h: Same.
+	* include/avr/io8535.h: Same.
+	* include/avr/io8515.h: Same.
+	* include/avr/io90pwmx.h: Same.
+	* include/avr/io90pwm3b.h: Same.
+	* include/avr/io90pwm316.h: Same.
+	* include/avr/io90pwm2b.h: Same.
+	* include/avr/iom16hvbrevb: Also, update copyright year, change device name
+	(rev b version is the older version).
+	* include/avr/iom32hvbrevb: Same.
+	* NEWS: Add item.
+
+2011-02-23  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Partial fix for bug #28058, comment #2.
+	Thanks to Jan Waclawek for the code.
+	* include/avr/pgmspace.h: Add new strlen_P inline function.
+	* libc/pmstring/strlen_P.S: Rename function to __strlen_P.
+	* NEWS: Add item.
+
+2011-02-23  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #17815.
+	* doc/api/Makefile.am (install-dox-man): Rewrite to fix install
+	location to use mandir configuration option.
+	* NEWS: Add item to fixed bugs list.
+
+2011-02-22  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	* doc/api/tools-install.dox: Partial documentation changes
+	for building avr-libc for MinGW/Windows.
+
+2011-02-22  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #24861.
+	* include/avr/interrupt.h: Remove extra code blocks in documentation.
+	Fix spacing.
+	* NEWS: Add item to fixed bugs list.
+
+2011-02-21  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #32103. Thanks to Thomas Rudin for fix.
+	* configure.ac: Fix wildcards in searching for cross tools.
+	* NEWS: Add item to fixed bugs list.
+
+2011-02-21  Eric B. Weddington  <eric.weddington@atmel.com>
+
+	Fix for bug #32419.
+	* include/avr/iox192a3.h (*EEPROM_SIZE): Fix values.
+	* NEWS: Add item to fixed bugs list.
+
+2011-02-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Bump for post-release.
+
+2011-02-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Released avr-libc-1.7.1.
+
+2011-02-16  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+	* include/avr/power.h: Changes to power_all_enable()/disable() for 
+	Xmega A and D family
+
+2011-02-14  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+	Thanks to Praveen Kaushik <Praveen_Kumar.Kaushi@atmel.com> for the device
+	support.
+	* configure.ac: Support for ATMega16HVB RevB, ATMega32HVB RevB.
+	* devtools/gen-avr-lib-tree.sh: Same.
+	* doc/api/main_page.dox: Same.
+	* doc/api/using-tools.dox: Same.
+	* include/avr/eeprom.h: Same.
+	* include/avr/io.h: Same.
+	* include/avr/iom16hvb.h: Header file regenerated.
+	* include/avr/iom16hvbrevb.h: Added newly.
+	* include/avr/iom32hvb.h: Header file regenerated.
+	* include/avr/iom32hvbrevb.h: Added newly.
+	* include/avr/Makefile.am: Support for atmega16HVB RevB, 
+	ATMega32HVB RevB.
+	* include/avr/power.h: Same.
+	* include/avr/sleep.h: Same.
+	* include/avr/wdt.h: Same.
+
+2011-02-14  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+	Thanks to Usha Gupta <usha.gupta@atmel.com> for the device
+	support.
+	* include/avr/io.h: Support for AVR Tiny84a
+	* include/avr/iotn84a.h: Same.
+	* include/avr/Makefile.am: Same.
+
+2011-02-14  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+	Fix for #bug31873
+	* include/avr/power.h: Modifications to power_aes_enable/disable() 
+    power_all_enable/disable() functions for Xmega devices. 
+
+2011-02-11  Anitha Boyapati <anitha.boyapati@atmel.com>
+
+	Thanks to Praveen Kaushik <Praveen_Kumar.Kaushi@atmel.com> for
+	the fix for #bug31990.
+	* include/avr/io90pwm81.h: PRPSC0 is renamed to PRPSCR in sync 
+	with device XML file.
+	* include/avr/power.h:	power_psc0_enable()/disable() have been 
+	renamed to power_pscr_enable()/disable(). Documentation changes
+	to include PWM81 are also done.
+
+
+
+2011-02-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/iom8x.h (_VECTORS_SIZE): fix wrong vector table size
+	for ATmega168A devices.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2012 avr-libc-r2546/ChangeLog-2012
--- avr-libc-2.0.0-orig/ChangeLog-2012	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2012	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,182 @@
+2012-12-06  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/iom128.h (ADCW): unpoison this
+
+2012-11-26  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Standard scanf() conversion macros for 8-bit data types:
+	* include/inttypes.h (SCNd8, SCNdLEAST8, SCNdFAST8, SCNi8,
+	SCNiLEAST8, SCNiFAST8, SCNo8, SCNoLEAST8, SCNoFAST8, SCNu8,
+	SCNuLEAST8, SCNuFAST8, SCNx8, SCNxLEAST8, SCNxFAST8): New
+	macros.
+
+2012-11-16  Eric B. Weddington <eric.weddington@atmel.com>
+
+	Fix for bug #35539. Thanks to Georg-Johann Lay for fix.
+	* include/stdlib.h (EXIT_SUCCESS, EXIT_FAILURE): Add.
+
+2012-09-18  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/xmega.h: New file, implement _PROTECTED_WRITE.
+	* include/avr/io.h: Include <avr/xmega.h>
+	* doc/api/doxygen.config.in: Add <avr/xmega.h> to documentation build.
+
+2012-07-30  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	patch #3729: Printf for integers speed up
+	Thanks to Georg-Johann Lay.
+	* doc/api/bench-libc.dox: Regenerate with GCC 4.7.1 (and new integer
+	to ASCII functions).
+	* include/stdlib.h: Define *toa() as inline functions.
+	* libc/misc/Files.am: Add new files.
+	* libc/misc/itoa.S: Rewrite.
+	* libc/misc/itoa_ncheck.S: New file.
+	* libc/misc/ltoa.S: Rewrite.
+	* libc/misc/ltoa_ncheck.S: New file.
+	* libc/misc/ultoa.S: Rewrite.
+	* libc/misc/ultoa_ncheck.S: New file.
+	* libc/misc/utoa.S: Rewrite.
+	* libc/misc/utoa_ncheck.S: New file.
+	* tests/simulate/stdlib/itoa-1.c: New file.
+	* tests/simulate/stdlib/itoa-2.c: New file.
+	* tests/simulate/stdlib/ltoa-1.c: New file.
+	* tests/simulate/stdlib/ltoa-2.c: New file.
+	* tests/simulate/stdlib/ultoa-1.c: New file.
+	* tests/simulate/stdlib/ultoa-2.c: New file.
+	* tests/simulate/stdlib/ultoa-3.c: New file.
+	* tests/simulate/stdlib/utoa-1.c: New file.
+	* tests/simulate/stdlib/utoa-2.c: New file.
+	* tests/simulate/stdlib/utoa-3.c: New file.
+
+2012-06-19  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/signature.h (__signature): mark as "used"
+	so the linker won't throw it away
+	* include/avr/fuse.h (FUSEMEM): (Dito.)
+	* include/avr/lock.h (LOCKMEM): (Dito.)
+
+2012-06-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Reported by Itai Nahshon:
+	XXX_vect_num not consistent io90pwmx.h, iousbxx6_7.h
+	* include/avr/iousbxx6_7.h (TWI_vect_num): make this a number
+	* include/avr/io90pwmx.h (TIMER1_COMPA_vect_num): (Dito.)
+
+2012-06-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #36581: avr-libc: pgmspace.h is not ANSI compliant
+	* include/avr/pgmspace.h (strlen_P): use __inline__ rather
+	than inline to be independent from the compiler's standard
+	level option
+
+2012-05-16  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #31267: misleading header iom128rfa1.h
+	* include/iom128rfa1.h: remove vectors 51 through 56
+
+2012-05-14  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #36454: string.h: Error for long long in C90
+	* include/string.h (ffsll): declare as being a GCC extension
+
+2012-03-11  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Add multilib version for tiny-stack targets.
+	* devtools/gen-avr-lib-tree.sh: Add multilib DEV_INFO lists.  Add
+	multilib member for ARH_INFO.  Operate possible sublibs targets.
+	* configure.ac: Add tiny-stack targets.
+
+2012-02-04  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Fix for bug #35398: assert doesn't work unless stdlib.h is also
+	included.  Thanks to Britton Kerin.
+	* include/assert.h: Include <stdlib.h>.
+	* NEWS: Add to fixed bug list.
+
+2012-01-28  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* tests/simulate/regression/bug-35366-1-printf_flt.c: New file.
+	* tests/simulate/regression/bug-35366-2-printf_flt.c: New file.
+
+2012-01-15  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Fix for bug #35197: sleep.h _BV defined as __BV in AT90S8515 section
+	Also fix a similar typo in 2 another files.
+	Thanks to Bingo.
+	* include/avr/iotn43u.h: Fix typo with __ASSEMBLER__.
+	* include/avr/iom32u4.h: Fix typo with __ASSEMBLER__.
+	* include/avr/sleep.h: Fix typo with _BV.
+	* NEWS: Add to fixed bug list.
+
+2012-01-08  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* tests/simulate/other/progtype-1.c: New file.
+	* tests/simulate/other/progtype-2.c: New file.
+	* tests/simulate/other/progtype-3.c: New file.
+
+2012-01-06  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* include/avr/common.h: Fix typo of last commit.
+
+2012-01-05  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* tests/simulate/regression/bug-21872-1.c: Exclude GCC 4.6 warning.
+	* tests/simulate/regression/bug-21872-2.c: Same.
+	* tests/simulate/regression/bug-21955.c: Same.
+
+2012-01-05  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* tests/simulate/scanf/sscanf-1.c: Add 'const' for PROGMEM variables.
+	* tests/simulate/scanf/sscanf-2.c: Same.
+	* tests/simulate/scanf/sscanf_brk-1.c: Same.
+	* tests/simulate/scanf/sscanf_brk-2.c: Same.
+	* tests/simulate/scanf/sscanf_brk-3.c: Same.
+	* tests/simulate/scanf/sscanf_brk-4.c: Same.
+	* tests/simulate/scanf/sscanf-c1.c: Same.
+	* tests/simulate/scanf/sscanf-c2.c: Same.
+	* tests/simulate/scanf/sscanf-d1.c: Same.
+	* tests/simulate/scanf/sscanf-d2.c: Same.
+	* tests/simulate/scanf/sscanf-eof.c: Same.
+	* tests/simulate/scanf/sscanf_flt-f1.c: Same.
+	* tests/simulate/scanf/sscanf_flt-f2.c: Same.
+	* tests/simulate/scanf/sscanf_flt-f3.c: Same.
+	* tests/simulate/scanf/sscanf_flt-fnn.c: Same.
+	* tests/simulate/scanf/sscanf_flt-fw.c: Same.
+	* tests/simulate/scanf/sscanf-h.c: Same.
+	* tests/simulate/scanf/sscanf-hh.c: Same.
+	* tests/simulate/scanf/sscanf-i.c: Same.
+	* tests/simulate/scanf/sscanf-l.c: Same.
+	* tests/simulate/scanf/sscanf-o1.c: Same.
+	* tests/simulate/scanf/sscanf-o2.c: Same.
+	* tests/simulate/scanf/sscanf-s1.c: Same.
+	* tests/simulate/scanf/sscanf-s2.c: Same.
+	* tests/simulate/scanf/sscanf-x1.c: Same.
+	* tests/simulate/scanf/sscanf-x2.c: Same.
+	* tests/simulate/scanf/sscanf-x3.c: Same.
+
+	* tests/simulate/stdlib/strtol-3.c: Same.
+	* tests/simulate/stdlib/strtoul-2.c: Same.
+	* tests/simulate/stdlib/strtoul-3.c: Same.
+
+2012-01-05  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* tests/simulate/stdlib/realloc-3.c: Remove depricated PROGMEM types.
+	* tests/simulate/pmstring/memccpy_P.c: Same.
+	* tests/simulate/string/memccpy.c: Same.
+
+2012-01-05  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Exclude worses with old GCC versions.
+	* configure.ac: Insert space after '-o' option (needed for GCC 3.3).
+	* tests/simulate/runtest.sh: Remove '-std=gnu99' option for
+	assembler sources.
+
+2012-01-05  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	* include/avr/common.h: Define RAMPZ.
+
+2012-01-03  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/faq.dox (faq_assign_chain): fix spelling of \endcode, so
+	this actually compiles again :/  (bug #35226)
+	* dox/api/Makefile.am: Add forgotten optimize.dox.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2013 avr-libc-r2546/ChangeLog-2013
--- avr-libc-2.0.0-orig/ChangeLog-2013	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2013	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,619 @@
+2013-09-09  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/xmega.h (_PROTECTED_WRITE): add forgotten
+	leading underscore.
+
+2013-06-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #36410: avr/boot.h: poisoned SPMCR for ATmega128
+	* include/avr/boot.h: Don't evaluate SPMCR if SPMCSR was
+	already around.
+
+2013-05-13  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* tests/simulate/other/progtype-3.c (s): Initialize progmem
+	variable to get rid of a warning.
+
+2013-05-13  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* tests/simulate/regression/bug-28135.c: GCC 4.5+ implies malloc()
+	and free() have no side-effects to global variables.  Place a
+	memory barrier before any evaluations of __flp or __brkval to
+	ensure the compiler actually reads them from the respective memory
+	locations.
+	* tests/simulate/stdlib/malloc-7.c: (Dito.)  Also replace private
+	library definitions by "stdlib_private.h"
+	* tests/simulate/stdlib/realloc-2.c: (Dito.)
+
+2013-05-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Frdric Nadeau:
+	patch #7485 CRC8-CCITT
+	* include/util/crc16.h (_crc8_ccitt_update): New function.
+	* tests/simulate/util/crc16-5.c: New file.
+
+2013-05-08  Pitchumani Sivanupandi  <Pitchumani.S@atmel.com>
+
+	* include/avr/power.h: Specialize clock_prescale_set/get
+	for mega hvb devices
+
+2013-05-03 Mike Rice <mike@mikerice.name>
+
+    * Deleted function iso_weeknum(), replaced with iso_week_date()
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Georg-Johann Lay:
+	bug #38135: Install a dummy stdfix-avrlibc.h
+	* include/stdfix-avrlibc.h: New file.
+	* include/Makefile.am (avr_HEADERS): Add stdfix-avrlibc.h.
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Dean Camera:
+	patch #7212: Add pgm_read_ptr() macros to pgmspace.h
+	* include/avr/pgmspace.h (pgm_read_ptr_near, pgm_read_ptr_far,
+	pgm_read_ptr): New macros.
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Radoslaw Koppel:
+	patch #7220: Add UBRR overload functionality to <util/setbaud.h>
+	* include/util/setbaud.h: check for overflow of UBRR_VALUE
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Frdric Nadeau:
+	patch #7260: Addition to power.h
+	* include/avr/power.h: Extend clock prescaler support to devices
+	with XDIV (ATmega103, ATmega64, ATmega128)
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Maksim Kuleshov:
+	patch #7654 include/delay.h: delay_us >255us without decreasing
+	resolution
+	* include/util/delay.h.in (_delay_us): Add a second decision
+	logic that decides whether _delay_loop_2() could still be
+	used, or the fallback to _delay_ms() is required; while here,
+	reorder local variables so it compiles warning-free in all
+	configurations
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by W. Trevor King:
+	patch #7826 Add ATMega32u4 support to the led-blinking demo
+	* doc/examples/demo/iocompat.h: Add ATmega32U4
+	* doc/examples/demo/Makefile: (Dito.)
+
+2013-05-03 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Stefan Kristiansson:
+	patch #7910 Add missing PCINT2_vect to iotn40.h and update
+	all the following vector numbers
+	* include/avr/iotn40.h: Add PCINT2_vect, and shift all
+	subsequent (misplaced) vectors; rename ADC_ADC_vect into
+	ADC_vect to match the datasheet.
+
+2013-05-02 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/tools-install.dox: Drop references to FreeBSD's
+	CVSweb, as it's no longer maintained.  Add a comment that the
+	historically available per-language GCC source files are no
+	longer available, starting with GCC 4.7.
+
+2013-05-02 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Alex Crawford:
+	patch #7909 Adding __volatile__ to __asm__ within pgmspace header
+	* include/avr/pgmspace.h: Make all __asm__ statements
+	volatile.
+
+2013-04-30 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Add IO symbol definitions to crt*.o files:
+	* configure.ac: add crt1/iosym/Makefile to the build
+	* devtools/ioreg.pl: Emit a DIE for uint32_t if needed.
+	* devtools/generate_iosym.sh: New file.
+	* devtools/Device.am (AVRLIB_ASFLAGS): Pass name of iosym/*.S
+	include file as a -D option when compiling gcrt1.o.
+	* crt1/gcrt1.S: Include IOSYMFILE
+	* crt1/Makefile.am (SUBDIRS, DIST_SUBDIRS): add "iosym"
+	* crt1/iosym: New directory.
+	* crt1/iosym/Makefile.am: New file.
+	* crt1/iosym/template.S: Empty template to use for devices where
+	there is no actual IO symbol definition file.
+	* crt1/iosym/at43usb320.S: New file.
+	* crt1/iosym/at43usb355.S: (Dito.)
+	* crt1/iosym/at76c711.S: (Dito.)
+	* crt1/iosym/at86rf401.S: (Dito.)
+	* crt1/iosym/at90c8534.S: (Dito.)
+	* crt1/iosym/at90can128.S: (Dito.)
+	* crt1/iosym/at90can32.S: (Dito.)
+	* crt1/iosym/at90can64.S: (Dito.)
+	* crt1/iosym/at90pwm1.S: (Dito.)
+	* crt1/iosym/at90pwm2.S: (Dito.)
+	* crt1/iosym/at90pwm216.S: (Dito.)
+	* crt1/iosym/at90pwm2b.S: (Dito.)
+	* crt1/iosym/at90pwm3.S: (Dito.)
+	* crt1/iosym/at90pwm316.S: (Dito.)
+	* crt1/iosym/at90pwm3b.S: (Dito.)
+	* crt1/iosym/at90pwm81.S: (Dito.)
+	* crt1/iosym/at90s1200.S: (Dito.)
+	* crt1/iosym/at90s2313.S: (Dito.)
+	* crt1/iosym/at90s2323.S: (Dito.)
+	* crt1/iosym/at90s2333.S: (Dito.)
+	* crt1/iosym/at90s2343.S: (Dito.)
+	* crt1/iosym/at90s4414.S: (Dito.)
+	* crt1/iosym/at90s4433.S: (Dito.)
+	* crt1/iosym/at90s4434.S: (Dito.)
+	* crt1/iosym/at90s8515.S: (Dito.)
+	* crt1/iosym/at90s8535.S: (Dito.)
+	* crt1/iosym/at90scr100.S: (Dito.)
+	* crt1/iosym/at90usb1286.S: (Dito.)
+	* crt1/iosym/at90usb1287.S: (Dito.)
+	* crt1/iosym/at90usb162.S: (Dito.)
+	* crt1/iosym/at90usb646.S: (Dito.)
+	* crt1/iosym/at90usb647.S: (Dito.)
+	* crt1/iosym/at90usb82.S: (Dito.)
+	* crt1/iosym/at94k.S: (Dito.)
+	* crt1/iosym/ata6289.S: (Dito.)
+	* crt1/iosym/atmega103.S: (Dito.)
+	* crt1/iosym/atmega128.S: (Dito.)
+	* crt1/iosym/atmega1280.S: (Dito.)
+	* crt1/iosym/atmega1281.S: (Dito.)
+	* crt1/iosym/atmega1284p.S: (Dito.)
+	* crt1/iosym/atmega1284rfr2.S: (Dito.)
+	* crt1/iosym/atmega128rfa1.S: (Dito.)
+	* crt1/iosym/atmega128rfr2.S: (Dito.)
+	* crt1/iosym/atmega16.S: (Dito.)
+	* crt1/iosym/atmega161.S: (Dito.)
+	* crt1/iosym/atmega162.S: (Dito.)
+	* crt1/iosym/atmega163.S: (Dito.)
+	* crt1/iosym/atmega164a.S: (Dito.)
+	* crt1/iosym/atmega164p.S: (Dito.)
+	* crt1/iosym/atmega165.S: (Dito.)
+	* crt1/iosym/atmega165a.S: (Dito.)
+	* crt1/iosym/atmega165p.S: (Dito.)
+	* crt1/iosym/atmega168.S: (Dito.)
+	* crt1/iosym/atmega168a.S: (Dito.)
+	* crt1/iosym/atmega168p.S: (Dito.)
+	* crt1/iosym/atmega169.S: (Dito.)
+	* crt1/iosym/atmega169a.S: (Dito.)
+	* crt1/iosym/atmega169p.S: (Dito.)
+	* crt1/iosym/atmega169pa.S: (Dito.)
+	* crt1/iosym/atmega16a.S: (Dito.)
+	* crt1/iosym/atmega16hva.S: (Dito.)
+	* crt1/iosym/atmega16hva2.S: (Dito.)
+	* crt1/iosym/atmega16hvb.S: (Dito.)
+	* crt1/iosym/atmega16hvbrevb.S: (Dito.)
+	* crt1/iosym/atmega16m1.S: (Dito.)
+	* crt1/iosym/atmega16u2.S: (Dito.)
+	* crt1/iosym/atmega16u4.S: (Dito.)
+	* crt1/iosym/atmega2560.S: (Dito.)
+	* crt1/iosym/atmega2561.S: (Dito.)
+	* crt1/iosym/atmega2564rfr2.S: (Dito.)
+	* crt1/iosym/atmega256rfr2.S: (Dito.)
+	* crt1/iosym/atmega32.S: (Dito.)
+	* crt1/iosym/atmega323.S: (Dito.)
+	* crt1/iosym/atmega324a.S: (Dito.)
+	* crt1/iosym/atmega324p.S: (Dito.)
+	* crt1/iosym/atmega324pa.S: (Dito.)
+	* crt1/iosym/atmega325.S: (Dito.)
+	* crt1/iosym/atmega3250.S: (Dito.)
+	* crt1/iosym/atmega3250a.S: (Dito.)
+	* crt1/iosym/atmega3250p.S: (Dito.)
+	* crt1/iosym/atmega325a.S: (Dito.)
+	* crt1/iosym/atmega325p.S: (Dito.)
+	* crt1/iosym/atmega328.S: (Dito.)
+	* crt1/iosym/atmega328p.S: (Dito.)
+	* crt1/iosym/atmega329.S: (Dito.)
+	* crt1/iosym/atmega3290.S: (Dito.)
+	* crt1/iosym/atmega3290a.S: (Dito.)
+	* crt1/iosym/atmega3290p.S: (Dito.)
+	* crt1/iosym/atmega329a.S: (Dito.)
+	* crt1/iosym/atmega329p.S: (Dito.)
+	* crt1/iosym/atmega329pa.S: (Dito.)
+	* crt1/iosym/atmega32c1.S: (Dito.)
+	* crt1/iosym/atmega32hvb.S: (Dito.)
+	* crt1/iosym/atmega32hvbrevb.S: (Dito.)
+	* crt1/iosym/atmega32m1.S: (Dito.)
+	* crt1/iosym/atmega32u2.S: (Dito.)
+	* crt1/iosym/atmega32u4.S: (Dito.)
+	* crt1/iosym/atmega32u6.S: (Dito.)
+	* crt1/iosym/atmega406.S: (Dito.)
+	* crt1/iosym/atmega48.S: (Dito.)
+	* crt1/iosym/atmega48a.S: (Dito.)
+	* crt1/iosym/atmega48p.S: (Dito.)
+	* crt1/iosym/atmega64.S: (Dito.)
+	* crt1/iosym/atmega640.S: (Dito.)
+	* crt1/iosym/atmega644.S: (Dito.)
+	* crt1/iosym/atmega644a.S: (Dito.)
+	* crt1/iosym/atmega644p.S: (Dito.)
+	* crt1/iosym/atmega644pa.S: (Dito.)
+	* crt1/iosym/atmega644rfr2.S: (Dito.)
+	* crt1/iosym/atmega645.S: (Dito.)
+	* crt1/iosym/atmega6450.S: (Dito.)
+	* crt1/iosym/atmega6450a.S: (Dito.)
+	* crt1/iosym/atmega6450p.S: (Dito.)
+	* crt1/iosym/atmega645a.S: (Dito.)
+	* crt1/iosym/atmega645p.S: (Dito.)
+	* crt1/iosym/atmega649.S: (Dito.)
+	* crt1/iosym/atmega6490.S: (Dito.)
+	* crt1/iosym/atmega6490a.S: (Dito.)
+	* crt1/iosym/atmega6490p.S: (Dito.)
+	* crt1/iosym/atmega649a.S: (Dito.)
+	* crt1/iosym/atmega649p.S: (Dito.)
+	* crt1/iosym/atmega64c1.S: (Dito.)
+	* crt1/iosym/atmega64hve.S: (Dito.)
+	* crt1/iosym/atmega64m1.S: (Dito.)
+	* crt1/iosym/atmega64rfr2.S: (Dito.)
+	* crt1/iosym/atmega8.S: (Dito.)
+	* crt1/iosym/atmega8515.S: (Dito.)
+	* crt1/iosym/atmega8535.S: (Dito.)
+	* crt1/iosym/atmega88.S: (Dito.)
+	* crt1/iosym/atmega88a.S: (Dito.)
+	* crt1/iosym/atmega88p.S: (Dito.)
+	* crt1/iosym/atmega88pa.S: (Dito.)
+	* crt1/iosym/atmega8hva.S: (Dito.)
+	* crt1/iosym/atmega8u2.S: (Dito.)
+	* crt1/iosym/attiny10.S: (Dito.)
+	* crt1/iosym/attiny11.S: (Dito.)
+	* crt1/iosym/attiny12.S: (Dito.)
+	* crt1/iosym/attiny13.S: (Dito.)
+	* crt1/iosym/attiny13a.S: (Dito.)
+	* crt1/iosym/attiny15.S: (Dito.)
+	* crt1/iosym/attiny167.S: (Dito.)
+	* crt1/iosym/attiny20.S: (Dito.)
+	* crt1/iosym/attiny22.S: (Dito.)
+	* crt1/iosym/attiny2313.S: (Dito.)
+	* crt1/iosym/attiny2313a.S: (Dito.)
+	* crt1/iosym/attiny24.S: (Dito.)
+	* crt1/iosym/attiny24a.S: (Dito.)
+	* crt1/iosym/attiny25.S: (Dito.)
+	* crt1/iosym/attiny26.S: (Dito.)
+	* crt1/iosym/attiny261.S: (Dito.)
+	* crt1/iosym/attiny261a.S: (Dito.)
+	* crt1/iosym/attiny28.S: (Dito.)
+	* crt1/iosym/attiny4.S: (Dito.)
+	* crt1/iosym/attiny40.S: (Dito.)
+	* crt1/iosym/attiny4313.S: (Dito.)
+	* crt1/iosym/attiny43u.S: (Dito.)
+	* crt1/iosym/attiny44.S: (Dito.)
+	* crt1/iosym/attiny44a.S: (Dito.)
+	* crt1/iosym/attiny45.S: (Dito.)
+	* crt1/iosym/attiny461.S: (Dito.)
+	* crt1/iosym/attiny461a.S: (Dito.)
+	* crt1/iosym/attiny48.S: (Dito.)
+	* crt1/iosym/attiny5.S: (Dito.)
+	* crt1/iosym/attiny84.S: (Dito.)
+	* crt1/iosym/attiny84a.S: (Dito.)
+	* crt1/iosym/attiny85.S: (Dito.)
+	* crt1/iosym/attiny861.S: (Dito.)
+	* crt1/iosym/attiny861a.S: (Dito.)
+	* crt1/iosym/attiny87.S: (Dito.)
+	* crt1/iosym/attiny88.S: (Dito.)
+	* crt1/iosym/attiny9.S: (Dito.)
+	* crt1/iosym/atxmega128a1.S: (Dito.)
+	* crt1/iosym/atxmega128a1u.S: (Dito.)
+	* crt1/iosym/atxmega128a3.S: (Dito.)
+	* crt1/iosym/atxmega128d3.S: (Dito.)
+	* crt1/iosym/atxmega16a4.S: (Dito.)
+	* crt1/iosym/atxmega16d4.S: (Dito.)
+	* crt1/iosym/atxmega192a3.S: (Dito.)
+	* crt1/iosym/atxmega192d3.S: (Dito.)
+	* crt1/iosym/atxmega256a3.S: (Dito.)
+	* crt1/iosym/atxmega256a3b.S: (Dito.)
+	* crt1/iosym/atxmega256d3.S: (Dito.)
+	* crt1/iosym/atxmega32a4.S: (Dito.)
+	* crt1/iosym/atxmega32d4.S: (Dito.)
+	* crt1/iosym/atxmega64a1.S: (Dito.)
+	* crt1/iosym/atxmega64a1u.S: (Dito.)
+	* crt1/iosym/atxmega64a3.S: (Dito.)
+	* crt1/iosym/atxmega64d3.S: (Dito.)
+	* crt1/iosym/m3000.S: (Dito.)
+
+2013-04-30 Mike Rice <mike@mikerice.name>
+
+    * Corrected date for determing final week of year ( /libc/time/strftime.c )
+
+2013-04-29 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Contributed by Wouter van Gulik:
+	* devtools/ioreg.pl: Fix some typos in documentation.
+
+2013-04-29 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Contributed by Knut Schwichtenberg:
+	* devtools/ioreg.pl: Add POD (plain old documentation).
+
+2013-04-29 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac (--with-debug-info): New option.
+	* devtools/Device.am: Replace hard-coded debug information
+	options by CDEBUG or ASDEBUG, respectively.
+	* devtools/Architecture.am: (Dito.)
+	* doc/api/tools-install.dox: Document the new option here, too.
+
+2013-04-29 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* devtools/findreg.xsl: Dig up EEPROM data, too.
+	* devtools/ioreg.pl: Add EEPROM DWARF-2 template.
+
+04-29 Mike Rice <mike@mikerice.name>
+
+    * Corrected 'D' conversion of strftime to display two digit year
+    * Corrected 'V' conversion to display final week number of previous year
+        libc/time/strftime
+
+2013-04-28 Mike Rice <mike@mikerice.name>
+
+    * Augmented comments to explain the algorithm employed in libc/time/...
+        daylight_seconds.c
+        equation_of_time.c
+        gm_sidereal.c
+        gmtime_r.c
+        iso_weeknum.c
+        mk_gmtime.c
+        solar_declination.c
+
+2013-04-27 Mike Rice <mike@mikerice.name>
+
+    * libc/time/strftime.c now handles all conversions, in the C locale.
+    * New function/file libc/time/iso_weeknum .
+    * Declared time_t and struct tm parameters 'const' in libc/time/...
+        daylight_seconds.c
+        equation_of_time.c
+        fatfs_time.c
+        isotime.c
+        isotime_r.c
+        mk_gmtime.c
+        moon_phase.c
+        solar_declination.c
+        solar_noon.c
+        sun_rise.c
+        sun_set.c
+
+    * Edited the docs overview with a more complete description, references to the standard,
+    * and details on the departures from standard.
+        include/time.h
+
+    * Corrected the name of the iso week number function from iso_week to iso_weeknum
+        libc/time/iso_weeknum.c
+
+2013-04-26 Mike Rice <mike@mikerice.name>
+
+    * Re-write of the 'week_of' functions. The original was often incorrect for any base day except
+    * Sunday (libc/time)
+        week_of_month.c
+        week_of_year.c
+
+2013-04-25 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* devtools/ioreg.pl: (New file.), contributed by Knut
+	Schwichtenberg
+	* devtools/findreg.xsl: (New file.)
+
+2013-04-24 Mike Rice <mike@mikerice.name>
+
+    * Modified moon_phase() to give a more realistic 'curve' (libc/time/moonphase.c)
+
+2013-04-23 Mike Rice <mike@mikerice.name>
+
+    * Changed month_length() to use the 'knuckles' algorithm. Slightly less code and
+    * easier to understand.
+        libc/time/month_length.c
+
+    * Fixed unused variable warning in tests/simulate/time/tick.c
+
+2013-04-21 Mike Rice <mike@mikerice.name>
+
+    * Changed the method of setting the system time
+        include/time.h
+        libc/time/set_system_time.c
+
+    * Broke out function common to isotime_r and asctime_r (libc/time)
+        asctime_r.c
+        isotime_r.c
+        print_lz.c
+
+2013-04-20 Mike Rice <mike@mikerice.name>
+
+    * libc/include/time.h
+        Edited docs of system_tick()
+        Corrected figure for the 'end of time'
+
+2013-04-19 Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* devtools/gen-avr-lib-tree.sh: De-POSIXify the shell usage, since
+	Solaris' /bin/sh is not POSIX-aware.  For the remaining tools,
+	their POSIXish variants can be chosen by prepending the PATH with
+	/usr/xpg4/bin (doesn't harm for non-Solaris systems), but as for
+	the shell this script is running under, the only other option
+	were to let autoconf detect it, which is a bit of overkill.
+
+2013-04-19 Mike Rice <mike@mikerice.name>
+
+    * Improved tests in tests/simulate/time
+    * Corrected month length function to match its prototype
+        include/time.h
+        libc/time/month_length.c
+
+2013-04-18 Mike Rice <mike@mikerice.name>
+
+    * Improvement to isotime_r saves some cpu cycles
+        libc/time/isotime_r.c
+
+    * Added some basic tests to tests/simulate/time
+
+2013-04-16 Mike Rice <mike@mikerice.name>
+
+    * Modified system_tick() to much a more efficient version suggested by Wouter van Gulik
+        libc/time/system_tick.c
+        include/time.h
+
+2013-04-11 Mike Rice <mike@mikerice.name>
+
+    * Experimental system_tick_i() proves out (libc/time)
+        remove system_tick.c
+        rename system_tick_i.c to system_tick.c
+        modify include/time.h to reflect the change
+
+2013-04-11 Mike Rice <mike@mikerice.name>
+
+    * Found conflicting data between USNO and NOAA tables. Settled on using USNO data (libc/time)
+        ephemera_common.h
+        equation_of_time.c
+        solar_declination.c
+
+2013-04-10 Mike Rice <mike@mikerice.name>
+
+    * Erroneous 'include once' in libc/include/util/eu_dst prevented inclusion of both
+      daylight savings functions in one application
+
+2013-04-11 Mike Rice <mike@mikerice.name>
+
+    * Found conflicting data between USNO and NOAA tables. Settled on using USNO data (libc/time)
+        ephemera_common.h
+        equation_of_time.c
+        solar_declination.c
+
+2013-04-10 Mike Rice <mike@mikerice.name>
+
+    * Erroneous 'include once' in libc/include/util/eu_dst prevented inclusion of both
+    * daylight savings functions in one application
+
+2013-04-09 Mike Rice <mike@mikerice.name>
+
+    * Gathered some constant terms from ephemera (libc/time)
+            ephemera_common.h
+            equation_of_time.c
+            solar_declination.c
+
+    * Pulled calculation of solar noon from sun_rise and sun_set, creating new function
+      solar_noon() (libc)
+        /include/time.h
+        /time/sun_rise.c
+        /time/sun_set.c
+        /time/solar_noon.c
+
+2013-04-08 Mike Rice <mike@mikerice.name>
+
+      * Moved some macros common to the ephemera functions to a new header file, changing
+      * some values for closer fits to the 'zeroes' of the equations (libc/time)
+            ephemera_common.h
+            equation_of_time.c
+            solar_declination.c
+
+2013-04-07 Mike Rice <mike@mikerice.name>
+
+    * Corrected an error computing fractional day in libc/time/mk_gmtime.c
+    * fixed a typo in libc/include/util/eu_dst.c
+
+2013-04-06 Mike Rice <mike@mikerice.name>
+
+    * Improved overall precision of equation of time and declination (libc/time)
+        solar_declination.c
+        equation_of_time.c
+
+2013-04-05 Mike Rice <mike@mikerice.name>
+
+    * fixed warnings about 'long long' when compiled with -Wextra (libc/time)
+        gm_sidereal.c
+        mk_gmtime.c
+
+2013-04-03 Mike Rice <mike@mikerice.name>
+
+    * libc/time/strftime.c
+        Modified 'c' conversion to use the asctime() function
+        corrected 'F' conversion year formatting
+        corrected 'R' conversion hour formatting
+        corrected 'x' conversion year formatting
+
+2013-04-02 Mike Rice <mike@mikerice.name>
+
+    * Rearrange code and comments for clarity ( libc )
+        include/time.h
+
+        time/asc_store.c
+        time/gmtime_r.c
+        time/mk_gmtime.c
+        time/tm_store.c
+        time/utc_offset.c
+        time/week_of_month.c
+        time/week_of_year.c
+        time/solar_declination.c
+        time/sun_rise.c
+        time/sun_set.c
+        time/daylight_seconds.c
+        time/gm_sidereal.c
+        time/lm_sidereal.c
+        time/moon_phase.c
+        time/is_leap_year.c
+
+
+
+2013-03-31 Mike Rice <mike@mikerice.name>
+
+    * Added experimental function system_tick_i() ( libc/time/system_tick_i.c )
+        assembler code for greater efficiency
+        easy to call from 'naked' ISR
+
+2013-03-30 Mike Rice <mike@mikerice.name>
+
+    * Mar 30 moved private time variables out to separate C files ( libc/time )
+        asc_store.c :  asctime() private character buffer
+        dst_pointer.c : daylight savings function pointer
+        geo_location.c : __latitude, __longitude
+        tm_store.c : gmtime(), localtime() private struct tm
+        utc_offset.c : __utc_offset
+
+2013-03-29 Mike Rice <mike@mikerice.name>
+
+	* libc/time: (New directory.)
+	* include/time.h: (New file.)
+	* include/util/eu_dst.h: (New file.)
+	* include/util/usa_dst.h: (New file.)
+
+2013-03-19 Joerg Wunsch <joerg.wunsch@atmel.com>
+
+	* devtools/gen-avr-lib-tree.sh: Add ATmega64RFR2, ATmega644RFR2,
+	ATmega128RFR2, ATmega1284RFR2, ATmega256RFR2, ATmega2564RFR2
+	* configure.ac: (Dito.)
+	* doc/api/main_page.dox: Document new device support.
+	* doc/api/using-tools.dox: (Dito.)
+	* include/avr/io.h: Add hooks for ATmega*RFR2 devices.
+	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
+	* include/avr/sleep.h: Add sleep modes for ATmega*RFR2 devices.
+	* include/avr/wdt.h: Add watchdog support for ATmega*RFR2 devices.
+	* include/avr/power.h: Add power management definitions for
+	ATmega*RFR2 devices.
+	* include/avr/eeprom.h: Add EEPROM definitions for ATmega*RFR2
+	devices.
+	* include/avr/iom64rfr2.h: (New file.)
+	* include/avr/iom644rfr2.h: (New file.)
+	* include/avr/iom128rfr2.h: (New file.)
+	* include/avr/iom1284rfr2.h: (New file.)
+	* include/avr/iom256rfr2.h: (New file.)
+	* include/avr/iom2564rfr2.h: (New file.)
+
+2013-01-27  Dmitry Xmelkov  <dmix@gmail.ru>
+
+	Fix for bug #37778: _MemoryBarrier() in cpufunc.h error on compile
+	* include/avr/cpufunc.h: Place empty string for asm body. This is
+	needed for older GCC versions.
+	* tests/simulate/regression/bug-37778.c: New file.
+	* NEWS: Add to fixed bug list.
+
+2013-01-10  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Senthil Kumar Selvaraj:
+	* include/avr/Makefile.am (avr_HEADERS): add xmega.h
+
+2013-01-02  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Submitted by Jan Waclawek:
+	* doc/api/assembler.dox: Mention that .sx is an alternate suffix
+	for .S
+
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2014 avr-libc-r2546/ChangeLog-2014
--- avr-libc-2.0.0-orig/ChangeLog-2014	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2014	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,853 @@
+2014-12-03  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8563: Generalize power reduction macros in power.h by removing
+	hard coded device names (part #2)
+	* include/avr/power.h: Removed device names from power macro documentation.
+	Removed device name conditions to define power macros. Instead used power
+	macro conditions from device header file.
+
+2014-12-02  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8563: Generalize power reduction macros in power.h by removing
+	hard coded device names (part #1)
+	* include/avr/iox128a1.h: Add power reduction conditions.
+	* include/avr/iox128a1u.h: Likewise.
+	* include/avr/iox128a3.h: Likewise.
+	* include/avr/iox128a3u.h: Likewise.
+	* include/avr/iox128a4u.h: Likewise.
+	* include/avr/iox128b1.h: Likewise.
+	* include/avr/iox128b3.h: Likewise.
+	* include/avr/iox128c3.h: Likewise.
+	* include/avr/iox128d3.h: Likewise.
+	* include/avr/iox128d4.h: Likewise.
+	* include/avr/iox16a4.h: Likewise.
+	* include/avr/iox16a4u.: Likewise.
+	* include/avr/iox16c4.: Likewise.
+	* include/avr/iox16d4.: Likewise.
+	* include/avr/iox192a3.: Likewise.
+	* include/avr/iox192a3u.: Likewise.
+	* include/avr/iox192c3.: Likewise.
+	* include/avr/iox192d3.: Likewise.
+	* include/avr/iox256a3.: Likewise.
+	* include/avr/iox256a3b.: Likewise.
+	* include/avr/iox256a3bu.: Likewise.
+	* include/avr/iox256a3u.: Likewise.
+	* include/avr/iox256c3.: Likewise.
+	* include/avr/iox256d3.: Likewise.
+	* include/avr/iox32a4.: Likewise.
+	* include/avr/iox32a4u.: Likewise.
+	* include/avr/iox32c4.: Likewise.
+	* include/avr/iox32d4.: Likewise.
+	* include/avr/iox384c3.: Likewise.
+	* include/avr/iox384d3.: Likewise.
+	* include/avr/iox64a1.: Likewise.
+	* include/avr/iox64a1u.: Likewise.
+	* include/avr/iox64a3.: Likewise.
+	* include/avr/iox64a3u.: Likewise.
+	* include/avr/iox64a4u.: Likewise.
+	* include/avr/iox64b1.: Likewise.
+	* include/avr/iox64b3.: Likewise.
+	* include/avr/iox64c3.: Likewise.
+	* include/avr/iox64d3.: Likewise.
+	* include/avr/iox64d4.: Likewise.
+	* include/avr/iom1284.h: Likewise.
+	* include/avr/iom1284p.h: Likewise.
+	* include/avr/iom1284rfr2.h: Likewise.
+	* include/avr/iom128rfa1.h: Likewise.
+	* include/avr/iom128rfr2.h: Likewise.
+	* include/avr/iom164pa.h: Likewise.
+	* include/avr/iom165a.h: Likewise.
+	* include/avr/iom165.h: Likewise.
+	* include/avr/iom165pa.h: Likewise.
+	* include/avr/iom165p.h: Likewise.
+	* include/avr/iom168pa.h: Likewise.
+	* include/avr/iom168p.h: Likewise.
+	* include/avr/iom169.h: Likewise.
+	* include/avr/iom169pa.h: Likewise.
+	* include/avr/iom169p.h: Likewise.
+	* include/avr/iom16hva2.h: Likewise.
+	* include/avr/iom16hvb.h: Likewise.
+	* include/avr/iom16hvbrevb.h: Likewise.
+	* include/avr/iom16m1.h: Likewise.
+	* include/avr/iom16u2.h: Likewise.
+	* include/avr/iom16u4.h: Likewise.
+	* include/avr/iom2564rfr2.h: Likewise.
+	* include/avr/iom256rfr2.h: Likewise.
+	* include/avr/iom324pa.h: Likewise.
+	* include/avr/iom3250.h: Likewise.
+	* include/avr/iom3250pa.h: Likewise.
+	* include/avr/iom325.h: Likewise.
+	* include/avr/iom325pa.h: Likewise.
+	* include/avr/iom328p.h: Likewise.
+	* include/avr/iom3290.h: Likewise.
+	* include/avr/iom3290pa.h: Likewise.
+	* include/avr/iom329.h: Likewise.
+	* include/avr/iom32c1.h: Likewise.
+	* include/avr/iom32hvb.h: Likewise.
+	* include/avr/iom32hvbrevb.h: Likewise.
+	* include/avr/iom32m1.h: Likewise.
+	* include/avr/iom32u2.h: Likewise.
+	* include/avr/iom32u4.h: Likewise.
+	* include/avr/iom32u6.h: Likewise.
+	* include/avr/iom406.h: Likewise.
+	* include/avr/iom48pa.h: Likewise.
+	* include/avr/iom48p.h: Likewise.
+	* include/avr/iom644pa.h: Likewise.
+	* include/avr/iom644rfr2.h: Likewise.
+	* include/avr/iom6450.h: Likewise.
+	* include/avr/iom645.h: Likewise.
+	* include/avr/iom6490.h: Likewise.
+	* include/avr/iom649.h: Likewise.
+	* include/avr/iom649p.h: Likewise.
+	* include/avr/iom64c1.h: Likewise.
+	* include/avr/iom64hve.h: Likewise.
+	* include/avr/iom64m1.h: Likewise.
+	* include/avr/iom64rfr2.h: Likewise.
+	* include/avr/iom88pa.h: Likewise.
+	* include/avr/iom88p.h: Likewise.
+	* include/avr/iom8u2.h: Likewise.
+	* include/avr/iomx8.h: Likewise.
+	* include/avr/iomxx0_1.h: Likewise.
+	* include/avr/iomxx4.h: Likewise.
+	* include/avr/iomxxhva.h: Likewise.
+	* include/avr/io90pwm161.h: Likewise.
+	* include/avr/io90pwm1.h: Likewise.
+	* include/avr/io90pwm216.h: Likewise.
+	* include/avr/io90pwm2b.h: Likewise.
+	* include/avr/io90pwm316.h: Likewise.
+	* include/avr/io90pwm3b.h: Likewise.
+	* include/avr/io90pwm81.h: Likewise.
+	* include/avr/io90pwmx.h: Likewise.
+	* include/avr/io90scr100.h: Likewise.
+	* include/avr/ioa5272.h: Likewise.
+	* include/avr/ioa5505.h: Likewise.
+	* include/avr/ioa5790.h: Likewise.
+	* include/avr/ioa5795.h: Likewise.
+	* include/avr/iotn10.h: Likewise.
+	* include/avr/iotn13a.h: Likewise.
+	* include/avr/iotn1634.h: Likewise.
+	* include/avr/iotn167.h: Likewise.
+	* include/avr/iotn20.h: Likewise.
+	* include/avr/iotn2313a.h: Likewise.
+	* include/avr/iotn24a.h: Likewise.
+	* include/avr/iotn261a.h: Likewise.
+	* include/avr/iotn40.h: Likewise.
+	* include/avr/iotn4313.h: Likewise.
+	* include/avr/iotn43u.h: Likewise.
+	* include/avr/iotn44a.h: Likewise.
+	* include/avr/iotn461a.h: Likewise.
+	* include/avr/iotn48.h: Likewise.
+	* include/avr/iotn4.h: Likewise.
+	* include/avr/iotn5.h: Likewise.
+	* include/avr/iotn828.h: Likewise.
+	* include/avr/iotn84a.h: Likewise.
+	* include/avr/iotn861a.h: Likewise.
+	* include/avr/iotn87.h: Likewise.
+	* include/avr/iotn88.h: Likewise.
+	* include/avr/iotn9.h: Likewise.
+	* include/avr/iotnx4.h: Likewise.
+	* include/avr/iotnx5.h: Likewise.
+	* include/avr/iotnx61.h: Likewise.
+	* include/avr/iousbxx2.h: Likewise.
+	* include/avr/iousbxx6_7.h: Likewise.
+
+2014-11-21  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+    * crt1/gcrt1.S: Add a note section embedding device info.
+    * doc/api/sections.dox: Document it.
+
+2014-11-20  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	* include/avr/sleep.h (set_sleep_mode): Branch on presence of 
+	SLEEP_SMODE<n>_bm for xmegas.
+
+2014-11-18  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	* include/avr/sleep.h (set_sleep_mode): Remove SLEEP_MODE defines 
+	for tiny and mega devices as well. Branch on presence of SM<n> 
+	instead of device name.
+
+2014-11-18  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	* include/avr/Makefile.am: Add new headers iom{48,88,168}a.h.
+	* include/avr/io.h: Include them.
+	* include/avr/iom48a.h: New.
+	* include/avr/iom88a.h: Likewise.
+	* include/avr/iom168a.h: Likewise.
+	* include/avr/io2313.h: Add supported sleep modes.
+	* include/avr/io2323.h: Likewise.
+	* include/avr/io2333.h: Likewise.
+	* include/avr/io2343.h: Likewise.
+	* include/avr/io43u32x.h: Likewise.
+	* include/avr/io43u35x.h: Likewise.
+	* include/avr/io4414.h: Likewise.
+	* include/avr/io4433.h: Likewise.
+	* include/avr/io4434.h: Likewise.
+	* include/avr/io76c711.h: Likewise.
+	* include/avr/io8515.h: Likewise.
+	* include/avr/io8535.h: Likewise.
+	* include/avr/io90pwm1.h: Likewise.
+	* include/avr/io90pwm161.h: Likewise.
+	* include/avr/io90pwm216.h: Likewise.
+	* include/avr/io90pwm2b.h: Likewise.
+	* include/avr/io90pwm316.h: Likewise.
+	* include/avr/io90pwm3b.h: Likewise.
+	* include/avr/io90pwm81.h: Likewise.
+	* include/avr/io90pwmx.h: Likewise.
+	* include/avr/io90scr100.h: Likewise.
+	* include/avr/ioa5272.h: Likewise.
+	* include/avr/ioa5505.h: Likewise.
+	* include/avr/ioa5790.h: Likewise.
+	* include/avr/ioa5795.h: Likewise.
+	* include/avr/ioa6285.h: Likewise.
+	* include/avr/ioa6286.h: Likewise.
+	* include/avr/ioa6289.h: Likewise.
+	* include/avr/ioat94k.h: Likewise.
+	* include/avr/iocan128.h: Likewise.
+	* include/avr/iocan32.h: Likewise.
+	* include/avr/iocan64.h: Likewise.
+	* include/avr/iom103.h: Likewise.
+	* include/avr/iom128.h: Likewise.
+	* include/avr/iom1280.h: Likewise.
+	* include/avr/iom1281.h: Likewise.
+	* include/avr/iom1284.h: Likewise.
+	* include/avr/iom1284p.h: Likewise.
+	* include/avr/iom1284rfr2.h: Likewise.
+	* include/avr/iom128a.h: Likewise.
+	* include/avr/iom128rfa1.h: Likewise.
+	* include/avr/iom128rfr2.h: Likewise.
+	* include/avr/iom16.h: Likewise.
+	* include/avr/iom161.h: Likewise.
+	* include/avr/iom162.h: Likewise.
+	* include/avr/iom163.h: Likewise.
+	* include/avr/iom164.h: Likewise.
+	* include/avr/iom164pa.h: Likewise.
+	* include/avr/iom165.h: Likewise.
+	* include/avr/iom165a.h: Likewise.
+	* include/avr/iom165p.h: Likewise.
+	* include/avr/iom165pa.h: Likewise.
+	* include/avr/iom168.h: Likewise.
+	* include/avr/iom168p.h: Likewise.
+	* include/avr/iom168pa.h: Likewise.
+	* include/avr/iom169.h: Likewise.
+	* include/avr/iom169p.h: Likewise.
+	* include/avr/iom169pa.h: Likewise.
+	* include/avr/iom16a.h: Likewise.
+	* include/avr/iom16hva.h: Likewise.
+	* include/avr/iom16hva2.h: Likewise.
+	* include/avr/iom16hvb.h: Likewise.
+	* include/avr/iom16hvbrevb.h: Likewise.
+	* include/avr/iom16m1.h: Likewise.
+	* include/avr/iom16u2.h: Likewise.
+	* include/avr/iom16u4.h: Likewise.
+	* include/avr/iom2560.h: Likewise.
+	* include/avr/iom2561.h: Likewise.
+	* include/avr/iom2564rfr2.h: Likewise.
+	* include/avr/iom256rfr2.h: Likewise.
+	* include/avr/iom32.h: Likewise.
+	* include/avr/iom323.h: Likewise.
+	* include/avr/iom324.h: Likewise.
+	* include/avr/iom324pa.h: Likewise.
+	* include/avr/iom325.h: Likewise.
+	* include/avr/iom3250.h: Likewise.
+	* include/avr/iom3250pa.h: Likewise.
+	* include/avr/iom325pa.h: Likewise.
+	* include/avr/iom328p.h: Likewise.
+	* include/avr/iom329.h: Likewise.
+	* include/avr/iom3290.h: Likewise.
+	* include/avr/iom3290pa.h: Likewise.
+	* include/avr/iom32a.h: Likewise.
+	* include/avr/iom32c1.h: Likewise.
+	* include/avr/iom32hvb.h: Likewise.
+	* include/avr/iom32hvbrevb.h: Likewise.
+	* include/avr/iom32m1.h: Likewise.
+	* include/avr/iom32u2.h: Likewise.
+	* include/avr/iom32u4.h: Likewise.
+	* include/avr/iom32u6.h: Likewise.
+	* include/avr/iom406.h: Likewise.
+	* include/avr/iom48.h: Likewise.
+	* include/avr/iom48p.h: Likewise.
+	* include/avr/iom48pa.h: Likewise.
+	* include/avr/iom64.h: Likewise.
+	* include/avr/iom640.h: Likewise.
+	* include/avr/iom644.h: Likewise.
+	* include/avr/iom644p.h: Likewise.
+	* include/avr/iom644pa.h: Likewise.
+	* include/avr/iom644rfr2.h: Likewise.
+	* include/avr/iom645.h: Likewise.
+	* include/avr/iom6450.h: Likewise.
+	* include/avr/iom649.h: Likewise.
+	* include/avr/iom6490.h: Likewise.
+	* include/avr/iom649p.h: Likewise.
+	* include/avr/iom64a.h: Likewise.
+	* include/avr/iom64c1.h: Likewise.
+	* include/avr/iom64hve.h: Likewise.
+	* include/avr/iom64m1.h: Likewise.
+	* include/avr/iom64rfr2.h: Likewise.
+	* include/avr/iom8.h: Likewise.
+	* include/avr/iom8515.h: Likewise.
+	* include/avr/iom8535.h: Likewise.
+	* include/avr/iom88.h: Likewise.
+	* include/avr/iom88p.h: Likewise.
+	* include/avr/iom88pa.h: Likewise.
+	* include/avr/iom8a.h: Likewise.
+	* include/avr/iom8hva.h: Likewise.
+	* include/avr/iom8u2.h: Likewise.
+	* include/avr/iotn10.h: Likewise.
+	* include/avr/iotn11.h: Likewise.
+	* include/avr/iotn12.h: Likewise.
+	* include/avr/iotn13.h: Likewise.
+	* include/avr/iotn13a.h: Likewise.
+	* include/avr/iotn15.h: Likewise.
+	* include/avr/iotn1634.h: Likewise.
+	* include/avr/iotn167.h: Likewise.
+	* include/avr/iotn20.h: Likewise.
+	* include/avr/iotn22.h: Likewise.
+	* include/avr/iotn2313.h: Likewise.
+	* include/avr/iotn2313a.h: Likewise.
+	* include/avr/iotn24.h: Likewise.
+	* include/avr/iotn24a.h: Likewise.
+	* include/avr/iotn25.h: Likewise.
+	* include/avr/iotn26.h: Likewise.
+	* include/avr/iotn261.h: Likewise.
+	* include/avr/iotn261a.h: Likewise.
+	* include/avr/iotn28.h: Likewise.
+	* include/avr/iotn4.h: Likewise.
+	* include/avr/iotn40.h: Likewise.
+	* include/avr/iotn4313.h: Likewise.
+	* include/avr/iotn43u.h: Likewise.
+	* include/avr/iotn44.h: Likewise.
+	* include/avr/iotn44a.h: Likewise.
+	* include/avr/iotn45.h: Likewise.
+	* include/avr/iotn461.h: Likewise.
+	* include/avr/iotn461a.h: Likewise.
+	* include/avr/iotn48.h: Likewise.
+	* include/avr/iotn5.h: Likewise.
+	* include/avr/iotn828.h: Likewise.
+	* include/avr/iotn84.h: Likewise.
+	* include/avr/iotn84a.h: Likewise.
+	* include/avr/iotn85.h: Likewise.
+	* include/avr/iotn861.h: Likewise.
+	* include/avr/iotn861a.h: Likewise.
+	* include/avr/iotn87.h: Likewise.
+	* include/avr/iotn88.h: Likewise.
+	* include/avr/iotn9.h: Likewise.
+	* include/avr/iousb1286.h: Likewise.
+	* include/avr/iousb1287.h: Likewise.
+	* include/avr/iousb162.h: Likewise.
+	* include/avr/iousb646.h: Likewise.
+	* include/avr/iousb647.h: Likewise.
+	* include/avr/iousb82.h: Likewise.
+
+2014-10-15  Soundararajan Dhakshinamoorthy <sounderarajan.d@atmel.com>
+
+	patch $8557: Proposing to remove device specific xmega macros 
+	from sleep.h.
+	* include/avr/iox128a1.h: Add SLEEP_MODE defines.
+	* include/avr/iox128a1u.h: Likewise.
+	* include/avr/iox128a3.h: Likewise.
+	* include/avr/iox128a3u.h: Likewise.
+	* include/avr/iox128a4u.h: Likewise.
+	* include/avr/iox128b1.h: Likewise.
+	* include/avr/iox128b3.h: Likewise.
+	* include/avr/iox128c3.h: Likewise.
+	* include/avr/iox128d3.h: Likewise.
+	* include/avr/iox128d4.h: Likewise.
+	* include/avr/iox16a4.h: Likewise.
+	* include/avr/iox16a4u.h: Likewise.
+	* include/avr/iox16c4.h: Likewise.
+	* include/avr/iox16d4.h: Likewise.
+	* include/avr/iox192a3.h: Likewise.
+	* include/avr/iox192a3u.h: Likewise.
+	* include/avr/iox192c3.h: Likewise.
+	* include/avr/iox192d3.h: Likewise.
+	* include/avr/iox256a3.h: Likewise.
+	* include/avr/iox256a3b.h: Likewise.
+	* include/avr/iox256a3bu.h: Likewise.
+	* include/avr/iox256a3u.h: Likewise.
+	* include/avr/iox256c3.h: Likewise.
+	* include/avr/iox256d3.h: Likewise.
+	* include/avr/iox32a4.h: Likewise.
+	* include/avr/iox32a4u.h: Likewise.
+	* include/avr/iox32c4.h: Likewise.
+	* include/avr/iox32d4.h: Likewise.
+	* include/avr/iox384c3.h: Likewise.
+	* include/avr/iox384d3.h: Likewise.
+	* include/avr/iox64a1.h: Likewise.
+	* include/avr/iox64a1u.h: Likewise.
+	* include/avr/iox64a3.h: Likewise.
+	* include/avr/iox64a3u.h: Likewise.
+	* include/avr/iox64a4u.h: Likewise.
+	* include/avr/iox64b1.h: Likewise.
+	* include/avr/iox64b3.h: Likewise.
+	* include/avr/iox64c3.h: Likewise.
+	* include/avr/iox64d3.h: Likewise.
+	* include/avr/iox64d4.h: Likewise.
+	* include/avr/sleep.h (set_sleep_mode): Use __AVR_XMEGA__ instead
+	of device names. Remove SLEEP_MODE defines.
+
+2014-10-18  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+	     Georg-Johann Lay <avr@gjlay.de>
+
+	* include/avr/wdt.h: Generalize implementation of wdt_enable and
+	wdt_disable based on arch and addressability of _WD_CONTROL_REG.
+
+2014-10-15  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+	* include/util/delay.h.in: Replace inline with __inline__ and
+	always_inline with __always_inline__.
+	* include/util/delay_basic.h: Likewise.
+
+2014-09-26  Soundararajan Dhakshinamoorthy <sounderarajan.d@atmel.com>
+
+	patch $8543: Fix multiple issues with device header files.
+	* include/avr/iom16hvb.h: define VREFGND_DDR instead of duplicate VREF_DDR.
+	* include/avr/iom32hvb.h: Likewise.
+	* include/avr/io90pwm216.h: Alias PRUSART0 for PRUSART as per datasheet.
+	* include/avr/io90pwm316.h: Likewise.
+	* include/avr/io90pwmx.h: Likewise.
+	* include/avr/iotn167.h: Fix the values for DIDR1 register bitfields.
+	* include/avr/iotn87.h: Likewise.
+	* include/avr/iom8u2.h: Define the missing DIDR1 register bitfields.
+	* include/avr/iom16u2.h: Likewise.
+	* include/avr/iom32u2.h: Likewise.
+	* include/avr/iom165.h (SIGNATURE_2): Correct the value.
+	* include/avr/iotn13a.h: Fix typo and maintain backward compatibility.
+	* include/avr/iomx8.h (RWWSB, RWWSRE): Enable for additional devices mega 
+	88P,168P,88A,168A and 168PA.
+	(SIGRD): Add for devices mega 48A, 48PA, 88A, 88PA, 168A and 168PA.
+	* include/avr/iox64d3.h: Define missing TWIE and ADC registers.
+	* include/avr/iox128d3.h: Likewise.
+	* include/avr/iox192d3.h: Likewise.
+	* include/avr/iox256d3.h: Likewise.
+	* include/avr/iox16d4.h: Define missing CRC register definitions. Define
+	missing TWIE module registers and possible ADC_CURRLIMIT enumerations.
+	* include/avr/iox32d4.h: Likewise.
+	* include/avr/iox64d4.h: Remove invalid ADC_CH_MUXPOS pin definitions.
+	* include/avr/iox128d4.h: Likewise.
+	* include/avr/iox256a3b.h: Remove obsoleted USARTF1 module register.
+
+2014-09-25  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	* include/avr/wdt.h (wdt_enable): save & restore rampd register.
+	correct syntax.
+	(wdt_disable): Likewise.
+
+2014-08-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Post-release 1.8.1
+
+2014-08-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Prepare for release 1.8.1
+
+2014-08-12  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8512 Rename tiny arch to avrtiny to sync with binutils
+	* devtools/gen-avr-lib-tree.sh: AVRTINY10_DEV_INFO changed to
+	AVRTINY_DEV_INFO.
+	(AVR_ARH_INFO): Tiny arch name changed to avrtiny.
+	* configure.ac: Tiny arch name changed to avrtiny.
+	(AC_CONFIG_FILES): Change lib path for new architecture name.
+
+2014-08-12  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #42957 missing SPMCSR defines in iom328p.h
+	bug #41690 Bit definitions for SPMCSR
+	* include/iom328p.h: fix SPMCSR names; add correct signature for
+	ATmega328 device
+	* include/avr/iom168p.h: fix SPMCSR names
+	* include/avr/iom48p.h: (Dito.)
+	* include/avr/iom88p.h: (Dito.)
+	* include/avr/iom88pa.h: (Dito.)
+
+2014-08-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #38614 dtostrf - wrong behavior or wrong documentation
+	* include/stdlib.h (dtostrf): add "possible for the decimal dot
+
+2014-08-11  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	bug #39779 PCIE0 and PCIE1 defined incorrectly for mega165a and mega165pa devices
+	* include/avr/iom165a.h: Create a separate IO header file for
+	the ATmega165A (derived from ATmega165PA which has already been
+	correct)
+	* include/avr/io.h: Include iom165a.h
+	* include/avr/Makefile.am: Add iom165a.h
+
+2014-08-05  Senthil Kumar Selvaraj  <senthil_kumar.selvaraj@atmel.com>
+
+	* include/avr/io1200.h: Add RAMSTART.
+	* include/avr/io2313.h: Likewise.
+	* include/avr/io2323.h: Likewise.
+	* include/avr/io2333.h: Likewise.
+	* include/avr/io2343.h: Likewise.
+	* include/avr/io43u32x.h: Likewise.
+	* include/avr/io43u35x.h: Likewise.
+	* include/avr/io4414.h: Likewise.
+	* include/avr/io4433.h: Likewise.
+	* include/avr/io4434.h: Likewise.
+	* include/avr/io76c711.h: Likewise.
+	* include/avr/io8515.h: Likewise.
+	* include/avr/io8534.h: Likewise.
+	* include/avr/io8535.h: Likewise.
+	* include/avr/io86r401.h: Likewise.
+	* include/avr/io90pwm216.h: Likewise.
+	* include/avr/io90pwm2b.h: Likewise.
+	* include/avr/io90pwm316.h: Likewise.
+	* include/avr/io90pwm3b.h: Likewise.
+	* include/avr/ioat94k.h: Likewise.
+	* include/avr/iocan128.h: Likewise.
+	* include/avr/iocan32.h: Likewise.
+	* include/avr/iocan64.h: Likewise.
+	* include/avr/iom103.h: Likewise.
+	* include/avr/iom128.h: Likewise.
+	* include/avr/iom1280.h: Likewise.
+	* include/avr/iom161.h: Likewise.
+	* include/avr/iom162.h: Likewise.
+	* include/avr/iom163.h: Likewise.
+	* include/avr/iom165.h: Likewise.
+	* include/avr/iom165p.h: Likewise.
+	* include/avr/iom169.h: Likewise.
+	* include/avr/iom169p.h: Likewise.
+	* include/avr/iom16hva.h: Likewise.
+	* include/avr/iom2560.h: Likewise.
+	* include/avr/iom2561.h: Likewise.
+	* include/avr/iom323.h: Likewise.
+	* include/avr/iom329.h: Likewise.
+	* include/avr/iom3290.h: Likewise.
+	* include/avr/iom32hvbrevb.h: Likewise.
+	* include/avr/iom406.h: Likewise.
+	* include/avr/iom64.h: Likewise.
+	* include/avr/iom640.h: Likewise.
+	* include/avr/iom649.h: Likewise.
+	* include/avr/iom6490.h: Likewise.
+	* include/avr/iom8hva.h: Likewise.
+	* include/avr/iotn11.h: Likewise.
+	* include/avr/iotn12.h: Likewise.
+	* include/avr/iotn15.h: Likewise.
+	* include/avr/iotn22.h: Likewise.
+	* include/avr/iotn26.h: Likewise.
+	* include/avr/iotn28.h: Likewise.
+	* include/avr/iotn43u.h: Likewise.
+	* include/avr/iousb1286.h: Likewise.
+	* include/avr/iousb1287.h: Likewise.
+	* include/avr/iousb162.h: Likewise.
+	* include/avr/iousb646.h: Likewise.
+	* include/avr/iousb647.h: Likewise.
+	* include/avr/iousb82.h: Likewise.
+	* include/avr/io90pwm1.h: Add RAMSTART and fix FLASHEND.
+	* include/avr/io90pwmx.h: Likewise.
+	* include/avr/iom3000.h: Add RAMSTART and fix RAMEND.
+	* include/avr/iotn167.h: Fix RAMSIZE.
+
+2014-07-30  Matthijs Kooijman <matthijs>
+
+	Fix bug #40569: sleep_bod_disable does not work in attiny13a
+	* include/avr/sleep.h: define BOD_CONTROL_REG based on BODCR.
+	(sleep_bod_disable): use BOD_CONTROL_REG in place of MCUCR.
+
+2014-07-24  Pitchumani Sivanupandi  <pitchumani.s@atmel.com>
+
+	Move device ata6289 from avr25 arch group to avr4.
+	* devtools/gen-avr-lib-tree.sh: Move device ata6289 to avr4 arch group.
+	* configure.ac: Same. 
+	* doc/api/using-tools.dox: Same.
+
+2014-05-19  Pitchumani Sivanupandi  <pitchumani.s@atmel.com>
+
+	* include/avr/wdt.h (wdt_enable): update wdt_enable for xmega to wait
+	till sync finished (as per datasheet).
+	(wdt_disable): Add wdt_disable for xmega devices.
+
+2014-05-19  Joern Rennecke <joern.rennecke@embecosm.com>
+
+	* include/Makefile.am (avr_HEADERS): Add signal.h .
+	* include/signal.h: New file.
+
+2014-05-02  Pieter Agten  <pieter.agten@gmail.com>
+
+	* include/avr/iom328p.h (EFUSE_DEFAULT): update default value.
+
+2014-05-01  Joern Rennecke  <joern.rennecke@embecosm.com>
+
+	* include/math.h (sqrtf): Don't #define, declare.
+	* libm/fplib/asmdef.h (ALIAS_ENTRY): Define.
+	* libm/fplib/sqrt.S (sqrtf): New ALIAS_ENTRY.
+
+2014-05-01  Joern Rennecke  <joern.rennecke@embecosm.com>
+
+	* configure.ac (AC_CONFIG_FILES): Add include/sys/Makefile.
+	* include/Makefile.am (avr_HEADERS): Add fcntl.h, locale.h, unistd.h.
+	(SUBDIRS): Add sys.
+	* include/errno.h: Add definitions for error codes required to compile
+	libstdc++-v3.
+	* include/locale.h, include/unistd.h, include/fcntl.h: New files.
+	* include/stdio.h (FILE): Change to a typedef.
+	(BUFSIZ, _IONBF): Define.
+	(fpos_t): Typedef.
+	(fgetpos, fopen, freopen, fdopen, fseek, fsetpos, ftell): Prototype.
+	(ftell, fileno, perror, remote, rename, rewind, setbuf): Likewise.
+	(setvbuf, tmpfile, tmpnam): Likewise.
+	* include/stdlib.h (atexit, system, getenv): Prototype.
+	* include/string.h (strcoll, strerror, strxfrm): Prototype.
+	* include/sys: New directory.
+	* include/time.h (_CLOCKS_PER_SEC_): Declare.
+	(CLOCKS_PER_SEC): Define.
+	(clock): Declare.
+	* libc/stdlib/Files.am (stdlib_a_c_sources): Add atexit.c, getenv.c,
+	system.c
+	* libc/stdlib/atexit.c: New file.
+	* libc/stdlib/getenv.c, * libc/stdlib/system.c: New stub files.
+
+2014-05-01  Joern Rennecke  <joern.rennecke@embecosm.com>
+
+	* include/stdint.h [!__USING_MINT8] (UINT8_MAX): Provide (signed)
+	int value.
+	(SIZE_MAX): Define as UINT16_MAX.
+	[!WCHAR_MAX] (WCHAR_MAX, WCHAR_MIN): Define.
+	[!WINT_MAX] (WINT_MAX, WINT_MIN): Define.
+
+2014-05-01  Joern Rennecke  <joern.rennecke@embecosm.com>
+
+	* include/stdint.h (INT8_C): Also define for __cplusplus >= 201103L.
+	If __INT8_C is defined, use GNU C preprocessor builtin-macro
+	for the definition.
+	(INT16_C INT32_C, INT64_C, UINT8_C, UINT16_C, UINT32_C): Likewise.
+	(UINT64_C, INTMAX_C, UINTMAX_C): Likewise.
+
+2014-04-29  Aurelien Jarno  <aurelien@aurel32.net>
+
+	* include/util/setbaud.h: correct typo.
+
+2014-04-29  George Thomas <george.thomas@atmel.com>
+
+	Fix for bug #37103: ATtiny5/9/10/20/40 watchdog can't be enabled
+	* include/avr/wdt.h: Add wdt_enable and wdt_disable macros for tiny 4,5,
+	9,10,20 and 40 devices.
+
+2014-04-29  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	Fix for bug #39049: Clock prescaler set and get are missing for TINY arch
+	* include/avr/power.h: Add clock_prescale_set and get function/macro for 
+	tiny 4, 5, 9, 10, 20 and 40 devices.
+
+2014-04-29  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	Fix for bug #40206: incorrect SP init in startup code for xmegas
+	* crt1/gcrt1.S: write to SPL and then SPH for xmega SP initialization
+
+2014-04-28  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Fix for bug #42024: build break regarding avrtiny10
+	Submitted by baxelrod@irobot.com
+	* libc/misc/itoa.S: Fix typo in avr tiny macro.
+	* libc/misc/itoa_ncheck.S: Same.
+	* libc/misc/ltoa.S: Same.
+	* libc/misc/ltoa_ncheck.S: Same.
+	* libc/misc/utoa.S: Same.
+	* libc/misc/utoa_ncheck.S: Same.
+	* libc/misc/ultoa.S: Same.
+	* libc/misc/ultoa_ncheck.S: Same.
+
+2014-04-28  Joey Morin <joeymorin@gmail.com>
+
+	Fix for bug #40003: Integer type promotion leads to inefficent code in wdt.h
+	* include/avr/wdt.h (wdt_enable): cast expression to destination type
+
+2014-04-16  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Fix for bug #42084: wrong LFUSE_DEFAULT in iotn84a.h
+	Submitted by ralphdoncaster
+	* include/avr/iotn84a.h: Update LFUSE_DEFAULT as per datasheet.
+
+2014-04-16  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Fix for bug #42085: HFUSE_DEFAULT not defined for iotn84.h
+	Submitted by ralphdoncaster
+	* include/avr/iotn84.h: Rename FUSE_HFUSE_DEFAULT to HFUSE_DEFAULT.
+
+2014-03-31  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	* configure.ac: Add AT90pwm161, ATA5272, ATA5505, ATA5790, ATA5795,
+	ATA6285, ATA6286, ATmega1284, ATmega128A, ATmega164PA, ATmega165PA,
+	ATmega168PA, ATmega3250PA, ATmega325PA, ATmega3290PA, ATmega32A,
+	ATmega48PA, ATmega64A, ATmega8A, ATtiny1634, ATtiny828, ATxmega128A3U,
+	ATxmega128A4U, ATxmega128B1, ATxmega128B3, ATxmega128C3, ATxmega128D4,
+	ATxmega16A4U, ATxmega16C4, ATxmega192A3U, ATxmega192C3, ATxmega256A3BU,
+	ATxmega256A3U, ATxmega256C3, ATxmega32A4U, ATxmega32C4, ATxmega384C3,
+	ATxmega384D3, ATxmega64A3U, ATxmega64A4U, ATxmega64B1, ATxmega64B3,
+	ATxmega64C3, ATxmega64D4 devices.
+	* devtools/gen-avr-lib-tree.sh: Ditto.
+	* devtools/generate_iosym.sh: Ditto.
+	* doc/api/main_page.dox: Document new device support.
+	* doc/api/using-tools.dox: Ditto.
+	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
+	* include/avr/eeprom.h: Add EEPROM definitions for new devices.
+	* include/avr/io.h: Add hooks for new devices.
+	* include/avr/power.h: Add power management definitions for new devices.
+	* include/avr/sleep.h: Add sleep modes for new devices.
+	* include/avr/wdt.h: Add watchdog support for new devices.
+	* include/avr/io90pwm161.h: Newfile.
+	* include/avr/ioa5272.h: Ditto.
+	* include/avr/ioa5505.h: Ditto.
+	* include/avr/ioa5790.h: Ditto.
+	* include/avr/ioa5795.h: Ditto.
+	* include/avr/ioa6285.h: Ditto.
+	* include/avr/ioa6286.h: Ditto.
+	* include/avr/iom1284.h: Ditto.
+	* include/avr/iom128a.h: Ditto.
+	* include/avr/iom164pa.h: Ditto.
+	* include/avr/iom165pa.h: Ditto.
+	* include/avr/iom168pa.h: Ditto.
+	* include/avr/iom3250pa.h: Ditto.
+	* include/avr/iom325pa.h: Ditto.
+	* include/avr/iom3290pa.h: Ditto.
+	* include/avr/iom32a.h: Ditto.
+	* include/avr/iom48pa.h: Ditto.
+	* include/avr/iom64a.h: Ditto.
+	* include/avr/iom8a.h: Ditto.
+	* include/avr/iotn1634.h: Ditto.
+	* include/avr/iotn828.h: Ditto.
+	* include/avr/iox128a3u.h: Ditto.
+	* include/avr/iox128a4u.h: Ditto.
+	* include/avr/iox128b1.h: Ditto.
+	* include/avr/iox128b3.h: Ditto.
+	* include/avr/iox128c3.h: Ditto.
+	* include/avr/iox128d4.h: Ditto.
+	* include/avr/iox16a4u.h: Ditto.
+	* include/avr/iox16c4.h: Ditto.
+	* include/avr/iox192a3u.h: Ditto.
+	* include/avr/iox192c3.h: Ditto.
+	* include/avr/iox256a3bu.h: Ditto.
+	* include/avr/iox256a3u.h: Ditto.
+	* include/avr/iox256c3.h: Ditto.
+	* include/avr/iox32a4u.h: Ditto.
+	* include/avr/iox32c4.h: Ditto.
+	* include/avr/iox384c3.h: Ditto.
+	* include/avr/iox384d3.h: Ditto.
+	* include/avr/iox64a3u.h: Ditto.
+	* include/avr/iox64a4u.h: Ditto.
+	* include/avr/iox64b1.h: Ditto.
+	* include/avr/iox64b3.h: Ditto.
+	* include/avr/iox64c3.h: Ditto.
+	* include/avr/iox64d4.h: Ditto.
+	* crt1/iosym/at90pwm161.S: Ditto.
+	* crt1/iosym/ata5272.S: Ditto.
+	* crt1/iosym/ata5505.S: Ditto.
+	* crt1/iosym/ata5790.S: Ditto.
+	* crt1/iosym/ata5795.S: Ditto.
+	* crt1/iosym/ata6285.S: Ditto.
+	* crt1/iosym/ata6286.S: Ditto.
+	* crt1/iosym/atmega1284.S: Ditto.
+	* crt1/iosym/atmega128a.S: Ditto.
+	* crt1/iosym/atmega164pa.S: Ditto.
+	* crt1/iosym/atmega165pa.S: Ditto.
+	* crt1/iosym/atmega168pa.S: Ditto.
+	* crt1/iosym/atmega3250pa.S: Ditto.
+	* crt1/iosym/atmega325pa.S: Ditto.
+	* crt1/iosym/atmega3290pa.S: Ditto.
+	* crt1/iosym/atmega32a.S: Ditto.
+	* crt1/iosym/atmega48pa.S: Ditto.
+	* crt1/iosym/atmega64a.S: Ditto.
+	* crt1/iosym/atmega8a.S: Ditto.
+	* crt1/iosym/attiny1634.S: Ditto.
+	* crt1/iosym/attiny828.S: Ditto.
+	* crt1/iosym/atxmega128a3u.S: Ditto.
+	* crt1/iosym/atxmega128a4u.S: Ditto.
+	* crt1/iosym/atxmega128b1.S: Ditto.
+	* crt1/iosym/atxmega128b3.S: Ditto.
+	* crt1/iosym/atxmega128c3.S: Ditto.
+	* crt1/iosym/atxmega128d4.S: Ditto.
+	* crt1/iosym/atxmega16a4u.S: Ditto.
+	* crt1/iosym/atxmega16c4.S: Ditto.
+	* crt1/iosym/atxmega192a3u.S: Ditto.
+	* crt1/iosym/atxmega192c3.S: Ditto.
+	* crt1/iosym/atxmega256a3bu.S: Ditto.
+	* crt1/iosym/atxmega256a3u.S: Ditto.
+	* crt1/iosym/atxmega256c3.S: Ditto.
+	* crt1/iosym/atxmega32a4u.S: Ditto.
+	* crt1/iosym/atxmega32c4.S: Ditto.
+	* crt1/iosym/atxmega384c3.S: Ditto.
+	* crt1/iosym/atxmega384d3.S: Ditto.
+	* crt1/iosym/atxmega64a3u.S: Ditto.
+	* crt1/iosym/atxmega64a4u.S: Ditto.
+	* crt1/iosym/atxmega64b1.S: Ditto.
+	* crt1/iosym/atxmega64b3.S: Ditto.
+	* crt1/iosym/atxmega64c3.S: Ditto.
+	* crt1/iosym/atxmega64d4.S: Ditto.
+
+2014-03-21  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Fix for bug #40567: Invalid names in iotn13a.h (EEPE/EEMPE/BODS/BODSE)
+	* include/avr/iotn13a.h: Update EECR bit definitions.
+
+2014-03-21  Morten Engelhardt Olsen <Morten_engelhardt.Olsen@atmel.com>
+
+	* include/avr/iotn13a.h: Rename BODCR register's bit definitions.
+	* include/avr/iotn24a.h: Add BODSE and BODS bits to MCUCR register.
+	Add WDT_vect interrupt vector.
+	* include/avr/iotn44a.h: Add BODSE and BODS bits to MCUCR register.
+	* include/avr/iotn84a.h: Same.
+	* include/avr/iotn167.h: Update PUDB bit definition.
+	* include/avr/iom328p.h: Update High and extended fuse byte definitions.
+
+2014-03-20  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Submitted by Morten Engelhardt Olsen <Morten_engelhardt.Olsen@atmel.com>
+	Fix for bug #35948: iom32u4.h for ATmega32U4 incorrectly defines Timer 2
+	* include/avr/iom32u4.h: Remove timer2 related definitions (TIFR2, TCCR2A,
+	TCCR2B, TCNT2, OCR2A and OCR2B)
+
+2014-03-20  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Submitted by Barnabas Bodnar, Pitchumani Sivanupandi
+	Fix for bug #36053: Declaration of the register USIBR missing for ATtiny 
+	2313a/4313
+	Fix for bug #35971: attiny4313 (2313a) pin-change interrupts PCINT[0...2]
+	vect etc.
+	* include/avr/iotn2313a.h: Add USIBR register and bit definitions.
+	Update bit definitions for UCSRC, GIFR, GIMSK. Add PCMSK0 and GIFR as
+	alias name for PCMSK and EIFR respectively. Add alias names for USART and 
+	PCINT interrupt vectors.
+	* include/avr/iotn4313.h: Same.
+
+2014-03-20  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Submitted by Morten Engelhardt Olsen <Morten_engelhardt.Olsen@atmel.com>
+	Fix for bug #38516: Missing TWI and UCSR1D definitions for ATmega16/32 U4
+	* include/avr/iom16u4.h: Add TWBR,TWSR,TWAR,TWDR,TWCR,TWAMR and UCSR1D
+	register definitions.
+	* include/avr/iom32u4.h: Add UCSR1D regiter and bit definitions.
+
+2014-03-20  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/iom256rfr2.h (PCMSK0_struct): Add missing definition
+	* include/avr/imo128rfr2.h (PCMSK0_struct): (Dito.)
+	* include/avr/iom64rfr2.h (PCMSK0_struct): (Dito.)
+
+2014-03-18  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Submitted by Vishnu KS
+	Fix for bug #40595: iotn2313a.h: wrong fuses definitions for High Fuse Byte
+	* include/avr/iotn2313a.h: Update high fuse byte definitions.
+	* include/avr/iotn4313.h: Same.
+
+2014-03-18  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Submitted by Vishnu KS
+	Fix for bug #41519: wrong SPM_PAGESIZE definition in iotn[48]8.h
+	* include/avr/iotn48.h: update SPM_PAGESIZE to 64
+	* include/avr/iotn88.h: Same.
+
+2014-03-17  Pitchumani Sivanupandi <pitchumani.s@atmel.com> 
+
+	* include/avr/iox64d3.h (PR_struct): Remove PRPB.
+	(CRC_struct): Add CRC definitions.
+	Remove incorrect PR definitions.
+	* include/avr/iox128d3.h: Same.
+	* include/avr/iox192d3.h: Same.
+	* include/avr/iox256d3.h (PR_struct): Add power reduction definitions.
+	(CRC_struct): Add CRC definitions.
+	Add PR and CRC macro definitions.
+	* include/avr/power.h: Add power reduction macro docs and update power
+	reduction macro definitions for xmega64/128/192/256 D3 devices.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2015 avr-libc-r2546/ChangeLog-2015
--- avr-libc-2.0.0-orig/ChangeLog-2015	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2015	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,299 @@
+2015-11-26  Morten Engelhardt Olsen <Morten_engelhardt.Olsen@atmel.com>
+
+	patch #8810: Fix LFUSE_DEFAULT for tiny24a/44a
+	* inclue/avr/iotn24a.h: Add missing FUSE_CKSEL3 to LFUSE_DEFAULT
+	definition.
+	* include/avr/iotn44a.h: Likewise.
+
+2015-10-07  Mike Rice <mike@mikerice.name>
+	bug #36303: Wrong hour for EU Summertime
+	* include/util/eu_dst.h: Corrected hour to 2 AM UTC
+
+2015-10-07  Georg-Johann Lay <avr@gjlay.de>
+
+	patch #8556: Fix atexit.c
+	* libc/stdlib/atexit.c (__atexit_fini): Rename to...
+	(atexit_fini): ...this.  Make static, naked, and used.
+	Move to section .fini8.  Outsource worker code to...
+	(atexit_finido): ...this new function.
+	(atexit_p): Renamed from __atexit_p.  Make static.
+
+2015-10-06  Georg-Johann Lay <avr@gjlay.de>
+
+	patch #8728: Use __extension__ with long long
+	* include/stdio.h: Use __extension__ when using long long.
+
+2015-10-06  Joern Rennecke <joern.rennecke@embecosm.com>
+
+	patch #8564: Add dwarf debug info alternative, build printf with debug info
+	* configure.ac (--enable-debug-info=): Add dwarf alternative.
+	* libc/stdio/Rules.am (PRINTF_CFLAGS): Add @CDEBUG@.
+
+2015-10-06  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8731: Header file for atmega644a
+	* include/avr/io.h: include new header iom644a.h for ATmega644A.
+	* include/avr/Makefile.am (avr_HEADERS): add iom644a.h.
+	* include/avr/iom644a.h: New file.
+
+2015-08-20  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8718: Enable EEPROM memory map only for devices with
+	EEPROM Data Memory Mapping Enable bit (EEMAPEN)
+	* libc/misc/eerd_byte.S (eeprom_read_byte): Enable EEPROM map
+	only when NVM_EEMAPEN_bm is defined.
+	* libc/misc/eerd_block.S (eeprom_read_block): Likewise.
+	* libc/misc/eewr_byte.S (eeprom_write_byte): Likewise.
+	* libc/misc/readme_eeprom.txt: Update comments for default EEPROM map.
+
+2015-08-17  Praveen Kumar Kaushik
+            Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8716: Enable setjmp/longjmp functions for AVR_TINY architecture
+	* include/setjmp.h (_JBLEN): Update for AVR_TINY arch conditionally.
+	* libc/stdlib/setjmp.S: Enable setjmp and longjmp for AVR_TINY
+	(setjmp, longjmp): Update call-saved registers for AVR_TINY
+
+2015-08-06  Morten Engelhardt Olsen <Morten_engelhardt.Olsen@atmel.com>
+
+	Fix typos and incorrect defines in header files.
+	* include/avr/io90pwm216.h: corrted typo in comment.
+	* include/avr/iousbxx6_7.h: Add ADHSM bit definition to ADCSRB.
+	* include/avr/iom165a.h: Remove BODSE and BODS.
+	* include/avr/io2323.h: Move sleep mode definitions to correct place.
+	* include/avr/io90pwm316.h: corrected typo in comment.
+	(PIM1): Add pin definitions.
+	* include/avr/iom16a.h: Add SPI_STC_vect. Keep old name for backward
+	compatibility.
+	* include/avr/iom324.h: Remove duplicate sleep mode definitions.
+	* include/avr/iotn861a.h (PWM1X): Define.
+
+2015-08-06  Morten Engelhardt Olsen <Morten_engelhardt.Olsen@atmel.com>
+
+	* include/avr/iox32a4.h: Renamed member LOCKBITS to LOCK_BITS.
+	(ADC_CH_MUXPOS_enum): Add missed pinmux positions.
+	* include/avr/iox32d4.h: Likewise.
+	* include/avr/iox16a4.h: Likewise.
+	* include/avr/iox16d4.h: Likewise.
+	(ADC_CH_MUXNEG_enum): correct pinmux values.
+	* include/avr/iox128a1.h: Renamed member LOCKBITS to LOCK_BITS.
+	* include/avr/iox128a3.h: Likewise.
+	* include/avr/iox128d3.h: Likewise.
+	* include/avr/iox192a3.h: Likewise.
+	* include/avr/iox192d3.h: Likewise.
+	* include/avr/iox256a3.h: Likewise.
+	* include/avr/iox256a3b.h: Likewise.
+	* include/avr/iox256d3.h: Likewise.
+	* include/avr/iox64a1.h: Likewise.
+	* include/avr/iox64a3.h: Likewise.
+	* include/avr/iox64d3.h: Likewise.
+
+2015-07-29  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+    * include/avr/wdt.h: Fix typo in documentation.
+
+2015-07-22  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #45551: Power-save mode not supported for ATtiny167
+	* include/avr/iotn167.h (SLEEP_MODE_PWR_SAVE): Define for power save
+	sleep mode.
+
+2015-07-22  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #45539: iom32u4.h defines reserved IO address (TIMSK2 (0x70),
+	TIMSK5 (0x73) etc)
+	* include/avr/iom32u4.h: Remove defines for reserved IO
+	register addresses.
+
+2015-06-22  Jethro <jethro.donaldson@gmail.com>
+            Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #44977: Incorrect PORT_t and CRC_t definitions for ATxmega64A1U
+	and 128A1U
+	bug #44279: incorrect USB_TRNCOMPL_vect_num in iox64a1u.h, iox128a1u.h
+	* include/avr/iox64a1u.h (CRC_t): Add reserved slot as member.
+	(PORT_t): Add member for REMAP.
+	(NVM_EE_vect, NVM_SPM_vect,USB_TRNCOMPL_vect): Update vector number.
+	(_VECTORS_SIZE): Update size.
+	* include/avr/iox128a1u.h: Likewise.
+
+2015-06-19  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #43011: Bug in struct definition of __reg_UCSR1C and
+	__reg_UCSR0C in iom128rfa1.h
+	* include/avr/iom128rfa1.h (struct __reg_UCSR0C, struct __reg_UCSR1C):
+	Remove SPI mode only bitfields.
+	(UCPHA0,UDORD0,UCPHA1,UDORD1): Remove duplicates.
+
+2015-06-18  Georg-Johann Lay <avr@gjlay.de>
+            Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #43828: wdt.h: Wrong inline assembler arguments
+	* include/avr/wdt.h (wdt_enable/wdt_disable): Update constraints for
+	inline asm operands
+
+2015-05-07  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #44869: trunk doesn't work with gcc 5.1.0-RC-20150412
+	* configure.ac (HAS_GCC_5_1): Define if avr-gcc version is 5.1.0
+	(--enable-device-lib): Add configure option.
+	(HAS_DEV_LIB): Define if enabled by --enable-device-lib or avr-gcc
+	version is >= 5.1.0.
+	* devtools/Device.am (AVR_TARGET_CRT, AVR_INSTALL_DIR): Define
+	based on avr-gcc version.
+	(avr_LIBRARIES): Likewise.
+	* devtools/gen-avr-lib-tree.sh: Use old crt name.
+	* libc/Makefile.am: Include misc sub-directory if device library is
+	not enabled.
+	* libc/misc/Rules.am: Include eeprom function name mangling if device
+	library is not enabled.
+
+2015-04-15  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #44574: Place device-specific libraries in their multilib directory.
+	* configure.ac (AC_CONFIG_FILES): Replace dev directory with architecture
+	directory where device specific lib (lib<device>.a) and startup object
+	file (crt<device>.o) to be installed.
+	* devtools/Devices.am (avr_LIBRARIES): Change device library name to
+	lib<device>.a.
+	* devtools/gen-avr-lib-tree.sh (AVR12_DEV_INFO): Remove tiny stack devices
+	as they are part of AVR12TS_DEV_INFO.
+	(AVR25_DEV_INFO): Ditto.
+	Change startup object file name to crt<device>.o and install location to
+	multilib (architecture) directory.
+
+2015-04-08  Martin Nowak <code@dawg.eu>
+            Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #33698: Explicit use of RJMP/RCALL can cause "relocation truncated
+	to fit: R_AVR_13_PCREL" linker error
+	* common/macros.inc: Use __AVR_HAVE_JMP_CALL__ instead of __AVR_MEGA__
+	to define XJMP/XCALL macros.
+	* libm/fplib/asmdef.h: Define XJMP and XCALL with rjmp/rcall or jmp/call
+	based on jmp/call instruction availability.
+	* libc/stdlib/ctype.S: Use XJMP/XCALL instead of explicit rjmp/rcall for
+	external functions.
+	* libm/fplib/acos.S: Ditto.
+	* libm/fplib/addsf3.S: Ditto.
+	* libm/fplib/addsf3x.S: Ditto.
+	* libm/fplib/asin.S: Ditto.
+	* libm/fplib/atan.S: Ditto.
+	* libm/fplib/atan2.S: Ditto.
+	* libm/fplib/cbrt.S: Ditto.
+	* libm/fplib/ceil.S: Ditto.
+	* libm/fplib/cmpsf2.S: Ditto.
+	* libm/fplib/cos.S: Ditto.
+	* libm/fplib/cosh.S: Ditto.
+	* libm/fplib/divsf3.S: Ditto.
+	* libm/fplib/divsf3x.S: Ditto.
+	* libm/fplib/exp.S: Ditto.
+	* libm/fplib/fdim.S: Ditto.
+	* libm/fplib/fixsfdi.S: Ditto.
+	* libm/fplib/fixsfsi.S: Ditto.
+	* libm/fplib/fixunssfsi.S: Ditto.
+	* libm/fplib/floatdisf.S: Ditto.
+	* libm/fplib/floor.S: Ditto.
+	* libm/fplib/fma.S: Ditto.
+	* libm/fplib/fmod.S: Ditto.
+	* libm/fplib/fp_arccos.S: Ditto.
+	* libm/fplib/fp_powser.S: Ditto.
+	* libm/fplib/fp_powsodd.S: Ditto.
+	* libm/fplib/fp_rempio2.S: Ditto.
+	* libm/fplib/fp_sinus.S: Ditto.
+	* libm/fplib/fp_trunc.S: Ditto.
+	* libm/fplib/frexp.S: Ditto.
+	* libm/fplib/gesf2.S: Ditto.
+	* libm/fplib/hypot.S: Ditto.
+	* libm/fplib/inverse.S: Ditto.
+	* libm/fplib/isinf.S: Ditto.
+	* libm/fplib/isnan.S: Ditto.
+	* libm/fplib/ldexp.S: Ditto.
+	* libm/fplib/log.S: Ditto.
+	* libm/fplib/log10.S: Ditto.
+	* libm/fplib/lrint.S: Ditto.
+	* libm/fplib/lround.S: Ditto.
+	* libm/fplib/modf.S: Ditto.
+	* libm/fplib/mulsf3.S: Ditto.
+	* libm/fplib/mulsf3x.S: Ditto.
+	* libm/fplib/pow.S: Ditto.
+	* libm/fplib/round.S: Ditto.
+	* libm/fplib/sin.S: Ditto.
+	* libm/fplib/sinh.S: Ditto.
+	* libm/fplib/sqrt.S: Ditto.
+	* libm/fplib/square.S: Ditto.
+	* libm/fplib/tan.S: Ditto.
+	* libm/fplib/tanh.S: Ditto.
+	* libm/fplib/trunc.S: Ditto.
+	* libm/fplib/unordsf2.S: Ditto.
+
+2015-03-18  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	bug #44514: Wrong build option '-mtiny-stack' instead of '-msp8'
+	* devtools/gen-avr-lib-tree.sh (CFLAGS_TINY_STACK): Change
+	-mtiny-stack to -msp8.
+
+2015-03-18  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	bug #43044: memory sections require __attribute__ ((used))
+	* doc/api/sections.dox: Add __attribute__ ((used)) and
+	a brief explanation of why it is needed.
+
+2015-03-09  Georg-Johann Lay <avr@gjlay.de>
+
+	bug #34719: Check for right build compiler
+	* configure.ac (CC): Use `${CC} -dumpmachine` to query for
+	right cross compiler instead of checking CC.
+
+2015-03-09  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	bug #44140: wdt_disable() macro clobbers prescaller bits ...
+	* include/avr/wdt.h (wdt_disable): Add WD reset before changing.
+	Prescaler bits are not overwritten while setting WDCE and WDE.
+
+2015-02-25  Joern Rennecke  <joern.rennecke@embecosm.com>
+            Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	Patch #8610: Remove eeprom function name mangling
+	* include/avr/eeprom.h: Remove _EEPROM_SUFFIX definition and eeprom
+	function name mangling.
+	(EEARL): define with EEAR.
+	* libc/misc/eedef.h: Remove eeprom function name mangling.
+
+2015-02-23  Joern Rennecke  <joern.rennecke@embecosm.com>
+
+    Patch #8587: Move device specific functions to libdev.a
+	* configure.ac: (AC_CONFIG_FILES): Place all devices under avr/lib/dev.
+	Remove device duplicates. Remove device specific lib for tiny-stack.
+	* devtools/Device.am (VPATH): Add $(top_srcdir)/libc/misc.
+	($(top_srcdir)/libc/misc/Rules.am): Include.
+	(avr_LIBRARIES, libdev_a_SOURCES): New library.
+	* devtools/gen-avr-lib-tree.sh (AVR12_DEV_INFO): Remove duplicate devices.
+	(AVR3_DEV_INFO, AVR31_DEV_INFO): Likewise.
+	Place all devices under avr/lib/dev.
+	* libc/misc/Rules.am: Remove eeprom file name mangling.
+
+2015-02-23  Joern Rennecke  <joern.rennecke@embecosm.com>
+		    Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	patch #8565:
+	* include/avr/io.h: Use __AVR_DEV_LIB_NAME__ as a fallback.
+
+2015-02-05  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+            Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+    * include/avr/wdt.h: Add conditional branch to enable/disable wdt
+    for devices that has CCP.
+
+2015-01-06  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/avr/iox128a3.h: Fix an obvious long-standing
+	typo: TC_EVACT_FRQ_gc was misspelled as TC_EVACT_FRW_gc
+	(keep old name for backwards compatibility anyway)
+	* include/avr/iox16a4.h: (Dito.)
+	* include/avr/iox16d4.h: (Dito.)
+	* include/avr/iox192a3.h: (Dito.)
+	* include/avr/iox256a3b.h: (Dito.)
+	* include/avr/iox256a3.h: (Dito.)
+	* include/avr/iox32a4.h: (Dito.)
+	* include/avr/iox32d4.h: (Dito.)
+	* include/avr/iox64a3.h: (Dito.)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/ChangeLog-2016 avr-libc-r2546/ChangeLog-2016
--- avr-libc-2.0.0-orig/ChangeLog-2016	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/ChangeLog-2016	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,321 @@
+2016-11-29  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #9163: New eeprom write block function for xmega
+	* devtools/Device.am: Add new files.
+	* devtools/gen-avr-libc-tree.sh: Avoid c files for assembler only devices.
+	* include/avr/cpufunc.h (ccp_write_io): Add new function.
+	* libc/misc/Files.am (eeprom_c_sources): Add new file.
+	(dev_asm_sources): Likewise.
+	* libc/misc/Makefile.am: Likewise.
+	* libc/misc/ccp_write.S: New file for function ccp_write_io.
+	* libc/misc/eewr_block.S: Skip definition for Xmega devices as new
+	definition is from eewr_block_xmega.c.
+	* libc/misc/eewr_block_xmega.c: New file for function eeprom_write_block
+	for xmega devices with eeprom pages.
+
+2016-10-27  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Fix for bug #49447: Example code for uart_putchar() has error in recursive call
+	* include/stdio.h: Add 2nd "stream" parameter in example code
+
+2016-10-19  azudem
+
+	Fix for bug #41689: add static_assert to assert.h
+	* include/assert.h (static_assert): Define if C11 std or >= gcc-4.6 used.
+
+2016-09-15  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Fix for bug ##48898: power_usart3_* functions no more defined in power.h
+	* include/avr/power.h (__AVR_HAVE_PRR_PRSCR): Change to
+	__AVR_HAVE_PRR_PRPSCR.
+	(power_lfrs_enable): define if __AVR_HAVE_PRR0_PRLFRS is present.
+	(power_twi1_enable): define if __AVR_HAVE_PRR0_PRTWI1 is present.
+	(power_lfph_enable): define if __AVR_HAVE_PRR1_PRLFPH is present.
+	(power_lftp_enable): define if __AVR_HAVE_PRR1_PRLFTP is present.
+	(power_spi_enable): define if __AVR_HAVE_PRR1_PRSPI is present.
+	(power_usart3_enable): define if __AVR_HAVE_PRR1_PRUSART3 is present.
+	(power_spi2_enable): define if __AVR_HAVE_PRR2_PRSPI2 is present.
+	(power_twi2_enable): define if __AVR_HAVE_PRR2_PRTWI2 is present.
+
+2016-09-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Fix for bug #49020: dtostre() flags documentation error
+	* include/stdlib.h: Fix documentation of dtostre() flags.
+
+2016-08-14  Aurelien Jarno  <aurelien@aurel32.net>
+
+	Fix for bug #36933: Documentation no longer correctly describes how to
+	declare strings for storage in program memory
+	* doc/api/pgmspace.dox: Add const keyword to variables in PROGMEM
+	section.
+
+2016-04-04  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8964: Update tests
+	* tests/simulate/math/isinf-01.c: Update test condition as the expected
+	value of isinf is non-zero in case of argument is infinite.
+	* tests/simulate/math/signbit-01.c: Likewise for signbit function.
+	* tests/simulate/math/modf-np.c: Update test to use avr-libc's modf
+	function.
+
+2016-04-04  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8961: Update test script
+	* tests/simulate/runtest.sh (Simulate): Do not generate bin file.
+	Change exit address from byte to word address. Update options and add
+	timeout parameter when invoking simulavr.
+	(Compile): Auto detect multilib and CRT filename. Add device library
+	to libraries list.
+
+2016-03-17  Senthil Kumar Selvaraj <senthil_kumar.selvaraj@atmel.com>
+
+	* crt1/gcrt1.S: Weakly define __FUSE_REGION_LENGTH__.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Post-release 2.0.0.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Release version 2.0.0.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* include/stdlib.h: Move all documentation from assembly code
+	files into the header files, so Doxygen will pick it up.
+	* include/string.h: (Dito.)
+	* libc/stdlib/atof.S: (Dito.)
+	* libc/string/ffs.S: (Dito.)
+	* libc/string/ffsl.S: (Dito.)
+	* libc/string/ffsll.S: (Dito.)
+	* libc/string/memccpy.S: (Dito.)
+	* libc/string/memchr.S: (Dito.)
+	* libc/string/memcmp.S: (Dito.)
+	* libc/string/memcpy.S: (Dito.)
+	* libc/string/memmem.S: (Dito.)
+	* libc/string/memmove.S: (Dito.)
+	* libc/string/memrchr.S: (Dito.)
+	* libc/string/memset.S: (Dito.)
+	* libc/string/strcasecmp.S: (Dito.)
+	* libc/string/strcasestr.S: (Dito.)
+	* libc/string/strcat.S: (Dito.)
+	* libc/string/strchr.S: (Dito.)
+	* libc/string/strchrnul.S: (Dito.)
+	* libc/string/strcmp.S: (Dito.)
+	* libc/string/strcpy.S: (Dito.)
+	* libc/string/strcspn.S: (Dito.)
+	* libc/string/strdup.c: (Dito.)
+	* libc/string/strlcat.S: (Dito.)
+	* libc/string/strlcpy.S: (Dito.)
+	* libc/string/strlen.S: (Dito.)
+	* libc/string/strlwr.S: (Dito.)
+	* libc/string/strncasecmp.S: (Dito.)
+	* libc/string/strncat.S: (Dito.)
+	* libc/string/strncmp.S: (Dito.)
+	* libc/string/strncpy.S: (Dito.)
+	* libc/string/strnlen.S: (Dito.)
+	* libc/string/strpbrk.S: (Dito.)
+	* libc/string/strrchr.S: (Dito.)
+	* libc/string/strrev.S: (Dito.)
+	* libc/string/strsep.S: (Dito.)
+	* libc/string/strspn.S: (Dito.)
+	* libc/string/strstr.S: (Dito.)
+	* libc/string/strtok.c: (Dito.)
+	* libc/string/strtok_r.S: (Dito.)
+	* libc/string/strupr.S: (Dito.)
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/rel-method.dox: Mention major number 2.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/overview.dox: Remove obsolete sentence claiming
+	SimulAVR were unmaintained.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* configure.ac: Bump version to 2.0.0, in preparation of the
+	upcoming release.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/dox_html_header: Drop the alphabetical index from the
+	top bar, as it does not work as expected when setting
+	DISABLE_INDEX in the config file (it only yielded the very first
+	index block, i.e. names starting with an underscore). Since
+	there's now a search field, the value of the index is questionable
+	anyway.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/doxygen.config.in (MARKDOWN_SUPPORT): Turn off markdown
+	support, as it clashes with the use of __FOO__-style macro names.
+	* include/util/delay.h.in: Rephrase and reformat the documentation
+	of _delay_ms() and _delay_us().  This fixes the remaining doxygen
+	warnings.
+
+2016-02-08  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/main_page.dox: Update copyright year.
+
+2016-02-07  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	Fix most of the doxygen warnings.
+	* doc/examples/asmdemo/asmdemo.dox: (Dito.)
+	* include/avr/boot.h: (Dito.)
+	* include/avr/fuse.h: (Dito.)
+	* include/avr/lock.h: (Dito.)
+	* include/avr/pgmspace.h: (Dito.)
+	* include/avr/power.h: (Dito.)
+	* include/avr/sleep.h: (Dito.)
+	* include/avr/wdt.h: (Dito.)
+	* include/errno.h: (Dito.)
+	* include/math.h: (Dito.)
+	* include/setjmp.h: (Dito.)
+	* include/stdint.h: (Dito.)
+	* include/stdio.h: (Dito.)
+	* include/stdlib.h: (Dito.)
+	* include/string.h: (Dito.)
+	* include/time.h: (Dito.)
+	* include/util/delay.h.in: (Dito.)
+	* libc/pmstring/memchr_P.S: (Dito.)
+	* libc/pmstring/memcmp_P.S: (Dito.)
+	* libc/pmstring/memcmp_PF.S: (Dito.)
+	* libc/pmstring/memcpy_P.S: (Dito.)
+	* libc/pmstring/memcpy_PF.S: (Dito.)
+	* libc/pmstring/memrchr_P.S: (Dito.)
+	* libc/pmstring/strcasecmp_P.S: (Dito.)
+	* libc/pmstring/strcasecmp_PF.S: (Dito.)
+	* libc/pmstring/strcat_P.S: (Dito.)
+	* libc/pmstring/strcat_PF.S: (Dito.)
+	* libc/pmstring/strchr_P.S: (Dito.)
+	* libc/pmstring/strchrnul_P.S: (Dito.)
+	* libc/pmstring/strcmp_P.S: (Dito.)
+	* libc/pmstring/strcmp_PF.S: (Dito.)
+	* libc/pmstring/strcpy_P.S: (Dito.)
+	* libc/pmstring/strcpy_PF.S: (Dito.)
+	* libc/pmstring/strcspn_P.S: (Dito.)
+	* libc/pmstring/strlcat_P.S: (Dito.)
+	* libc/pmstring/strlcat_PF.S: (Dito.)
+	* libc/pmstring/strlcpy_P.S: (Dito.)
+	* libc/pmstring/strlcpy_PF.S: (Dito.)
+	* libc/pmstring/strlen_P.S: (Dito.)
+	* libc/pmstring/strlen_PF.S: (Dito.)
+	* libc/pmstring/strncasecmp_P.S: (Dito.)
+	* libc/pmstring/strncasecmp_PF.S: (Dito.)
+	* libc/pmstring/strncat_P.S: (Dito.)
+	* libc/pmstring/strncat_PF.S: (Dito.)
+	* libc/pmstring/strncmp_P.S: (Dito.)
+	* libc/pmstring/strncmp_PF.S: (Dito.)
+	* libc/pmstring/strncpy_P.S: (Dito.)
+	* libc/pmstring/strncpy_PF.S: (Dito.)
+	* libc/pmstring/strnlen_P.S: (Dito.)
+	* libc/pmstring/strnlen_PF.S: (Dito.)
+	* libc/pmstring/strpbrk_P.S: (Dito.)
+	* libc/pmstring/strrchr_P.S: (Dito.)
+	* libc/pmstring/strsep_P.S: (Dito.)
+	* libc/pmstring/strspn_P.S: (Dito.)
+	* libc/pmstring/strstr_P.S: (Dito.)
+	* libc/pmstring/strstr_PF.S: (Dito.)
+	* libc/pmstring/strtok_P.c: (Dito.)
+	* libc/pmstring/strtok_rP.S: (Dito.)
+	* libc/stdlib/atexit.c: (Dito.)
+	* libc/string/memccpy.S: (Dito.)
+	* libc/string/memmem.S: (Dito.)
+	* libc/string/strcasestr.S: (Dito.)
+	* libc/string/strtok.c: (Dito.)
+
+2016-02-06  Joerg Wunsch <j.gnu@uriah.heep.sax.de>
+
+	* doc/api/doxygen.config.in: Update doxygen infrastructur to Doxygen 1.8.7
+	* doc/api/dox.css: Ditto.
+	* doc/api/dox_html_footer: Ditto.
+	* doc/api/dox_html_header: Ditto.
+
+2016-02-05  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	patch #8902: Xmega's PROTECTED_WRITE is incorrect for IO registers
+	whose address is more than one byte
+	* include/avr/xmega.h (_PROTECTED_WRITE): Update constraint for
+	IO register to allow more than 1 byte address. Cast CCP signature and
+	value to be written to avoid un-optimal load.
+
+2016-01-28  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Added new devices.
+	* configure.ac: Add ATA5702M322, ATA5782, ATA5790N, ATA5831, ATA6613C,
+	ATA6614Q, ATmega64HVE2, ATxmega8E5, ATxmega32C3, ATxmega32D3
+	and ATxmega32E5 devices.
+	* devtools/gen-avr-lib-tree.sh: Likewise.
+	* devtools/iosym/Makefile.am: Add assembly macro files for new devices.
+	* doc/api/main_page.dox: Document new device support.
+	* doc/api/using-tools.dox: Likewise.
+	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
+	* include/avr/io.h: Add hooks for new devices.
+	* include/avr/ioa5702m322.h: New device header file.
+	* include/avr/ioa5782.h: Ditto.
+	* include/avr/ioa5790n.h: Ditto.
+	* include/avr/ioa5831.h: Ditto.
+	* include/avr/ioa6613c.h: Ditto.
+	* include/avr/ioa6614q.h: Ditto.
+	* include/avr/iom64hve2.h: Ditto.
+	* include/avr/iox32c3.h: Ditto.
+	* include/avr/iox32d3.h: Ditto.
+	* include/avr/iox32e5.h: Ditto.
+	* include/avr/iox8e5.h: Ditto.
+	* crt1/iosym/ata5702m322.S: Generated.
+	* crt1/iosym/ata5782.S: Ditto.
+	* crt1/iosym/ata5790n.S: Ditto.
+	* crt1/iosym/ata5831.S: Ditto.
+	* crt1/iosym/ata6613c.S: Ditto.
+	* crt1/iosym/ata6614q.S: Ditto.
+	* crt1/iosym/atmega64hve2.S: Ditto.
+	* crt1/iosym/atxmega32c3.S: Ditto.
+	* crt1/iosym/atxmega32d3.S: Ditto.
+	* crt1/iosym/atxmega32e5.S: Ditto.
+	* crt1/iosym/atxmega8e5.S: Ditto.
+
+2016-01-28  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	Fixed distcheck errors.
+	* crt1/iosym/Makefile.am (EXTRA_DIST): Add missed device files.
+	* devtools/Device.am: Donot distribute libdev and lib<dev> sources.
+	* libc/Makefile.am (DIST_SUBDIRS): Add misc directory for distribution.
+
+2016-01-25  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	* configure.ac: Add ATA6612C, ATA6617C, ATA664251, ATmega48PB and
+	ATmega88PB devices.
+	* devtools/gen-avr-lib-tree.sh: Likewise.
+	* devtools/generate_iosym.sh: Likewise.
+	* doc/api/main_page.dox: Document new device support.
+	* doc/api/using-tools.dox: Likewise.
+	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
+	* include/avr/io.h: Add hooks for new devices.
+	* include/avr/ioa6612c.h: Newfile.
+	* include/avr/ioa6617c.h: Ditto.
+	* include/avr/ioa664251.h: Ditto.
+	* include/avr/iom48pb.h: Ditto.
+	* include/avr/iom88pb.h: Ditto.
+	* crt1/iosym/ata6612c.S: Generated.
+	* crt1/iosym/ata6617c.S: Ditto.
+	* crt1/iosym/ata664251.S: Ditto.
+	* crt1/iosym/atmega48pb.S: Ditto.
+	* crt1/iosym/atmega88pb: Ditto.
+
+2016-01-25  Pitchumani Sivanupandi <pitchumani.s@atmel.com>
+
+	* configure.ac: Add ATA6616C, ATtiny441 and ATtiny841 devices.
+	* devtools/gen-avr-lib-tree.sh: Likewise.
+	* devtools/generate_iosym.sh: Likewise.
+	* doc/api/main_page.dox: Document new device support.
+	* doc/api/using-tools.dox: Likewise.
+	* include/avr/Makefile.am (avr_HEADERS): Add new header files.
+	* include/avr/io.h: Add hooks for new devices.
+	* include/avr/ioa6616c.h: Newfile.
+	* include/avr/iotn441.h: Ditto.
+	* include/avr/iotn841.h: Ditto.
+	* crt1/iosym/ata6616c.S: Generated.
+	* crt1/iosym/attiny441.S: Ditto.
+	* crt1/iosym/attiny841.S: Ditto.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/common/asmdef.h avr-libc-r2546/common/asmdef.h
--- avr-libc-2.0.0-orig/common/asmdef.h	2010-11-09 22:39:38.000000000 +0300
+++ avr-libc-r2546/common/asmdef.h	2018-05-22 08:51:53.000000000 +0400
@@ -26,7 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: asmdef.h 2191 2010-11-05 13:45:57Z arcanum $	*/
+/* $Id: asmdef.h 2542 2017-06-12 22:08:58Z joerg_wunsch $	*/
 
 #ifndef	_ASMDEF_H
 #define _ASMDEF_H
@@ -206,6 +206,25 @@
 #endif
 .endm
 
+/* Macro 'X_sbiw' extends SBIW instruction for AVR_TINY chips. */
+.macro	X_sbiw	dst,val
+#if !defined (__AVR_TINY__)
+	sbiw	\dst,\val
+#else
+  REGNO	.L__sbiw_dst, \dst
+  .if	.L__sbiw_dst < 0
+    .exitm
+  .endif
+  .if	.L__sbiw_dst % 1
+    .err	; Invalid register arg in X_sbiw macro.
+    .exitm
+  .endif
+
+	subi	.L__sbiw_dst, \val
+	sbci	.L__sbiw_dst + 1, 0
+#endif /* AVR_TINY */
+.endm
+
 /* Macro 'X_lpm' extends enhanced lpm instruction for classic chips.
    Usage:
 	X_lpm	reg, dst
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/common/macros.inc avr-libc-r2546/common/macros.inc
--- avr-libc-2.0.0-orig/common/macros.inc	2016-01-25 22:25:13.000000000 +0300
+++ avr-libc-r2546/common/macros.inc	2018-05-22 08:51:53.000000000 +0400
@@ -225,6 +225,45 @@
 	.endif
 .endm
 
+
+.macro  X_sbiw dst val
+	.L_sbiw_dst = -1
+	.L_sbiw_n = 24
+	.irp  reg,	r24,r26,r28,r30
+		.ifc  \reg,\dst
+			.L_sbiw_dst = .L_sbiw_n
+		.endif
+		.L_sbiw_n = .L_sbiw_n + 2
+	.endr
+	.L_sbiw_n = 24
+	.irp  reg,	R24,R26,R28,R30
+		.ifc  \reg,\dst
+			.L_sbiw_dst = .L_sbiw_n
+		.endif
+		.L_sbiw_n = .L_sbiw_n + 2
+	.endr
+	.if   .L_sbiw_dst < 0
+		.L_sbiw_n = 24
+		.rept   4
+			.if \dst == .L_sbiw_n
+				.L_sbiw_dst = .L_sbiw_n
+			.endif
+			.L_sbiw_n = .L_sbiw_n + 2
+		.endr
+	.endif
+	.if   (.L_sbiw_dst < 0)
+		.err    ; Invalid 'X_sbiw' arg.
+	.endif
+
+#if !defined (__AVR_TINY__)
+	sbiw    \dst, \val
+#else
+	subi    (.L_sbiw_dst), \val
+	sbci    (.L_sbiw_dst)+1, 0
+#endif
+.endm
+
+
 /* Macro 'X_lpm' extends enhanced lpm instruction for classic chips.
    Usage:
 	X_lpm	reg, dst
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/configure.ac avr-libc-r2546/configure.ac
--- avr-libc-2.0.0-orig/configure.ac	2016-02-09 00:07:49.000000000 +0300
+++ avr-libc-r2546/configure.ac	2018-05-22 08:51:56.000000000 +0400
@@ -30,7 +30,7 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 #
-# $Id: configure.ac 2512 2016-02-08 21:07:48Z joerg_wunsch $
+# $Id: configure.ac 2544 2017-08-04 08:50:27Z pitchumani $
 #
 # Process this file with autoconf to produce a configure script.
 #
@@ -40,8 +40,8 @@
 m4_define([avr_libc_major],    [2])dnl           major version
 m4_define([avr_libc_minor],    [0])dnl           minor version
 m4_define([avr_libc_revision], [0])dnl           revision (dot-dot version)
-m4_define([avr_libc_revision_suffix], [])dnl     revision suffix (if any)
-m4_define([avr_libc_reldate],  [20150208])dnl    release date
+m4_define([avr_libc_revision_suffix], [svn])dnl  revision suffix (if any)
+m4_define([avr_libc_reldate],  [20150209])dnl    release date
 dnl end of library versioning data
 
 m4_define([avr_libc_version],
@@ -54,7 +54,7 @@
 AC_INIT(avr-libc, avr_libc_version, avr-libc-dev@nongnu.org)
 
 AC_PREREQ(2.59)
-AC_REVISION($Revision: 2512 $)
+AC_REVISION($Revision: 2544 $)
 
 AC_CONFIG_SRCDIR([doc/examples/demo/demo.c])
 AC_CONFIG_HEADER([config.h])
@@ -1124,6 +1124,11 @@
 AM_CONDITIONAL(HAS_atxmega32e5, test "x$HAS_atxmega32e5" = "xyes")
 
 
+# avrxmega3
+CHECK_AVR_DEVICE(avrxmega3)
+AM_CONDITIONAL(HAS_avrxmega3, test "x$HAS_avrxmega3" = "xyes")
+
+
 # avrxmega4
 CHECK_AVR_DEVICE(avrxmega4)
 AM_CONDITIONAL(HAS_avrxmega4, test "x$HAS_avrxmega4" = "xyes")
@@ -1571,6 +1576,16 @@
 	avr/lib/avrxmega2/atxmega32e5/Makefile
 ])
 
+# avrxmega3
+AC_CONFIG_FILES([
+	avr/lib/avrxmega3/Makefile
+])
+
+# avrxmega3/short-calls
+AC_CONFIG_FILES([
+	avr/lib/avrxmega3/short-calls/Makefile
+])
+
 # avrxmega4
 AC_CONFIG_FILES([
 	avr/lib/avrxmega4/Makefile
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/crt1/gcrt1.S avr-libc-r2546/crt1/gcrt1.S
--- avr-libc-2.0.0-orig/crt1/gcrt1.S	2016-01-25 22:25:13.000000000 +0300
+++ avr-libc-r2546/crt1/gcrt1.S	2018-05-22 08:52:02.000000000 +0400
@@ -29,7 +29,7 @@
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: gcrt1.S 2459 2014-11-21 05:32:39Z saaadhu $ */
+/* $Id: gcrt1.S 2519 2016-03-17 12:11:50Z saaadhu $ */
 
 #if (__GNUC__ < 3) || (__GNUC__ == 3 && __GNUC_MINOR__ < 3)
 #error "GCC version >= 3.3 required"
@@ -372,3 +372,12 @@
 .L__desc_end:
     .balign 4
 
+  /* Set REGION_LENGTH symbol values for well known memory regions.
+  The default linker script uses these symbols to set MEMORY 
+  region lengths, and by defining these here, the linker can detect
+  memory overflows accurately on a per device basis, since the 
+  values are picked up from the device header file.
+  */
+
+  .weak __FUSE_REGION_LENGTH__
+  .set __FUSE_REGION_LENGTH__, FUSE_MEMORY_SIZE
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/devtools/Device.am avr-libc-r2546/devtools/Device.am
--- avr-libc-2.0.0-orig/devtools/Device.am	2016-01-29 11:03:43.000000000 +0300
+++ avr-libc-r2546/devtools/Device.am	2018-05-22 08:51:53.000000000 +0400
@@ -83,7 +83,8 @@
 else
 # avr-gcc > 5.1.0 expects device library as lib<device name>.a
 avr_LIBRARIES = lib<<dev>>.a
-nodist_lib<<dev>>_a_SOURCES = $(eeprom_asm_sources)
+nodist_lib<<dev>>_a_SOURCES = $(eeprom_c_sources) $(dev_c_sources) \
+	$(eeprom_asm_sources) $(dev_asm_sources)
 endif
 endif
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/devtools/findreg.xsl avr-libc-r2546/devtools/findreg.xsl
--- avr-libc-2.0.0-orig/devtools/findreg.xsl	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/devtools/findreg.xsl	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,101 @@
+<?xml version="1.0" encoding='UTF-8' ?>
+<xsl:stylesheet version="1.0"
+                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
+                xmlns="http://www.w3.org/1999/xhtml">
+<!--
+ * Copyright (c) 2013 Joerg Wunsch
+ *
+ * "THE BEER-WARE LICENSE" (Revision 42):
+ * Joerg Wunsch wrote this file.  As long as you retain this notice you
+ * can do whatever you want with this stuff. If we meet some day, and you think
+ * this stuff is worth it, you can buy me a beer in return.        Joerg Wunsch
+ *
+ * $Id: findreg.xsl 2370 2013-04-29 12:13:51Z joerg_wunsch $
+-->
+
+<!--
+ * Extract IO register names and offsets out of Atmel Studio 6.x device XML files.
+ *
+ * The result is one line per IO register, in the form:
+ *
+ * REGNAME<tab>BASEADDRESS<tab>OFFSET<tab>SIZE<newline>
+ *
+ * REGNAME     - name of this IO register
+ * BASEADDRESS - base address of register group (IO module)
+ *               always 0 for non-Xmega devices
+ * OFFSET      - offset of register within group
+ * SIZE        - size of register in bytes (1 or 2)
+-->
+
+<!--
+ * Usage:
+ *
+ * xsltproc findreg.xsl ATxxx.xml > ATxxx.reg.txt
+ *
+ * or:
+ *
+ * java -jar /path/to/saxon9.jar -xsl:findreg.xsl -o:ATxxx.reg.txt ATxxx.xml
+ *
+ * (The warning about Saxon being an XSL 2.0 processor processing a 1.0
+ * style sheet can be ignoroed.)
+-->
+    <xsl:output method="text"/>
+
+    <xsl:template match="//address-space[@name='eeprom']">
+	<xsl:value-of select="@name" />
+	<xsl:text>&#9;0&#9;</xsl:text>
+	<xsl:value-of select="@start" />
+	<xsl:text>&#9;</xsl:text>
+	<xsl:value-of select="@size" />
+	<xsl:text>&#10;</xsl:text>
+    </xsl:template>
+    <!--
+	Pick all register-groups which are located in the
+	address-space named "data".  Lock and fuse bits are also
+	declared as register-group, but they've got their own address
+	space so we can distinguish them from the normal IO registers
+	we are interested in here.
+    -->
+    <xsl:template match="//peripherals//register-group[@address-space='data']">
+
+      <!-- remember for later, since we need the group offset later on -->
+      <xsl:variable name="group" select="current()" />
+      <xsl:variable name="registergroup"
+		    select="//modules/module/register-group[@name=$group/@name-in-module]" />
+
+      <!-- now, iterate over all registers of this group -->
+      <xsl:for-each select="$registergroup/register">
+
+	<!--
+	    On Xmega devices, prepend the name of the register-group
+	    (aka. subsystem) to the register name, since the register
+	    names are not unique across the device.
+
+	    On tiny/mega AVR devices, register names are unique across
+	    the entire device, so this is not needed/used.
+	-->
+	<xsl:if test="//device/@architecture='AVR8_XMEGA'">
+	  <xsl:value-of select="$group/@name" />
+	  <xsl:text>_</xsl:text>
+	</xsl:if>
+	<xsl:value-of select="@name" />
+	<xsl:text>&#9;</xsl:text>
+	<xsl:value-of select="$group/@offset" />
+	<xsl:text>&#9;</xsl:text>
+	<xsl:value-of select="@offset" />
+	<xsl:text>&#9;</xsl:text>
+	<xsl:value-of select="@size" />
+	<xsl:text>&#10;</xsl:text>
+      </xsl:for-each>
+
+    </xsl:template>
+
+    <xsl:template match="node()">
+      <xsl:apply-templates />
+    </xsl:template>
+
+    <xsl:template match="/">
+      <xsl:apply-templates />
+    </xsl:template>
+
+</xsl:stylesheet>
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/devtools/gen-avr-lib-tree.sh avr-libc-r2546/devtools/gen-avr-lib-tree.sh
--- avr-libc-2.0.0-orig/devtools/gen-avr-lib-tree.sh	2016-01-29 11:03:43.000000000 +0300
+++ avr-libc-r2546/devtools/gen-avr-lib-tree.sh	2018-05-22 08:51:53.000000000 +0400
@@ -29,7 +29,7 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 #
-# $Id: gen-avr-lib-tree.sh 2499 2016-01-28 14:41:31Z pitchumani $
+# $Id: gen-avr-lib-tree.sh 2544 2017-08-04 08:50:27Z pitchumani $
 #
 
 # This is a script to automate the generation of the avr/lib/ tree. Since
@@ -47,6 +47,7 @@
 
 CFLAGS_SPACE="-mcall-prologues -Os"
 CFLAGS_TINY_STACK="-msp8 -mcall-prologues -Os"
+CFLAGS_SHORT_CALLS="-mshort-calls -mcall-prologues -Os"
 CFLAGS_BIG_MEMORY='-Os $(FNO_JUMP_TABLES)'
 CFLAGS_SPEED="-Os"
 
@@ -302,6 +303,12 @@
 atxmega32e5:crtx32e5.o:${DEV_DEFS}:${CFLAGS_SPACE}:${DEV_ASFLAGS}\
 "
 
+AVRXMEGA3_DEV_INFO="\
+"
+
+AVRXMEGA3SC_DEV_INFO="\
+"
+
 AVRXMEGA4_DEV_INFO="\
 atxmega64a3:crtx64a3.o:${DEV_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
 atxmega64a3u:crtx64a3u.o:${DEV_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
@@ -371,6 +378,8 @@
 avr51::AVR51_DEV_INFO:${LIB_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
 avr6::AVR6_DEV_INFO:${LIB_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
 avrxmega2::AVRXMEGA2_DEV_INFO:${LIB_DEFS}:${CFLAGS_SPACE}:${DEV_ASFLAGS};\
+avrxmega3::AVRXMEGA3_DEV_INFO:${LIB_DEFS}:${CFLAGS_SPACE}:${DEV_ASFLAGS};\
+avrxmega3:short-calls:AVRXMEGA3SC_DEV_INFO:${LIB_DEFS}:${CFLAGS_SHORT_CALLS}:${DEV_ASFLAGS};\
 avrxmega4::AVRXMEGA4_DEV_INFO:${LIB_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
 avrxmega5::AVRXMEGA5_DEV_INFO:${LIB_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
 avrxmega6::AVRXMEGA6_DEV_INFO:${LIB_DEFS}:${CFLAGS_BIG_MEMORY}:${DEV_ASFLAGS};\
@@ -467,7 +476,18 @@
 		    -e "s/<<crt_cflags>>/$crt_cflags/g" \
 		    -e "s/<<crt_asflags>>/$crt_asflags/g"  \
 		    -e "s/<<install_dir>>/$inst_dir_masked/g" $dev/Makefile.am \
-		    > $dev/tempfile && mv -f $dev/tempfile $dev/Makefile.am
+		    > $dev/tempfile
+
+		case "$dev" in
+		  at90s1200|attiny11|attiny12|attiny15|attiny28)
+			sed -e "s/\$(eeprom_c_sources)//g" \
+				-e "s/\$(dev_c_sources)//g" $dev/tempfile \
+			> $dev/tempfile_2 && mv -f $dev/tempfile_2 $dev/Makefile.am
+			;;
+		  *)
+			mv -f $dev/tempfile $dev/Makefile.am
+			;;
+		esac
 
 		DEV_SUBDIRS="$DEV_SUBDIRS $dev"
 	done
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/devtools/generate_iosym.sh avr-libc-r2546/devtools/generate_iosym.sh
--- avr-libc-2.0.0-orig/devtools/generate_iosym.sh	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/devtools/generate_iosym.sh	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,58 @@
+#! /bin/sh
+
+devs="at43usb320 at43usb355 at76c711 at86rf401 at90c8534 at90can128 \
+at90can32 at90can64 at90pwm1 at90pwm2 at90pwm216 at90pwm2b at90pwm3 \
+at90pwm316 at90pwm3b at90pwm81 at90s1200 at90s2313 at90s2323 at90s2333 \
+at90s2343 at90s4414 at90s4433 at90s4434 at90s8515 at90s8535 at90scr100 \
+at90usb1286 at90usb1287 at90usb162 at90usb646 at90usb647 at90usb82 \
+at94k ata6289 atmega103 atmega128 atmega1280 atmega1281 atmega1284p \
+atmega1284rfr2 atmega128rfa1 atmega128rfr2 atmega16 atmega161 \
+atmega162 atmega163 atmega164a atmega164p atmega165 atmega165a \
+atmega165p atmega168 atmega168a atmega168p atmega169 atmega169a \
+atmega169p atmega169pa atmega16a atmega16hva atmega16hva2 atmega16hvb \
+atmega16hvbrevb atmega16m1 atmega16u2 atmega16u4 atmega2560 atmega2561 \
+atmega2564rfr2 atmega256rfr2 atmega32 atmega323 atmega324a atmega324p \
+atmega324pa atmega325 atmega3250 atmega3250a atmega3250p atmega325a \
+atmega325p atmega328 atmega328p atmega329 atmega3290 atmega3290a \
+atmega3290p atmega329a atmega329p atmega329pa atmega32c1 atmega32hvb \
+atmega32hvbrevb atmega32m1 atmega32u2 atmega32u4 atmega32u6 atmega406 \
+atmega48 atmega48a atmega48p atmega64 atmega640 atmega644 atmega644a \
+atmega644p atmega644pa atmega644rfr2 atmega645 atmega6450 atmega6450a \
+atmega6450p atmega645a atmega645p atmega649 atmega6490 atmega6490a \
+atmega6490p atmega649a atmega649p atmega64c1 atmega64hve atmega64m1 \
+atmega64rfr2 atmega8 atmega8515 atmega8535 atmega88 atmega88a \
+atmega88p atmega88pa atmega8hva atmega8u2 attiny10 attiny11 attiny12 \
+attiny13 attiny13a attiny15 attiny167 attiny20 attiny22 attiny2313 \
+attiny2313a attiny24 attiny24a attiny25 attiny26 attiny261 attiny261a \
+attiny28 attiny4 attiny40 attiny4313 attiny43u attiny44 attiny44a attiny441 \
+attiny45 attiny461 attiny461a attiny48 attiny5 attiny84 attiny84a attiny841 \
+attiny85 attiny861 attiny861a attiny87 attiny88 attiny9 atxmega128a1 \
+atxmega128a1u atxmega128a3 atxmega128d3 atxmega16a4 atxmega16d4 \
+atxmega192a3 atxmega192d3 atxmega256a3 atxmega256a3b atxmega256d3 \
+atxmega32a4 atxmega32d4 atxmega64a1 atxmega64a1u atxmega64a3 \
+atxmega64d3 at90pwm161 ata5272 ata5505 ata5790 ata5795 ata6285 \
+ata6286 ata6616c atmega1284 atmega128a atmega164pa atmega165pa atmega168pa \
+atmega3250pa atmega325pa atmega3290pa atmega32a atmega48pa atmega64a \
+atmega8a attiny1634 attiny828 atxmega128a3u atxmega128a4u atxmega128b1 \
+atxmega128b3 atxmega128c3 atxmega128d4 atxmega16a4u atxmega16c4 \
+atxmega192a3u atxmega192c3 atxmega256a3bu atxmega256a3u atxmega256c3 \
+atxmega32a4u atxmega32c4 atxmega384c3 atxmega384d3 atxmega64a3u \
+atxmega64a4u atxmega64b1 atxmega64b3 atxmega64c3 atxmega64d4 ata6617c \
+ata664251 ata6612c atmega48pb atmega88pb "
+
+if [ x"$XMLDIR" = x ]
+then
+    echo 'Please set $XMLDIR in your environment' >&2
+    exit 64
+fi
+
+for dev in $devs
+do
+    xmldev=$(echo $dev | tr '[a-z]' '[A-Z]' |\
+             sed -e s/XMEGA/xmega/ -e s/MEGA/mega/ -e s/TINY/tiny/)
+    if [ -f "${XMLDIR}/${xmldev}.xml" ]
+    then
+	echo "Generating ${dev}.S"
+	./ioreg.pl "${XMLDIR}/${xmldev}.xml" > ../crt1/iosym/${dev}.S
+    fi
+done
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/devtools/ioreg.pl avr-libc-r2546/devtools/ioreg.pl
--- avr-libc-2.0.0-orig/devtools/ioreg.pl	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/devtools/ioreg.pl	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,672 @@
+#!/usr/bin/perl
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# Converter from Atmels Device XML-Files via stylesheet to dwarf-2(!)
+# debug information. This debug information is device specific added
+# to the gcrt1-file
+#
+# Created by Knut Schwichtenberg
+# DWARF-2 templates by Joerg Wunsch
+#
+# $Id: ioreg.pl 2376 2013-04-30 14:49:25Z joerg_wunsch $
+
+
+# ----------------------------------------------------------------------------
+# "THE BEER-WARE LICENSE" (Revision 42):
+# Knut Schwichtenberg wrote this file.  As long as you retain this notice you
+# can do whatever you want with this stuff. If we meet some day, and you think
+# this stuff is worth it, you can buy me a beer in return.
+# ----------------------------------------------------------------------------
+
+########################################################################################
+#
+# Command line parameter
+# -V     print version and exit
+# -v     be verbose
+# -x     path to saxon9
+# -o     output file
+#
+# Return values:
+#  0  Okay
+#  1
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# Perl modules to be required
+use strict;
+use warnings;
+use Getopt::Std 'getopts';
+my $ContentTmplate;
+my $StaticContent;
+my $EepromTmplate;
+my $Uint32Tmplate;
+
+my $HaveUint32t = 0;
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# Static part of the DWARF file
+#
+$StaticContent = <<'EOST';
+/* This file is part of avr-libc.
+
+   Automatically created by devtools/ioreg.pl
+   DO NOT EDIT!
+
+   Redistribution and use in source and binary forms, with or without
+   modification, are permitted provided that the following conditions are met:
+
+   * Redistributions of source code must retain the above copyright
+     notice, this list of conditions and the following disclaimer.
+
+   * Redistributions in binary form must reproduce the above copyright
+     notice, this list of conditions and the following disclaimer in
+     the documentation and/or other materials provided with the
+     distribution.
+
+   * Neither the name of the copyright holders nor the names of
+     contributors may be used to endorse or promote products derived
+     from this software without specific prior written permission.
+
+  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+  POSSIBILITY OF SUCH DAMAGE. */
+
+/* $Id: ioreg.pl 2376 2013-04-30 14:49:25Z joerg_wunsch $ */
+
+#include <avr/version.h>
+
+#define DW_TAG_array_type               0x01
+#define DW_TAG_compile_unit             0x11
+#define DW_TAG_typedef                  0x16
+#define DW_TAG_subrange_type            0x21
+#define DW_TAG_base_type                0x24
+#define DW_TAG_variable                 0x34
+
+#define DW_FORM_addr                    0x01
+#define DW_FORM_block1                  0x0a
+#define DW_FORM_block2                  0x03
+#define DW_FORM_block4                  0x04
+#define DW_FORM_data1                   0x0b
+#define DW_FORM_data2                   0x05
+#define DW_FORM_data4                   0x06
+#define DW_FORM_data8                   0x07
+#define DW_FORM_string                  0x08
+#define DW_FORM_flag                    0x0c
+#define DW_FORM_strp                    0x0e
+#define DW_FORM_ref1                    0x11
+#define DW_FORM_ref2                    0x12
+#define DW_FORM_ref4                    0x13
+#define DW_FORM_ref8                    0x14
+
+#define DW_AT_location                  0x02
+#define DW_AT_name                      0x03
+#define DW_AT_byte_size                 0x0b
+#define DW_AT_stmt_list                 0x10
+#define DW_AT_language                  0x13
+#define DW_AT_producer                  0x25
+#define DW_AT_upper_bound               0x2f
+#define DW_AT_decl_file                 0x3a
+#define DW_AT_decl_line                 0x3b
+#define DW_AT_encoding                  0x3e
+#define DW_AT_external                  0x3f
+#define DW_AT_type                      0x49
+
+#define DW_LANG_C89                     0x0001
+
+#define DW_CHILDREN_no                  0x00
+#define DW_CHILDREN_yes                 0x01
+
+#define DW_ATE_unsigned                 0x7
+#define DW_ATE_unsigned_char            0x8
+
+#define DW_OP_addr                      0x03
+.eject
+	.section	.debug_abbrev, "", @progbits
+.Ldebug_abbrev0:
+	.section	.debug_info, "", @progbits
+	.section	.debug_line, "", @progbits
+.Ldebug_line0:
+	.section	.debug_str, "", @progbits
+
+	.section	.debug_info, "", @progbits
+	;; compilation unit header
+.Lssinfo:
+	.long	.Leinfo - .Lsinfo
+.Lsinfo:
+	.word	2		; DWARF-2
+	.long	.Ldebug_abbrev0
+	.byte	4		; sizeof(address)
+
+
+	;; DIE #1: compilation unit
+	.section	.debug_info
+	.uleb128	1	; ref to abbrev 1
+	.section	.debug_abbrev
+	.uleb128	1
+	.uleb128	DW_TAG_compile_unit
+	.byte		DW_CHILDREN_yes
+
+	.uleb128	DW_AT_producer
+	.uleb128	DW_FORM_strp
+	.section	.debug_str
+.Lproducer:
+	.ascii		"avr-libc "
+	.asciz		__AVR_LIBC_VERSION_STRING__
+	.section	.debug_info
+	.long		.Lproducer
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_stmt_list
+	.uleb128	DW_FORM_data4
+	.section	.debug_info
+	.long		.Ldebug_line0
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+	;; DIE #2: base type uint8_t
+	.section	.debug_info
+.Luint8_t:
+	.uleb128	2	; ref to abbrev 2
+	.section	.debug_abbrev
+	.uleb128	2
+	.uleb128	DW_TAG_base_type
+	.byte		DW_CHILDREN_no
+
+	.uleb128	DW_AT_name
+	.uleb128	DW_FORM_strp
+	.section	.debug_str
+.Luint8_t_name:
+	.string		"uint8_t"
+	.section	.debug_info
+	.long		.Luint8_t_name
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_byte_size
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		1
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_encoding
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		DW_ATE_unsigned_char
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+	;; DIE #3: base type uint16_t
+	.section	.debug_info
+.Luint16_t:
+	.uleb128	3	; ref to abbrev 3
+	.section	.debug_abbrev
+	.uleb128	3
+	.uleb128	DW_TAG_base_type
+	.byte		DW_CHILDREN_no
+
+	.uleb128	DW_AT_name
+	.uleb128	DW_FORM_strp
+	.section	.debug_str
+.Luint16_t_name:
+	.string		"uint16_t"
+	.section	.debug_info
+	.long		.Luint16_t_name
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_byte_size
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		2
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_encoding
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		DW_ATE_unsigned
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+EOST
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+#
+#
+$Uint32Tmplate = <<'EOU32';
+;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+	;; DIE #%No: base type uint32_t
+	.section	.debug_info
+.Luint32_t:
+	.uleb128	%No	; ref to abbrev %No
+	.section	.debug_abbrev
+	.uleb128	%No
+	.uleb128	DW_TAG_base_type
+	.byte		DW_CHILDREN_no
+
+	.uleb128	DW_AT_name
+	.uleb128	DW_FORM_strp
+	.section	.debug_str
+.Luint32_t_name:
+	.string		"uint32_t"
+	.section	.debug_info
+	.long		.Luint32_t_name
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_byte_size
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		4
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_encoding
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		DW_ATE_unsigned
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+EOU32
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+#
+#
+$ContentTmplate = <<'EODY';
+;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+	;; DIE #%No: variable %Reg
+	.section	.debug_info
+	.uleb128	%No	; ref to abbrev %No
+	.section	.debug_abbrev
+	.uleb128	%No
+	.uleb128	DW_TAG_variable
+	.byte		DW_CHILDREN_no
+
+	.uleb128	DW_AT_name
+	.uleb128	DW_FORM_strp
+	.section	.debug_str
+.Lname%No:
+	.string		"%Reg"
+	.section	.debug_info
+	.long		.Lname%No
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_decl_file
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		0	; no source file information
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_decl_line
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		0	; no source line information
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_type
+	.uleb128	DW_FORM_ref4
+	.section	.debug_info
+	.long		.Luint%Si_t - .Lssinfo
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_external
+	.uleb128	DW_FORM_flag
+	.section	.debug_info
+	.byte		1
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_location
+	.uleb128	DW_FORM_block1
+	.section	.debug_info
+	.byte		5	; length of block
+	.byte		DW_OP_addr
+	.long		0x800000 + %Ba + %Of
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+EODY
+
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+#
+#
+$EepromTmplate = <<'EOEE';
+;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+	;; DIE #%No1: EEPROM array base type: uint8_t
+	.section	.debug_info
+.Leeprom_t:
+	.uleb128	%No1	; ref to abbrev %No1
+	.section	.debug_abbrev
+	.uleb128	%No1
+	.uleb128	DW_TAG_array_type
+	.byte		DW_CHILDREN_yes
+
+	.uleb128	DW_AT_type
+	.uleb128	DW_FORM_ref4
+	.section	.debug_info
+	.long		.Luint8_t - .Lssinfo
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+	;; DIE #%No2: EEPROM array subtype (index type/bounds): uint16_t
+	.section	.debug_info
+	.uleb128	%No2	; ref to abbrev %No2
+	.section	.debug_abbrev
+	.uleb128	%No2
+	.uleb128	DW_TAG_subrange_type
+	.byte		DW_CHILDREN_no
+
+	.uleb128	DW_AT_type
+	.uleb128	DW_FORM_ref4
+	.section	.debug_info
+	.long		.Luint16_t - .Lssinfo
+	.section	.debug_abbrev
+	.uleb128	DW_AT_upper_bound
+	.uleb128	DW_FORM_data2
+	.section	.debug_info
+	.word		%Eesize - 1
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+	.section	.debug_info
+	.byte		0	; end of DIE #%No1 children
+
+	;; DIE #%No3: EEPROM array variable (name)
+	.section	.debug_info
+	.uleb128	%No3	; ref to abbrev %No3
+	.section	.debug_abbrev
+	.uleb128	%No3
+	.uleb128	DW_TAG_variable
+	.byte		DW_CHILDREN_no
+
+	.uleb128	DW_AT_name
+	.uleb128	DW_FORM_strp
+	.section	.debug_str
+.Lname%No3:
+	.string		"__eeprom"
+	.section	.debug_info
+	.long		.Lname%No3
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_decl_file
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		0	; no source file information
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_decl_line
+	.uleb128	DW_FORM_data1
+	.section	.debug_info
+	.byte		0	; no source line information
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_type
+	.uleb128	DW_FORM_ref4
+	.section	.debug_info
+	.long		.Leeprom_t - .Lssinfo
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_external
+	.uleb128	DW_FORM_flag
+	.section	.debug_info
+	.byte		1
+
+	.section	.debug_abbrev
+	.uleb128	DW_AT_location
+	.uleb128	DW_FORM_block1
+	.section	.debug_info
+	.byte		5	; length of block
+	.byte		DW_OP_addr
+	.long		0x810000 + %Of
+
+	.section	.debug_abbrev
+	.uleb128	0
+	.uleb128	0
+
+EOEE
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# trailing part of the dwarf Info
+#
+my $trailer = <<'EOT';
+	;; trailer
+	.section	.debug_abbrev
+	.uleb128	0
+
+	.section	.debug_info
+	.uleb128	0
+.Leinfo:
+EOT
+
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# All variables need have to be defined -> see  "use strict"
+#
+my @allRegister;
+my $staticCmd;
+my $OneRegister;
+my @RegisterParameter;
+my $DIE_No;              # Number of the Dwarf-DIE
+my $DynDIE;
+my ( $options, %opts ); # for the command line interpretation
+my $outfile = undef;
+my $XSLPath;
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# $Revision is a RCS Key-Word any other revision system will provide another key-word
+my $VERSION = sprintf("%s",('$Revision: 1.0 $' =~ /(\d*\.\d*[\.\d*]*)/));
+
+sub VERS_MESSAGE(){
+    print STDERR "$0 version: $VERSION Copyright (c) by Knut Schwichtenberg\n";
+    exit(0);
+    die;
+}
+
+sub HELPMESSAGE(){
+    print STDERR "$0 version: $VERSION Copyright (c) by Knut Schwichtenberg\n";
+    print STDERR "Usage: $0\ [switches] AVR_XML_file\n";
+    print STDERR "   -h This message\n";
+    print STDERR "   -V Version\n";
+    print STDERR "   -v Verbose\n";
+    print STDERR "   -x path to saxon9\n";
+    print STDERR "   -o output file otherwise STDOUT \n";
+}
+
+#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+# Handle the command line
+
+#$Getopt::Std::STANDARD_HELP_VERSION=1;
+$options = 'hVvx:o:';
+getopts( $options, \%opts );
+if( defined $opts{'h'} ){
+    HELPMESSAGE();
+    exit (0);
+}
+if( defined $opts{'V'} ){
+    VERS_MESSAGE();
+}
+if(! @ARGV ){
+    print "$0: missing file name\n";
+    HELPMESSAGE();
+    exit(-1);
+}
+if( defined $opts{'o'} ){
+	$outfile = $opts{'o'}; #
+	open STDOUT,">$outfile" || die "can't open $_[0]: $!\n";
+}
+if( defined $opts{'x'} ){
+	$XSLPath = $opts{'x'}; #
+} else {
+    $XSLPath = "/usr/share/java/";
+}
+
+# If xsltproc is around, use it.  Otherwise, use Saxon9.
+$staticCmd = "java -jar " . $XSLPath . "/saxon9.jar -xsl:findreg.xsl ";
+my $dummy;
+if ($dummy = `xsltproc -V`) {
+    $staticCmd = "xsltproc findreg.xsl ";
+    print STDERR "Using xsltproc for XSL transform\n" if $opts{'v'};
+} else {
+    print STDERR "Using Saxon for XSL transform\n" if $opts{'v'};
+}
+
+#- - - - - - - - - - - - - - - - - - - -
+# Create the static part of the debug information
+my $Filename = "ioreg_static.inc";
+#$StaticContent = do{local $/; open(my $f1, '<', $Filename) or die $!; my $tmp1 = <$f1>; close $f1 or die $!; $tmp1};
+
+#- - - - - - - - - - - - - - - - - - - -
+# For each IO-register a debug-information template is used. First read the template
+$Filename = "ioreg_dyn.inc";
+#$ContentTmplate = do{local $/; open(my $f1, '<', $Filename) or die $!; my $tmp1 = <$f1>; close $f1 or die $!; $tmp1};
+
+#- - - - - - - - - - - - - - - - - - - -
+# Convert via java from XML via XSL into text and put into array
+@allRegister = `$staticCmd $ARGV[0]`;
+
+#- - - - - - - - - - - - - - - - - - - -
+# use STDOUT as output file
+#
+print $StaticContent;  # Enter constants and DIE 1-3
+
+$DIE_No = 4;    # DIEs 1-3 are used by file, uint8_t, uint16_t
+
+#- - - - - - - - - - - - - - - - - - - -
+# Handle each array element (each register) as a DIE
+#
+foreach $OneRegister (@allRegister) {
+ chomp @RegisterParameter;
+ @RegisterParameter = split /\s+/,$OneRegister; # Register, Base, Offset, Size
+
+ print STDERR "Adding entry for $RegisterParameter[0]\n" if $opts{'v'};
+
+ if ($RegisterParameter[0] eq "eeprom") {
+  # use EEPROM template
+  $DynDIE = $EepromTmplate;
+  $DynDIE =~ s/%No1/$DIE_No/g;
+  $DIE_No++;
+  $DynDIE =~ s/%No2/$DIE_No/g;
+  $DIE_No++;
+  $DynDIE =~ s/%No3/$DIE_No/g;
+  $DIE_No++;
+  $DynDIE =~ s/%Eesize/$RegisterParameter[3]/g;
+  $DynDIE =~ s/%Of/$RegisterParameter[2]/g;
+ } else {
+  # use IO register template
+
+  $RegisterParameter[3] *= 8; # 1 -> uint8_t, 2 -> uint16_t, 4 -> uint32_t
+  if ($RegisterParameter[3] == 32 && !$HaveUint32t) {
+   $HaveUint32t = 1;
+   $DynDIE = $Uint32Tmplate;
+   $DynDIE =~ s/%No/$DIE_No/g;
+   $DIE_No++;
+   print $DynDIE;
+  }
+
+  #- - - - - - - - - - - - - - - - - - - -
+  # Replace variables by register values
+  #
+  ($DynDIE = $ContentTmplate) =~ s/%Reg/$RegisterParameter[0]/g;
+  $DynDIE =~ s/%No/$DIE_No/g;
+  $DynDIE =~ s/%Si/$RegisterParameter[3]/g;
+  $DynDIE =~ s/%Ba/$RegisterParameter[1]/g;
+  $DynDIE =~ s/%Of/$RegisterParameter[2]/g;
+  $DIE_No++;
+ }
+ print $DynDIE;
+}
+print $trailer;
+close;
+__END__
+=head1 NAME
+
+ioreg.pl  - Create debug information from Atmel XML files for IO-Ports and EEProm
+
+=head1 SYNOPSIS
+
+	perl ioreg.pl xxxxx.XML   
+
+=head1 DESCRIPTION
+
+Using GDB and AVaRICE to debug AVR code requires to know the addresses of
+IO registers! The GDB command "x PORTA" leads to an unknown address
+error. Beginning with Atmel Studio 5 well formed XML file are deliverd 
+as part of the installation. This script converts these XML-files using a 
+stylesheet into dwarf-2 debug information. To prevent Atmel's debugger from
+crashing only dwarf-2 can be used, while GDB could use debug information
+up to dwarf-4. Similar to the handling of the IO-addresses the eeprom
+start address can be accessed by the label __eeprom.  Its type is an CPU 
+specific array of uint8_t.
+
+This debug information is added to the device specific start-up code of 
+avr-libc and now allows debugging symbolic 
+names. 
+It is possible to use dwarf-4 debug information for the 
+application and mix it with dwarf-2 of the start-up code.
+
+=head1 Preconditions
+
+This script relies on
+
+=over 3
+
+=item *
+Atmel's AVR XML files
+
+=item *
+Stylesheet file named "findreg.xsl". It has to be located in the same directory as ioreg.pl 
+
+=item *
+XSLT processor, either xsltproc or saxon9
+
+=back
+
+If xsltproc is used, it must be in the PATH. Using saxon9 gives a runtime warning which can be ignored.
+
+=head1 Command line parameters
+
+The following command line parameters are supported
+
+=over 5
+
+=item h
+
+Print the help infomation to STDERR
+
+=item V
+
+Print the version information to STDERR
+
+=item v
+
+Print verbose information to STDERR
+
+=item x
+
+Sets the path to saxon9. Default: /usr/share/java
+
+=item o
+
+Set the output file otherwise STDOUT is used 
+
+=back
+
+=head1 Authors
+
+Knut Schwichtenberg / Joerg Wunsch
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/api/faq.dox avr-libc-r2546/doc/api/faq.dox
--- avr-libc-2.0.0-orig/doc/api/faq.dox	2012-01-03 19:36:58.000000000 +0400
+++ avr-libc-r2546/doc/api/faq.dox	2018-05-22 08:51:56.000000000 +0400
@@ -26,7 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: faq.dox 2276 2012-01-03 15:36:58Z joerg_wunsch $ */
+/* $Id: faq.dox 2543 2017-06-16 20:59:33Z joerg_wunsch $ */
 
 /** \page FAQ Frequently Asked Questions
 
@@ -674,6 +674,9 @@
 Calling C subroutines can clobber any of them -
 the caller is responsible for saving and restoring.
 
+\note For the AVR_TINY architecture (ATtiny10 and relatives),
+r18 and r19 are call-saved.
+
 - <strong>Call-saved registers (r2-r17, r28-r29):</strong><br>
 May be allocated by gcc for local data.
 Calling C subroutines leaves them unchanged.
@@ -686,6 +689,9 @@
 situations where the compiler assigns them for
 argument passing.
 
+\note For the AVR_TINY architecture (ATtiny10 and relatives),
+r18 and r19 are call-saved, and r0 through r16 do not exist.
+
 - <strong>Fixed registers (r0, r1):</strong><br>
 Never allocated by gcc for local data, but often
 used for fixed purposes:
@@ -706,6 +712,9 @@
 and restore r1 on exit (in case it was non-zero).
 </p>
 
+\note For the AVR_TINY architecture (ATtiny10 and relatives),
+r16 is used as temporary register, and r17 as zero.
+
 - <strong>Function call conventions:</strong><br>
 Arguments - allocated left to right, r25 to r8.
 All arguments are aligned to start in even-numbered
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/api/pgmspace.dox avr-libc-r2546/doc/api/pgmspace.dox
--- avr-libc-2.0.0-orig/doc/api/pgmspace.dox	2010-06-08 16:01:42.000000000 +0400
+++ avr-libc-r2546/doc/api/pgmspace.dox	2018-05-22 08:51:57.000000000 +0400
@@ -26,7 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: pgmspace.dox 1420 2007-10-02 13:50:16Z arcanum $ */
+/* $Id: pgmspace.dox 2523 2016-08-14 20:35:54Z elderling $ */
 
 /** 
 
@@ -129,7 +129,7 @@
 .
 .
 .
-unsigned char mydata[11][10] PROGMEM =
+const unsigned char mydata[11][10] PROGMEM =
 {
 	{0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09},
 	{0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13},
@@ -229,17 +229,17 @@
 declarations for each string, and put each string in Program Space:
 
 \code
-char string_1[] PROGMEM = "String 1";
-char string_2[] PROGMEM = "String 2";
-char string_3[] PROGMEM = "String 3";
-char string_4[] PROGMEM = "String 4";
-char string_5[] PROGMEM = "String 5";
+const char string_1[] PROGMEM = "String 1";
+const char string_2[] PROGMEM = "String 2";
+const char string_3[] PROGMEM = "String 3";
+const char string_4[] PROGMEM = "String 4";
+const char string_5[] PROGMEM = "String 5";
 \endcode
 
 Then use the new symbols in your table, like so:
 
 \code
-PGM_P string_table[] PROGMEM = 
+PGM_P const string_table[] PROGMEM = 
 {
     string_1,
     string_2,
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/api/unjs.pl avr-libc-r2546/doc/api/unjs.pl
--- avr-libc-2.0.0-orig/doc/api/unjs.pl	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/api/unjs.pl	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,155 @@
+#!/usr/bin/perl
+# ----------------------------------------------------------------------------
+# "THE BEER-WARE LICENSE" (Revision 42):
+# <joerg@FreeBSD.ORG> wrote this file.  As long as you retain this notice you
+# can do whatever you want with this stuff. If we meet some day, and you think
+# this stuff is worth it, you can buy me a beer in return.        Joerg Wunsch
+# ----------------------------------------------------------------------------
+#
+# Parse the generated tree.js file, and insert a <noscript> tree into the
+# HTML source.
+#
+# $Id: unjs.pl 266 2003-01-20 21:05:19Z joerg_wunsch $
+#
+
+die "usage: unjs tree.js tree.html index.html" unless $#ARGV == 2;
+
+$treejs = $ARGV[0];
+$treehtml = $ARGV[1];
+$indexhtml = $ARGV[2];
+
+parsejs($treejs) || exit 1;
+
+open(HTML, $treehtml) || die "Cannot open $treehtml: $!\n";
+open(NEW, ">${treehtml}.new") ||
+    die "Cannot create ${treehtml}.new: $!\n";
+
+while (<HTML>) {
+    print NEW;
+    if (/^<\/script>$/) {
+	print NEW "<noscript>\n";
+	print NEW $nojs;
+	print NEW "</noscript>\n";
+    }
+}
+close(NEW);
+close(HTML);
+rename($treehtml, "${treehtml}.bak") &&
+    rename("${treehtml}.new", $treehtml);
+
+open(HTML, $indexhtml) || die "Cannot open $indexhtml: $!\n";
+open(NEW, ">${indexhtml}.new") ||
+    die "Cannot create ${indexhtml}.new: $!\n";
+
+while (<HTML>) {
+    print NEW;
+    if (/^<\/frameset>$/) {
+	print NEW "<noframes>\n";
+	print NEW $nojs;
+	print NEW "</noframes>\n";
+    }
+}
+close(NEW);
+close(HTML);
+rename($indexhtml, "${indexhtml}.bak") &&
+    rename("${indexhtml}.new", $indexhtml);
+exit(0);
+
+sub parsejs
+{
+    my ($f) = @_;
+    my ($i, $err);
+
+    open(JS, $f) || die "Cannot open $f: $!\n";
+
+    while ($l = <JS>) {
+	chomp $l;
+
+	$resvar = undef;
+	$insvar = undef;
+
+	$l =~ s/^\s+//;
+	if ($l =~ /^([A-Za-z][A-Za-z0-9]*)\s*=\s*/) {
+	    # variable assignment
+	    $resvar = $1;
+	    $l = $';
+	}
+	$i = parsefun($l);
+	if ($i == 0) {
+	    $errs++;
+	    next;
+	}
+    }
+    close(JS);
+    return $errs == 0;
+}
+
+sub parsefun
+{
+    my ($line) = @_;
+    my $fun, $arg;
+
+    if ($line !~ /^([A-Za-z]+)[(](.*)[)]$/) {
+	warn "item ignored: $line\n";
+	return 0;
+    }
+    $fun = $1;
+    $arg = $2;
+    if ($fun ne "gFld" && $fun ne "gLnk" &&
+	$fun ne "insFld" && $fun ne "insDoc") {
+	warn "function $fun unknown\n";
+	return 0;
+    }
+    if ($fun =~ /^ins(.*)/) {
+	parseins($1, $arg) || return 0;
+    } elsif ($fun =~ /^g(.*)/) {
+	parseg($1, $arg) || return 0;
+    }
+
+    return 1;
+}
+
+sub parseg
+{
+    my ($name, $line) = @_;
+
+    if ($line !~ /^["](.*)["],\s*["](.*)["],\s*["](.*)["]/) {
+	warn "arglist expected: $line\n";
+	return 0;
+    }
+    $text = $1;
+    $tag = $2;
+    $lnk = $3;
+
+    if ($name eq "Fld") {
+	if ($lnk ne "") {
+	    $nojs .= "<a href=\"$lnk\" target=\"basefrm\"><b>$text</b></a><br>\n";
+	} else {
+	    $nojs .= "$text<br>\n";
+	}
+    } else {
+	# gLnk
+	if ($lnk ne "") {
+	    $nojs .= "<a href=\"$lnk\" target=\"basefrm\">$text</a><br>\n";
+	} else {
+	    # Huh, link without target?
+	    $nojs .= "$text<br>\n";
+	}
+    }
+}
+
+sub parseins
+{
+    my ($name, $line) = @_;
+
+    if ($line !~ /^([A-Za-z][A-Za-z0-9]*),\s*/) {
+	warn "variable expected: $line\n";
+	return;
+    }
+    $insvar = $1;
+
+    parsefun($') || return 0;
+
+    return 1;
+}
+	
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Bob-Paddock avr-libc-r2546/doc/LICENSE-Changes/PERM-Bob-Paddock
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Bob-Paddock	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Bob-Paddock	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,45 @@
+From bpaddock@csonline.net Thu Nov 11 11:54:04 2004
+Date: Mon, 1 Nov 2004 19:49:51 +0000
+From: Bob Paddock <bpaddock@csonline.net>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] Re: avr-libc licensing audit
+
+On Monday 01 November 2004 10:30 pm, E. Weddington wrote:
+> Bob Paddock,
+>
+> I've been conducting an audit of the licenses in the files in avr-libc
+>...
+> May I have your permission to modify the licenses of all the files in
+> avr-libc where you hold the copyright, to add the missing clause
+> reproduced below?
+
+Yes you may change the file.  I have been following the discussion on the 
+list.
+
+>    * Neither the name of the copyright holders nor the names of
+>      contributors may be used to endorse or promote products derived
+>      from this software without specific prior written permission.
+
+Just so this is clear in my own mind, is is ok to say "This product was 
+developed using GCC and avr-libc" on my web site if I ever have a product to 
+sell?
+
+It would be bad if I listed anyones name that I find in the code on the web 
+site where trying to sell product?
+
+> If I have your permission please respond to this email that you give
+> your permission and be sure to keep the CC to the avr-libc-dev mailing
+> list where it may be archived.
+
+-- 
+                       http://www.softwaresafety.net/
+http://www.unusualresearch.com/ http://www.bpaddock.com/
+
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Colin-OFlynn avr-libc-r2546/doc/LICENSE-Changes/PERM-Colin-OFlynn
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Colin-OFlynn	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Colin-OFlynn	2018-05-22 08:51:57.000000000 +0400
@@ -0,0 +1,53 @@
+From coflynn@newae.com Thu Nov 11 11:55:40 2004
+Date: Fri, 29 Oct 2004 17:59:22 -0300
+From: Colin O'Flynn <coflynn@newae.com>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] Re: avr-libc license audit
+
+Hello,
+
+Sorry about that - you have my full permission to modify those 
+files to which I have a copyright to include the additional 
+clause.
+
+Regards,
+
+ -Colin O'Flynn
+
+
+On October 29, 2004 5:14 pm, you wrote:
+> Hi Colin,
+>
+> I've been conducting an audit of the licenses in the files in
+> avr-libc <http://savannah.nongnu.org/projects/avr-libc/>.
+> avr-libc is supposed to be licensed with a modified BSD
+> license that contains the "no advertising" clause. I've
+> discovered a number of files that have incorrect licensing and
+> are missing the "no advertising" clause including some files
+> where you hold the copyright.
+>
+> May I have your permission to modify the licenses of all the
+> files in avr-libc where you hold the copyright, to add the
+> missing clause reproduced below?
+>
+>    * Neither the name of the copyright holders nor the names
+> of contributors may be used to endorse or promote products
+> derived from this software without specific prior written
+> permission.
+>
+> If I have your permission please respond to this email that
+> you give your permission and be sure to keep the CC to the
+> avr-libc-dev mailing list where it may be archived.
+>
+> Thank you.
+> Eric Weddington
+> avr-libc developer
+
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Joerg-Wunsch avr-libc-r2546/doc/LICENSE-Changes/PERM-Joerg-Wunsch
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Joerg-Wunsch	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Joerg-Wunsch	2018-05-22 08:51:57.000000000 +0400
@@ -0,0 +1,40 @@
+From j@ida.interface-business.de Thu Nov 11 11:56:45 2004
+Date: Thu, 28 Oct 2004 23:25:05 +0200
+From: Joerg Wunsch <j@ida.interface-business.de>
+Reply-To: Joerg Wunsch <joerg_wunsch@interface-systems.de>
+To: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: Re: [avr-libc-dev] [RFC] Licensing information
+
+As E. Weddington wrote:
+
+> Attached are IMO what the LICENSING and AUTHORS file should be.
+
+Thank you!
+
+> Now to the big problem: The original license file said that avr-libc was 
+> a Modified BSD License (with the No Advertising clause). However the 
+> "template" that it gave for new authors, only showed the original two 
+> clauses of the BSD license.
+
+The original BSD license had four clauses, where the `No advertising'
+clause was #3, and later officially dropped.  Individual *BSD
+developers later on also dropped clause #4 ("name ... may not be used
+to endorse"), which led to the two-clause template we had by now.
+
+For those files where I hold the copyright, I don't mind whether it's
+the 2-clause or 3-clause version.  I agree we should settle for one of
+both, and see to convert the remaining files (given author's
+permission).  It seems converting everything to the 3-clause version
+is less work, so let's pick this one.
+
+Thanks again!
+-- 
+J"org Wunsch                                           Unix support engineer
+joerg_wunsch@interface-systems.de        http://www.interface-systems.de/~j/
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Juergen-Schilling avr-libc-r2546/doc/LICENSE-Changes/PERM-Juergen-Schilling
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Juergen-Schilling	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Juergen-Schilling	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,61 @@
+From juergen.schilling@honeywell.com Thu Nov 11 11:53:02 2004
+Date: Wed, 3 Nov 2004 00:39:00 -0700 
+From: "Schilling, Juergen (GE51)" <juergen.schilling@honeywell.com>
+To: 'E. Weddington' <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] AW: avr-libc license audit
+
+Hi Eric,
+
+I don't have problems with that, so you have my permission to modify the
+files.
+
+Regards,
+Juergen
+
+
+> -----Ursprngliche Nachricht-----
+> Von: E. Weddington [mailto:ericw@evcohs.com]
+> Gesendet: Dienstag, 2. November 2004 19:46
+> An: Juergen Schilling
+> Cc: avr-libc-dev
+> Betreff: avr-libc license audit
+> 
+> 
+> Juergen,
+> 
+> I've been conducting an audit of the licenses in the files in 
+> avr-libc 
+> <http://savannah.nongnu.org/projects/avr-libc/>. avr-libc is 
+> supposed to 
+> be licensed with a modified BSD license that contains a "no 
+> endorsement" 
+> clause. I've discovered a number of files that have incorrect 
+> licensing 
+> and are missing this clause including some files where you hold the 
+> copyright.
+> 
+> May I have your permission to modify the licenses of all the files in 
+> avr-libc where you hold the copyright, to add the missing clause 
+> reproduced below?
+> 
+>    * Neither the name of the copyright holders nor the names of
+>      contributors may be used to endorse or promote products derived
+>      from this software without specific prior written permission.
+> 
+> If I have your permission please respond to this email that you give 
+> your permission and be sure to keep the CC to the 
+> avr-libc-dev mailing 
+> list where it may be archived.
+> 
+> Thank you.
+> Eric Weddington
+> avr-libc developer
+> 
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Keith-Gudger avr-libc-r2546/doc/LICENSE-Changes/PERM-Keith-Gudger
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Keith-Gudger	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Keith-Gudger	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,50 @@
+From keith@atmel.com Thu Nov 11 11:55:23 2004
+Date: Fri, 29 Oct 2004 13:57:44 -0700 (PDT)
+From: Keith Gudger <keith@atmel.com>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] Re: avr-libc license audit
+
+Eric:
+
+Yes, you have my permission to change the copyright as you mentioned in
+the text below.
+
+Keith Gudger
+29-Oct-2004
+
+On Fri, 29 Oct 2004, E. Weddington wrote:
+
+> Hi Keith,
+> 
+> I've been conducting an audit of the licenses in the files in avr-libc 
+> <http://savannah.nongnu.org/projects/avr-libc/>. avr-libc is supposed to 
+> be licensed with a modified BSD license that contains the "no 
+> advertising" clause. I've discovered a number of files that have 
+> incorrect licensing and are missing the "no advertising" clause 
+> including some files where you hold the copyright.
+> 
+> May I have your permission to modify the licenses of all the files in 
+> avr-libc where you hold the copyright, to add the missing clause 
+> reproduced below?
+> 
+>    * Neither the name of the copyright holders nor the names of
+>      contributors may be used to endorse or promote products derived
+>      from this software without specific prior written permission.
+> 
+> If I have your permission please respond to this email that you give 
+> your permission and be sure to keep the CC to the avr-libc-dev mailing 
+> list where it may be archived.
+> 
+> Thank you.
+> Eric Weddington
+> avr-libc developer
+> 
+
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Marek-Michalkiewicz avr-libc-r2546/doc/LICENSE-Changes/PERM-Marek-Michalkiewicz
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Marek-Michalkiewicz	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Marek-Michalkiewicz	2018-05-22 08:51:57.000000000 +0400
@@ -0,0 +1,69 @@
+From marekm@amelek.gda.pl Thu Nov 11 11:54:55 2004
+Date: Fri, 29 Oct 2004 23:38:08 +0200
+From: Marek Michalkiewicz <marekm@amelek.gda.pl>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev@nongnu.org
+Subject: Re: [avr-libc-dev] avr-libc license audit
+
+On Fri, Oct 29, 2004 at 02:56:02PM -0600, E. Weddington wrote:
+> 
+> The problem is that the original LICENSE file said that avr-libc is 
+> licensed with
+> "Modified BSD license (no advertising clause)"
+> There are many files in there that are *not licensed this way*, only 
+> having 2 clauses and not including the "no advertising" clause.
+
+Poorly defined operator precedence ;) - it was meant to be read as:
+
+(no (advertising clause))
+
+not as:
+
+((no advertising) clause)
+
+where the "advertising clause" is the one which was removed from the
+original (4-clause) BSD license.  The problem (full-page ads, etc.)
+is explained in http://www.gnu.org/philosophy/bsd.html .
+
+Some time ago, I chose the 3-clause BSD license as a fairly simple,
+liberal and standard one.  Later, BSD people made it even simpler by
+removing another clause (I guess it was a problem for someone again...
+licensing issues are evil), and I have no problem with that, so I
+started using the 2-clause license in newer files (and probably
+forgot to update some of the older ones).
+
+> The "no advertising" is only marginally restrictive:
+> 
+>   * Neither the name of the copyright holders nor the names of
+>     contributors may be used to endorse or promote products derived
+>     from this software without specific prior written permission.
+> 
+> It only restricts the user of avr-libc so they don't go off and say 
+> "Marek Michalkiewicz endorses the use of this product! :-) Buy it!". 
+> This is a fairly reaonable restriction for users.
+
+No problem for me either way - it was never my intent to add more
+restrictions, as they only make things more complicated for everyone
+(especially if one program contains code with different licenses: you
+have to check each license if it is compatible with all others, grrr...).
+
+> So, then do I have your permission to change the files that you hold a 
+> copyright on to include the "no adverstising" clause? If yes, could you 
+> CC avr-libc-dev?
+
+Yes.  But, you could just as well do the reverse: ask authors who
+hold copyright on files with 3-clause license if they agree to
+remove that one clause (I agree, if I forgot to remove that clause
+from any of the files I wrote).  It's up to you.  Sorry for not
+speaking up about this earlier (I'm overworked as usual).
+
+Thanks,
+Marek
+
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Micheal-Stumpf avr-libc-r2546/doc/LICENSE-Changes/PERM-Micheal-Stumpf
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Micheal-Stumpf	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Micheal-Stumpf	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,70 @@
+From mistumpf@de.pepperl-fuchs.com Thu Nov 11 11:50:21 2004
+Date: Wed, 10 Nov 2004 10:13:19 +0100
+From: Stumpf Michael <mistumpf@de.pepperl-fuchs.com>
+To: 'E. Weddington' <ericw@evcohs.com>,
+     Stumpf Michael <mistumpf@de.pepperl-fuchs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] AW: avr-libc license audit
+
+Hello,
+
+I never cared much about licences, so feel free to apply the 
+modifications as you suggested.
+No problem with relicencing the math lib either.
+
+best regards, 
+Michael Stumpf
+
+> -----Ursprngliche Nachricht-----
+> Von: E. Weddington [mailto:ericw@evcohs.com]
+> Gesendet: Dienstag, 9. November 2004 21:49
+> An: MiStumpf@de.pepperl-fuchs.com
+> Cc: avr-libc-dev
+> Betreff: avr-libc license audit
+> 
+> 
+> Michael Stumpf,
+> 
+> I've been conducting an audit of the licenses in the files in 
+> avr-libc 
+> <http://savannah.nongnu.org/projects/avr-libc/>. avr-libc is 
+> supposed to 
+> be licensed with a modified BSD license that contains a "no 
+> endorsement" 
+> clause. I've discovered a number of files that have incorrect 
+> licensing 
+> and are missing this clause including some files where you hold the 
+> copyright, specifically I am referring to include/ctype.h and 
+> include/math.h, NOT the math library.
+> 
+> May I have your permission to modify the licenses of the two files in 
+> avr-libc listed above where you hold the copyright, to add 
+> the missing 
+> clause reproduced below?
+> 
+>    * Neither the name of the copyright holders nor the names of
+>      contributors may be used to endorse or promote products derived
+>      from this software without specific prior written permission.
+> 
+> If I have your permission please respond to this email that you give 
+> your permission and be sure to keep the CC to the 
+> avr-libc-dev mailing 
+> list where it may be archived.
+> 
+> As a seperate issue, would you be willing to relicense the 
+> avr-libc math 
+> library functions written by you to have the Modified BSD 
+> License (the 
+> same as the rest of avr-libc)? This would greatly help in making the 
+> licensing for all of avr-libc consistent. I also understand if you do 
+> not wish to do this.
+> 
+> Thank you.
+> Eric Weddington
+> avr-libc developer
+> 
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Nils-Kristian-Strom avr-libc-r2546/doc/LICENSE-Changes/PERM-Nils-Kristian-Strom
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Nils-Kristian-Strom	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Nils-Kristian-Strom	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,31 @@
+From nilsst@invalid.ed.ntnu.no Thu Nov 11 11:52:24 2004
+Date: Wed, 03 Nov 2004 08:12:27 +0100
+From: Nils Kristian Strom <nilsst@invalid.ed.ntnu.no>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>,
+     Nils Kristian Strom <nilsst@omegav.ntnu.no>
+Subject: [avr-libc-dev] Re: avr-libc license audit
+
+On Tue, 2004-11-02 at 11:47 -0700, E. Weddington wrote:
+> May I have your permission to modify the licenses of all the files in 
+> avr-libc where you hold the copyright, to add the missing clause 
+> reproduced below?
+
+Yes, you have my permission to modify those files to which I have a
+copyright.
+
+>    * Neither the name of the copyright holders nor the names of
+>      contributors may be used to endorse or promote products derived
+>      from this software without specific prior written permission.
+
+Best regards,
+Nils Strom
+
+
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Peter-Jansen avr-libc-r2546/doc/LICENSE-Changes/PERM-Peter-Jansen
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Peter-Jansen	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Peter-Jansen	2018-05-22 08:51:57.000000000 +0400
@@ -0,0 +1,67 @@
+From peter.jansen@aad.gov.au Thu Nov 11 11:50:50 2004
+Date: Wed, 10 Nov 2004 09:35:52 +1100
+From: Peter Jansen <peter.jansen@aad.gov.au>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] Re: avr-libc contribution?
+
+E. Weddington wrote:
+> Peter Jansen wrote:
+> 
+>> E. Weddington wrote:
+>>
+>>> Peter,
+>>>
+>>> I'm trying to find the Peter Jansen that made a contribution of the 
+>>> iom128.h header file to the avr-libc project:
+>>> <http://savannah.nongnu.org/projects/avr-libc/>
+>>>
+>>> This email was suggested to me by one of the admins of that project. 
+>>> Are you the original submitter of this file?
+>>
+>>
+>>
+>> Yes I think I submitted that file, I have not worked on AVR's for a 
+>> while, do you have some questions?
+>>
+>>
+> Yes, I've been conducting an audit of the licenses in the files in 
+> avr-libc <http://savannah.nongnu.org/projects/avr-libc/>. avr-libc is 
+> supposed to be licensed with a modified BSD license that contains a "no 
+> endorsement" clause. I've discovered a number of files that have 
+> incorrect licensing and are missing this clause including that file 
+> (iom128.h) where you hold the copyright.
+> 
+> May I have your permission to modify the licenses of all the files in 
+> avr-libc where you hold the copyright, to add the missing clause 
+> reproduced below?
+> 
+>   * Neither the name of the copyright holders nor the names of
+>     contributors may be used to endorse or promote products derived
+>     from this software without specific prior written permission.
+> 
+> If I have your permission please respond to this email that you give 
+> your permission and be sure to keep the CC to the avr-libc-dev mailing 
+> list where it may be archived.
+
+Yes you have my permission to modify the license as per your above text.
+
+Thanks it must be difficult to follow all those up.
+
+-- 
+Peter Jansen
+STS
+Australian Antarctic Division
+Channel Highway
+Kingston
+TAS        7050
+AUSTRALIA
+Ph  (03) 62 323 533
+Fax (03) 62 323 351
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Reinhard-Jessich avr-libc-r2546/doc/LICENSE-Changes/PERM-Reinhard-Jessich
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Reinhard-Jessich	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Reinhard-Jessich	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,47 @@
+From reinhard.jessich@telering.at Thu Nov 11 11:51:50 2004
+Date: Fri, 5 Nov 2004 22:28:18 +0100
+From: reinhard.jessich@telering.at
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] Re: avr-libc license audit
+
+On Wed, 03 Nov 2004, E. Weddington wrote:
+You have the permission to change what ever you want.
+BR
+   Reinhard
+
+> Reinhard,
+> 
+> I've been conducting an audit of the licenses in the files in avr-libc 
+> <http://savannah.nongnu.org/projects/avr-libc/>. avr-libc is supposed to 
+> be licensed with a modified BSD license that contains a "no endorsement" 
+> clause. I've discovered a number of files that have incorrect licensing 
+> and are missing this clause including some files where you hold the 
+> copyright.
+> 
+> May I have your permission to modify the licenses of all the files in 
+> avr-libc where you hold the copyright, to add the missing clause 
+> reproduced below?
+> 
+>    * Neither the name of the copyright holders nor the names of
+>      contributors may be used to endorse or promote products derived
+>      from this software without specific prior written permission.
+> 
+> If I have your permission please respond to this email that you give 
+> your permission and be sure to keep the CC to the avr-libc-dev mailing 
+> list where it may be archived.
+> 
+> Thank you.
+> Eric Weddington
+> avr-libc developer
+-- 
+ Ing. Reinhard Jessich              mailto: reinhard.jessich@telering.at
+ A-1190 Vienna, Goergengasse 2/2/1  phone: +43/1/3692600
+ http://members.telering.at/jessich mobile: +43/664/1735439
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Steinar-Haugen avr-libc-r2546/doc/LICENSE-Changes/PERM-Steinar-Haugen
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Steinar-Haugen	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Steinar-Haugen	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,50 @@
+From xoplanet@msn.com Thu Nov 11 11:53:40 2004
+Date: Tue, 02 Nov 2004 19:32:35 +0100
+From: Stone Hill <xoplanet@msn.com>
+To: ericw@evcohs.com
+Cc: avr-libc-dev@nongnu.org
+Subject: [avr-libc-dev] RE: avr-libc license audit
+
+Yes, You have my permission to modify those
+files to which I have a copyright.
+
+Best regards,
+Steinar Haugen
+
+
+>From: "E. Weddington" <ericw@evcohs.com>
+>To: Steinar Haugen <xoplanet@msn.com>
+>CC: avr-libc-dev <avr-libc-dev@nongnu.org>
+>Subject: avr-libc license audit
+>Date: Mon, 01 Nov 2004 15:28:25 -0700
+>
+>I've been conducting an audit of the licenses in the files in avr-libc 
+><http://savannah.nongnu.org/projects/avr-libc/>. avr-libc is supposed to be 
+>licensed with a modified BSD license that contains a "no endorsement" 
+>clause. I've discovered a number of files that have incorrect licensing and 
+>are missing this clause including some files where you hold the copyright.
+>
+>May I have your permission to modify the licenses of all the files in 
+>avr-libc where you hold the copyright, to add the missing clause reproduced 
+>below?
+>
+>   * Neither the name of the copyright holders nor the names of
+>     contributors may be used to endorse or promote products derived
+>     from this software without specific prior written permission.
+>
+>If I have your permission please respond to this email that you give your 
+>permission and be sure to keep the CC to the avr-libc-dev mailing list 
+>where it may be archived.
+>
+>Thank you.
+>Eric Weddington
+>avr-libc developer
+
+
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Theodore-A-Roth avr-libc-r2546/doc/LICENSE-Changes/PERM-Theodore-A-Roth
--- avr-libc-2.0.0-orig/doc/LICENSE-Changes/PERM-Theodore-A-Roth	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/doc/LICENSE-Changes/PERM-Theodore-A-Roth	2018-05-22 08:51:56.000000000 +0400
@@ -0,0 +1,37 @@
+From troth@openavr.org Thu Nov 11 11:57:48 2004
+Date: Tue, 2 Nov 2004 08:56:48 -0800 (PST)
+From: Theodore A. Roth <troth@openavr.org>
+To: E. Weddington <ericw@evcohs.com>
+Cc: avr-libc-dev <avr-libc-dev@nongnu.org>
+Subject: [avr-libc-dev] Re: Missing copyrights?
+
+On Tue, 2 Nov 2004, E. Weddington wrote:
+
+> Theodore A. Roth wrote:
+>
+> >I have just added copyrights to the files I wrote in CVS HEAD. [See
+> >attached patch.]
+> >
+> >
+> >
+> Thanks. One note though: acconfig.h just has the two-clause license.
+> While I'm at it, can I have your permission to fix all of your
+> copyrighted files in avr-libc to add the missing clause?
+
+Pooh. I tried to add all those with the 3 clause, but looks like
+copy-paste got me again. ;-)
+
+Yes, got ahead and add the 3rd clause on any of my files that are
+missing it.
+
+---
+Ted Roth
+PGP Key ID: 0x18F846E9
+Jabber ID: troth@jabber.org
+
+
+_______________________________________________
+AVR-libc-dev mailing list
+AVR-libc-dev@nongnu.org
+http://lists.nongnu.org/mailman/listinfo/avr-libc-dev
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/assert.h avr-libc-r2546/include/assert.h
--- avr-libc-2.0.0-orig/include/assert.h	2012-03-27 12:31:14.000000000 +0400
+++ avr-libc-r2546/include/assert.h	2018-05-22 08:52:05.000000000 +0400
@@ -33,7 +33,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
 
-  $Id: assert.h 2290 2012-02-04 02:08:47Z dmix $
+  $Id: assert.h 2526 2016-10-19 10:36:48Z pitchumani $
 */
 
 /** \file */
@@ -95,6 +95,12 @@
 #  endif /* NDEBUG */
 #endif /* DOXYGEN */
 
+#if (defined __STDC_VERSION__ && __STDC_VERSION__ >= 201112L) || \
+    ((_GNUC_ > 4 || (_GNUC_ == 4 && _GNUC_MINOR_ >= 6)) && !defined __cplusplus)
+#  undef static_assert
+#  define static_assert _Static_assert
+#endif
+
 #ifdef __cplusplus
 extern "C" {
 #endif
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/builtins.h avr-libc-r2546/include/avr/builtins.h
--- avr-libc-2.0.0-orig/include/avr/builtins.h	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/include/avr/builtins.h	2018-05-22 09:41:58.350684900 +0400
@@ -0,0 +1,113 @@
+/* Copyright (c) 2008 Anatoly Sokolov
+   Copyright (c) 2010 Joerg Wunsch
+   All rights reserved.
+
+   Redistribution and use in source and binary forms, with or without
+   modification, are permitted provided that the following conditions are met:
+
+   * Redistributions of source code must retain the above copyright
+     notice, this list of conditions and the following disclaimer.
+
+   * Redistributions in binary form must reproduce the above copyright
+     notice, this list of conditions and the following disclaimer in
+     the documentation and/or other materials provided with the
+     distribution.
+
+   * Neither the name of the copyright holders nor the names of
+     contributors may be used to endorse or promote products derived
+     from this software without specific prior written permission.
+
+  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+  POSSIBILITY OF SUCH DAMAGE. */
+
+/* $Id: builtins.h.in 2103 2010-03-17 05:16:10Z joerg_wunsch $ */
+
+/*
+   avr/builtins.h - Intrinsic functions built into the compiler
+ */
+ 
+#ifndef _AVR_BUILTINS_H_
+#define _AVR_BUILTINS_H_
+
+#ifndef __HAS_DELAY_CYCLES
+#define __HAS_DELAY_CYCLES 1
+#endif
+
+/** \file */
+/** \defgroup avr_builtins <avr/builtins.h>: GCC builtins
+    \code #include <avr/builtins.h> \endcode
+
+    This header file declares AVR builtins.
+    All the functions documented here are built into the
+    compiler, and cause it to emit the corresponding assembly
+    code instructions.
+*/
+
+/**
+    \ingroup avr_builtins
+
+    Enables interrupts by setting the global interrupt mask.  */
+extern void __builtin_avr_sei(void);
+
+/**
+    \ingroup avr_builtins
+
+    Disables all interrupts by clearing the global interrupt mask.  */
+extern void __builtin_avr_cli(void);
+
+/**
+    \ingroup avr_builtins
+
+    Emits a \c SLEEP instruction.  */
+
+extern void __builtin_avr_sleep(void);
+
+/**
+    \ingroup avr_builtins
+
+    Emits a WDR (watchdog reset) instruction.  */
+extern void __builtin_avr_wdr(void);
+
+/**
+    \ingroup avr_builtins
+
+    Emits a SWAP (nibble swap) instruction on __b.  */
+extern unsigned char __builtin_avr_swap(unsigned char __b);
+
+/**
+    \ingroup avr_builtins
+
+    Emits an FMUL (fractional multiply unsigned) instruction.  */
+extern unsigned int __builtin_avr_fmul(unsigned char __a, unsigned char __b);
+
+/**
+    \ingroup avr_builtins
+
+    Emits an FMUL (fractional multiply signed) instruction.  */
+extern int __builtin_avr_fmuls(char __a, char __b);
+
+/**
+    \ingroup avr_builtins
+
+    Emits an FMUL (fractional multiply signed with unsigned) instruction.  */
+extern int __builtin_avr_fmulsu(char __a, unsigned char __b);
+
+#if __HAS_DELAY_CYCLES || defined(__DOXYGEN__)
+/**
+    \ingroup avr_builtins
+
+    Emits a sequence of instructions causing the CPU to spend
+    \c __n cycles on it.  */
+extern void __builtin_avr_delay_cycles(unsigned long __n);
+#endif
+
+#endif /* _AVR_BUILTINS_H_ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/cpufunc.h avr-libc-r2546/include/avr/cpufunc.h
--- avr-libc-2.0.0-orig/include/avr/cpufunc.h	2013-02-16 12:20:26.000000000 +0400
+++ avr-libc-r2546/include/avr/cpufunc.h	2018-05-22 08:52:10.000000000 +0400
@@ -28,13 +28,15 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: cpufunc.h 2307 2013-01-26 22:39:58Z dmix $ */
+/* $Id: cpufunc.h 2529 2016-12-05 06:09:28Z pitchumani $ */
 
 /* avr/cpufunc.h - Special CPU functions */
 
 #ifndef _AVR_CPUFUNC_H_
 #define _AVR_CPUFUNC_H_ 1
 
+#include <stdint.h>
+
 /** \file */
 /** \defgroup avr_cpufunc <avr/cpufunc.h>: Special AVR CPU functions
     \code #include <avr/cpufunc.h> \endcode
@@ -80,4 +82,12 @@
 #define _MemoryBarrier() __asm__ __volatile__("":::"memory")
 #endif  /* __DOXYGEN__ */
 
+/**
+   \ingroup avr_cpufunc
+
+   Write \a __value to Configuration Change Protected (CCP) IO register
+   at \a __ioaddr.
+ */
+void ccp_write_io (uint8_t *__ioaddr, uint8_t __value);
+
 #endif /* _AVR_CPUFUNC_H_ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/interrupt.h avr-libc-r2546/include/avr/interrupt.h
--- avr-libc-2.0.0-orig/include/avr/interrupt.h	2011-02-23 20:29:20.000000000 +0300
+++ avr-libc-r2546/include/avr/interrupt.h	2018-05-22 08:52:05.000000000 +0400
@@ -30,7 +30,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: interrupt.h 2220 2011-02-22 21:08:58Z arcanum $ */
+/* $Id: interrupt.h 2538 2017-06-11 15:16:05Z joerg_wunsch $ */
 
 #ifndef _AVR_INTERRUPT_H_
 #define _AVR_INTERRUPT_H_
@@ -126,18 +126,18 @@
 #else  /* real code */
 
 #if (__GNUC__ == 4 && __GNUC_MINOR__ >= 1) || (__GNUC__ > 4)
-#  define __INTR_ATTRS used, externally_visible
+#  define __INTR_ATTRS __used__, __externally_visible__
 #else /* GCC < 4.1 */
-#  define __INTR_ATTRS used
+#  define __INTR_ATTRS __used__
 #endif
 
 #ifdef __cplusplus
 #  define ISR(vector, ...)            \
-    extern "C" void vector (void) __attribute__ ((signal,__INTR_ATTRS)) __VA_ARGS__; \
+    extern "C" void vector (void) __attribute__ ((__signal__,__INTR_ATTRS)) __VA_ARGS__; \
     void vector (void)
 #else
 #  define ISR(vector, ...)            \
-    void vector (void) __attribute__ ((signal,__INTR_ATTRS)) __VA_ARGS__; \
+    void vector (void) __attribute__ ((__signal__,__INTR_ATTRS)) __VA_ARGS__; \
     void vector (void)
 #endif
 
@@ -158,11 +158,11 @@
 
 #ifdef __cplusplus
 #  define SIGNAL(vector)					\
-    extern "C" void vector(void) __attribute__ ((signal, __INTR_ATTRS));	\
+    extern "C" void vector(void) __attribute__ ((__signal__, __INTR_ATTRS));	\
     void vector (void)
 #else
 #  define SIGNAL(vector)					\
-    void vector (void) __attribute__ ((signal, __INTR_ATTRS));		\
+    void vector (void) __attribute__ ((__signal__, __INTR_ATTRS));		\
     void vector (void)
 #endif
 
@@ -182,12 +182,12 @@
 
 #ifdef __cplusplus
 #  define EMPTY_INTERRUPT(vector)                \
-    extern "C" void vector(void) __attribute__ ((signal,naked,__INTR_ATTRS));    \
-    void vector (void) {  __asm__ __volatile__ ("reti" ::); }
+    extern "C" void vector(void) __attribute__ ((__signal__,__naked__,__INTR_ATTRS));    \
+    void vector (void) {  __asm__ __volatile__ ("reti" ::: "memory"); }
 #else
 #  define EMPTY_INTERRUPT(vector)                \
-    void vector (void) __attribute__ ((signal,naked,__INTR_ATTRS));    \
-    void vector (void) { __asm__ __volatile__ ("reti" ::); }
+    void vector (void) __attribute__ ((__signal__,__naked__,__INTR_ATTRS));    \
+    void vector (void) { __asm__ __volatile__ ("reti" ::: "memory"); }
 #endif
 
 #endif /* DOXYGEN */
@@ -225,25 +225,13 @@
 #else /* real code */
 
 #ifdef __cplusplus
-#  if defined(__AVR_MEGA__) && __AVR_MEGA__
 #    define ISR_ALIAS(vector, tgt) extern "C" void vector (void) \
-	__attribute__((signal, naked, __INTR_ATTRS)); \
-	void vector (void) { asm volatile ("jmp " __STRINGIFY(tgt) ::); }
-#  else /* !__AVR_MEGA */
-#    define ISR_ALIAS(vector, tgt) extern "C" void vector (void) \
-	__attribute__((signal, naked, __INTR_ATTRS)); \
-	void vector (void) { asm volatile ("rjmp " __STRINGIFY(tgt) ::); }
-#  endif  /* __AVR_MEGA__ */
+	__attribute__((__signal__, __naked__, __INTR_ATTRS)); \
+	void vector (void) { __asm__ __volatile__ ("%~jmp " __STRINGIFY(tgt) ::); }
 #else	  /* !__cplusplus */
-#  if defined(__AVR_MEGA__) && __AVR_MEGA__
-#  define ISR_ALIAS(vector, tgt) void vector (void) \
-	__attribute__((signal, naked, __INTR_ATTRS)); \
-	void vector (void) { asm volatile ("jmp " __STRINGIFY(tgt) ::); }
-#  else /* !__AVR_MEGA */
 #  define ISR_ALIAS(vector, tgt) void vector (void) \
-	__attribute__((signal, naked, __INTR_ATTRS)); \
-	void vector (void) { asm volatile ("rjmp " __STRINGIFY(tgt) ::); }
-#  endif  /* __AVR_MEGA__ */
+	__attribute__((__signal__, __naked__, __INTR_ATTRS)); \
+	void vector (void) { __asm__ __volatile__ ("%~jmp " __STRINGIFY(tgt) ::); }
 #endif	/* __cplusplus */
 
 #endif /* DOXYGEN */
@@ -261,7 +249,7 @@
 */
 #  define reti()
 #else  /* !DOXYGEN */
-#  define reti()  __asm__ __volatile__ ("reti" ::)
+#  define reti()  __asm__ __volatile__ ("reti" ::: "memory")
 #endif /* DOXYGEN */
 
 #if defined(__DOXYGEN__)
@@ -323,6 +311,26 @@
 */
 #  define ISR_NAKED
 
+/** \def ISR_FLATTEN
+    \ingroup avr_interrupts
+
+    The compiler will try to inline all called function into the ISR.
+    This has an effect with GCC 4.6 and newer only.
+
+    Use this attribute in the attributes parameter of the ISR macro.
+*/
+#  define ISR_FLATTEN
+
+/** \def ISR_NOICF
+    \ingroup avr_interrupts
+
+    Avoid identical-code-folding optimization against this ISR.
+    This has an effect with GCC 5 and newer only.
+
+    Use this attribute in the attributes parameter of the ISR macro.
+*/
+#  define ISR_NOICF
+
 /** \def ISR_ALIASOF(target_vector)
     \ingroup avr_interrupts
 
@@ -330,13 +338,39 @@
     This is compatible with GCC 4.2 and greater only.
 
     Use this attribute in the attributes parameter of the ISR macro.
+    Example:
+    \code
+    ISR (INT0_vect)
+    {
+        PORTB = 42;
+    }
+
+    ISR (INT1_vect, ISR_ALIASOF (INT0_vect));
+    \endcode 
 */
 #  define ISR_ALIASOF(target_vector)
 #else  /* !DOXYGEN */
-#  define ISR_BLOCK
-#  define ISR_NOBLOCK    __attribute__((interrupt))
-#  define ISR_NAKED      __attribute__((naked))
-#  define ISR_ALIASOF(v) __attribute__((alias(__STRINGIFY(v))))
+#  define ISR_BLOCK /* empty */
+/* FIXME: This won't work with older versions of avr-gcc as ISR_NOBLOCK
+          will use `signal' and `interrupt' at the same time.  */
+#  define ISR_NOBLOCK    __attribute__((__interrupt__))
+#  define ISR_NAKED      __attribute__((__naked__))
+
+#if (__GNUC__ == 4 && __GNUC_MINOR__ >= 6) || (__GNUC__ >= 5)
+#  define ISR_FLATTEN    __attribute__((__flatten__))
+#else
+#  define ISR_FLATTEN    /* empty */
+#endif /* has flatten (GCC 4.6+) */
+
+#if defined (__has_attribute)
+#if __has_attribute (__no_icf__)
+#  define ISR_NOICF      __attribute__((__no_icf__))
+#else
+#  define ISR_NOICF      /* empty */
+#endif /* has no_icf */
+#endif /* has __has_attribute (GCC 5+) */
+
+#  define ISR_ALIASOF(v) __attribute__((__alias__(__STRINGIFY(v))))
 #endif /* DOXYGEN */
 
 /* \@} */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/iom16u4.h avr-libc-r2546/include/avr/iom16u4.h
--- avr-libc-2.0.0-orig/include/avr/iom16u4.h	2016-01-25 22:25:11.000000000 +0300
+++ avr-libc-r2546/include/avr/iom16u4.h	2018-05-22 08:52:10.000000000 +0400
@@ -28,7 +28,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: iom16u4.h 2460 2014-12-03 05:39:25Z pitchumani $ */
+/* $Id: iom16u4.h 2536 2017-03-07 07:13:41Z pitchumani $ */
 
 /* avr/iom16u4.h - definitions for ATmega16U4 */
 
@@ -458,11 +458,13 @@
 #define PRR1 _SFR_MEM8(0x65)
 #define PRUSART1 0
 #define PRTIM3 3
+#define PRTIM4 4
 #define PRUSB 7
 
-#define __AVR_HAVE_PRR1	((1<<PRUSART1)|(1<<PRTIM3)|(1<<PRUSB))
+#define __AVR_HAVE_PRR1	((1<<PRUSART1)|(1<<PRTIM4)|(1<<PRTIM3)|(1<<PRUSB))
 #define __AVR_HAVE_PRR1_PRUSART1
 #define __AVR_HAVE_PRR1_PRTIM3
+#define __AVR_HAVE_PRR1_PRTIM4
 #define __AVR_HAVE_PRR1_PRUSB
 
 #define OSCCAL _SFR_MEM8(0x66)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/iom32u4.h avr-libc-r2546/include/avr/iom32u4.h
--- avr-libc-2.0.0-orig/include/avr/iom32u4.h	2016-01-25 22:25:11.000000000 +0300
+++ avr-libc-r2546/include/avr/iom32u4.h	2018-05-22 08:52:05.000000000 +0400
@@ -29,7 +29,7 @@
   POSSIBILITY OF SUCH DAMAGE. 
 */
 
-/* $Id: iom32u4.h 2479 2015-07-22 05:32:39Z pitchumani $ */
+/* $Id: iom32u4.h 2536 2017-03-07 07:13:41Z pitchumani $ */
 
 /* avr/iom32u4.h - definitions for ATmega32U4. */
 
@@ -462,11 +462,13 @@
 #define PRR1 _SFR_MEM8(0x65)
 #define PRUSART1 0
 #define PRTIM3 3
+#define PRTIM4 4
 #define PRUSB 7
 
-#define __AVR_HAVE_PRR1	((1<<PRUSART1)|(1<<PRTIM3)|(1<<PRUSB))
+#define __AVR_HAVE_PRR1	((1<<PRUSART1)|(1<<PRTIM4)|(1<<PRTIM3)|(1<<PRUSB))
 #define __AVR_HAVE_PRR1_PRUSART1
 #define __AVR_HAVE_PRR1_PRTIM3
+#define __AVR_HAVE_PRR1_PRTIM4
 #define __AVR_HAVE_PRR1_PRUSB
 
 #define OSCCAL _SFR_MEM8(0x66)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/iomxx4.h avr-libc-r2546/include/avr/iomxx4.h
--- avr-libc-2.0.0-orig/include/avr/iomxx4.h	2016-01-25 22:25:11.000000000 +0300
+++ avr-libc-r2546/include/avr/iomxx4.h	2018-05-22 08:52:05.000000000 +0400
@@ -30,7 +30,7 @@
 
 /* avr/iomXX4.h - definitions for ATmega164P/324P/644P and ATmega644 */
 
-/* $Id: iomxx4.h 2460 2014-12-03 05:39:25Z pitchumani $ */
+/* $Id: iomxx4.h 2546 2017-08-23 06:21:07Z pitchumani $ */
 
 #ifndef _AVR_IOMXX4_H_
 #define _AVR_IOMXX4_H_ 1
@@ -366,8 +366,8 @@
 
 /* Reserved [0x62..0x63] */
 
-#define PRR	_SFR_MEM8(0x64)  /* Datasheets: ATmega164P/324P/644P 8011DAVR02/07
-                                   and ATmega644 2593LAVR02/07.  */
+#define PRR	_SFR_MEM8(0x64)  /* Datasheets: ATmega164P/324P/644P 8011D-AVR-02/07
+                                   and ATmega644 2593L-AVR-02/07.  */
 #define PRR0	_SFR_MEM8(0x64)  /* AVR Studio 4.13, build 524.  */
 #define PRTWI		7
 #define PRTIM2		6
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/iotn441.h avr-libc-r2546/include/avr/iotn441.h
--- avr-libc-2.0.0-orig/include/avr/iotn441.h	2016-01-25 22:25:11.000000000 +0300
+++ avr-libc-r2546/include/avr/iotn441.h	2018-05-22 08:52:10.000000000 +0400
@@ -403,8 +403,20 @@
 #define ADC9D   3
 
 #define PUEB    _SFR_MEM8(0x62)
+#define PUEB3   3
+#define PUEB2   2
+#define PUEB1   1
+#define PUEB0   0
 
 #define PUEA    _SFR_MEM8(0x63)
+#define PUEA7   7
+#define PUEA6   6
+#define PUEA5   5
+#define PUEA4   4
+#define PUEA3   3
+#define PUEA2   2
+#define PUEA1   1
+#define PUEA0   0
 
 #define PORTCR  _SFR_MEM8(0x64)
 #define BBMB    1
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/iotn841.h avr-libc-r2546/include/avr/iotn841.h
--- avr-libc-2.0.0-orig/include/avr/iotn841.h	2016-01-25 22:25:11.000000000 +0300
+++ avr-libc-r2546/include/avr/iotn841.h	2018-05-22 08:52:10.000000000 +0400
@@ -403,8 +403,20 @@
 #define ADC9D   3
 
 #define PUEB    _SFR_MEM8(0x62)
+#define PUEB3   3
+#define PUEB2   2
+#define PUEB1   1
+#define PUEB0   0
 
 #define PUEA    _SFR_MEM8(0x63)
+#define PUEA7   7
+#define PUEA6   6
+#define PUEA5   5
+#define PUEA4   4
+#define PUEA3   3
+#define PUEA2   2
+#define PUEA1   1
+#define PUEA0   0
 
 #define PORTCR  _SFR_MEM8(0x64)
 #define BBMB    1
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/pgmspace.h avr-libc-r2546/include/avr/pgmspace.h
--- avr-libc-2.0.0-orig/include/avr/pgmspace.h	2016-02-08 01:59:49.000000000 +0300
+++ avr-libc-r2546/include/avr/pgmspace.h	2018-05-22 08:52:10.000000000 +0400
@@ -28,7 +28,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: pgmspace.h 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
+/* $Id: pgmspace.h 2544 2017-08-04 08:50:27Z pitchumani $ */
 
 /*
    pgmspace.h
@@ -892,8 +892,8 @@
 }))
 
 /*
-Check for architectures that implement RAMPD (avrxmega3, avrxmega5,
-avrxmega7) as they need to save/restore RAMPZ for ELPM macros so it does
+Check for architectures that implement RAMPD (avrxmega5, avrxmega7)
+as they need to save/restore RAMPZ for ELPM macros so it does
 not interfere with data accesses.
 */
 #if defined (__AVR_HAVE_RAMPD__)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/power.h avr-libc-r2546/include/avr/power.h
--- avr-libc-2.0.0-orig/include/avr/power.h	2016-02-08 01:59:49.000000000 +0300
+++ avr-libc-r2546/include/avr/power.h	2018-05-22 08:52:11.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: power.h 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
+/* $Id: power.h 2525 2016-09-15 10:24:25Z pitchumani $ */
 
 #ifndef _AVR_POWER_H_
 #define _AVR_POWER_H_   1
@@ -584,7 +584,7 @@
 #define power_psc2_disable()    (PRR |= (uint8_t)(1 << PRPSC2))
 #endif
 
-#if defined(__AVR_HAVE_PRR_PRSCR)
+#if defined(__AVR_HAVE_PRR_PRPSCR)
 #define power_pscr_enable()     (PRR &= (uint8_t)~(1 << PRPSCR))
 #define power_pscr_disable()    (PRR |= (uint8_t)(1 << PRPSCR))
 #endif
@@ -664,6 +664,11 @@
 #define power_lfreceiver_disable()      (PRR0 |= (uint8_t)(1 << PRLFR))            
 #endif
 
+#if defined(__AVR_HAVE_PRR0_PRLFRS)
+#define power_lfrs_enable()             (PRR0 &= (uint8_t)~(1 << PRLFRS))
+#define power_lfrs_disable()            (PRR0 |= (uint8_t)(1 << PRLFRS))
+#endif
+
 #if defined(__AVR_HAVE_PRR0_PRLIN)
 #define power_lin_enable()              (PRR0 &= (uint8_t)~(1 << PRLIN))
 #define power_lin_disable()             (PRR0 |= (uint8_t)(1 << PRLIN))
@@ -729,6 +734,11 @@
 #define power_twi_disable()             (PRR0 |= (uint8_t)(1 << PRTWI))
 #endif
 
+#if defined(__AVR_HAVE_PRR0_PRTWI1)
+#define power_twi1_enable()             (PRR0 &= (uint8_t)~(1 << PRTWI1))
+#define power_twi1_disable()            (PRR0 |= (uint8_t)(1 << PRTWI1))
+#endif
+
 #if defined(__AVR_HAVE_PRR0_PRTXDC)
 #define power_transmit_dsp_control_enable()   (PRR0 &= (uint8_t)~(1 << PRTXDC))
 #define power_transmit_dsp_control_disable()  (PRR0 |= (uint8_t)(1 << PRTXDC))
@@ -779,16 +789,31 @@
 #define power_kb_disable()              (PRR1 |= (uint8_t)(1 << PRKB))
 #endif
 
+#if defined(__AVR_HAVE_PRR1_PRLFPH)
+#define power_lfph_enable()             (PRR1 &= (uint8_t)~(1 << PRLFPH))
+#define power_lfph_disable()            (PRR1 |= (uint8_t)(1 << PRLFPH))
+#endif
+
 #if defined(__AVR_HAVE_PRR1_PRLFR)
 #define power_lfreceiver_enable()       (PRR1 &= (uint8_t)~(1 << PRLFR))            
 #define power_lfreceiver_disable()      (PRR1 |= (uint8_t)(1 << PRLFR))            
 #endif
 
+#if defined(__AVR_HAVE_PRR1_PRLFTP)
+#define power_lftp_enable()             (PRR1 &= (uint8_t)~(1 << PRLFTP))
+#define power_lftp_disable()            (PRR1 |= (uint8_t)(1 << PRLFTP))
+#endif
+
 #if defined(__AVR_HAVE_PRR1_PRSCI)
 #define power_sci_enable()              (PRR1 &= (uint8_t)~(1 << PRSCI))
 #define power_sci_disable()             (PRR1 |= (uint8_t)(1 << PRSCI))
 #endif
 
+#if defined(__AVR_HAVE_PRR1_PRSPI)
+#define power_spi_enable()              (PRR1 &= (uint8_t)~(1 << PRSPI))
+#define power_spi_disable()             (PRR1 |= (uint8_t)(1 << PRSPI))
+#endif
+
 #if defined(__AVR_HAVE_PRR1_PRT1)
 #define power_timer1_enable()           (PRR1 &= (uint8_t)~(1 << PRT1))
 #define power_timer1_disable()          (PRR1 |= (uint8_t)(1 << PRT1))
@@ -844,6 +869,11 @@
 #define power_usart2_disable()          (PRR1 |= (uint8_t)(1 << PRUSART2))
 #endif
 
+#if defined(__AVR_HAVE_PRR1_PRUSART3)
+#define power_usart3_enable()           (PRR1 &= (uint8_t)~(1 << PRUSART3))
+#define power_usart3_disable()          (PRR1 |= (uint8_t)(1 << PRUSART3))
+#endif
+
 #if defined(__AVR_HAVE_PRR1_PRUSB)
 #define power_usb_enable()              (PRR1 &= (uint8_t)~(1 << PRUSB))
 #define power_usb_disable()             (PRR1 |= (uint8_t)(1 << PRUSB))
@@ -894,6 +924,11 @@
 #define power_preamble_rssi_fifo_disable()      (PRR2 |= (uint8_t)(1 << PRSF))
 #endif
 
+#if defined(__AVR_HAVE_PRR2_PRSPI2)
+#define power_spi2_enable()             (PRR2 &= (uint8_t)~(1 << PRSPI2))
+#define power_spi2_disable()            (PRR2 |= (uint8_t)(1 << PRSPI2))
+#endif
+
 #if defined(__AVR_HAVE_PRR2_PRSSM)
 #define power_sequencer_state_machine_enable()  (PRR2 &= (uint8_t)~(1 << PRSSM))
 #define power_sequencer_state_machine_disable() (PRR2 |= (uint8_t)(1 << PRSSM))
@@ -904,6 +939,11 @@
 #define power_tx_modulator_disable()    (PRR2 |= (uint8_t)(1 << PRTM))
 #endif
 
+#if defined(__AVR_HAVE_PRR2_PRTWI2)
+#define power_twi2_enable()             (PRR2 &= (uint8_t)~(1 << PRTWI2))
+#define power_twi2_disable()            (PRR2 |= (uint8_t)(1 << PRTWI2))
+#endif
+
 #if defined(__AVR_HAVE_PRR2_PRXA)
 #define power_rx_buffer_A_enable()      (PRR2 &= (uint8_t)~(1 << PRXA))
 #define power_rx_buffer_A_disable()     (PRR2 |= (uint8_t)(1 << PRXA))
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/avr/wdt.h avr-libc-r2546/include/avr/wdt.h
--- avr-libc-2.0.0-orig/include/avr/wdt.h	2016-02-08 01:59:49.000000000 +0300
+++ avr-libc-r2546/include/avr/wdt.h	2018-05-22 08:52:11.000000000 +0400
@@ -29,7 +29,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: wdt.h 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
+/* $Id: wdt.h 2522 2016-04-20 05:43:23Z joerg_wunsch $ */
 
 /*
    avr/wdt.h - macros for AVR watchdog timer
@@ -558,6 +558,10 @@
     AT90USB82, AT90USB162,
     AT90USB646, AT90USB647, AT90USB1286, AT90USB1287,
     ATtiny48, ATtiny88.
+
+    Note: This value does <em>not</em> match the bit pattern of the
+    respective control register.  It is solely meant to be used together
+    with wdt_enable().
     */
 #define WDTO_4S     8
 
@@ -583,6 +587,10 @@
     ATxmega16a4u, ATxmega32a4u,
     ATxmega16c4, ATxmega32c4,
     ATxmega128c3, ATxmega192c3, ATxmega256c3.
+
+    Note: This value does <em>not</em> match the bit pattern of the
+    respective control register.  It is solely meant to be used together
+    with wdt_enable().
     */
 #define WDTO_8S     9
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/stdio.h avr-libc-r2546/include/stdio.h
--- avr-libc-2.0.0-orig/include/stdio.h	2016-02-08 01:59:49.000000000 +0300
+++ avr-libc-r2546/include/stdio.h	2018-05-22 08:52:11.000000000 +0400
@@ -33,7 +33,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
 
-  $Id: stdio.h 2503 2016-02-07 22:59:47Z joerg_wunsch $
+  $Id: stdio.h 2539 2017-06-11 15:25:02Z joerg_wunsch $
 */
 
 #ifndef _STDIO_H_
@@ -214,7 +214,7 @@
     {
 
       if (c == '\n')
-        uart_putchar('\r');
+        uart_putchar('\r', stream);
       loop_until_bit_is_set(UCSRA, UDRE);
       UDR = c;
       return 0;
@@ -594,7 +594,7 @@
    \par Notes:
    - For floating-point conversions, if you link default or minimized
      version of vfprintf(), the symbol \c ? will be output and double
-     argument will be skiped. So you output below will not be crashed.
+     argument will be skipped. So you output below will not be crashed.
      For default version the width field and the "pad to left" ( symbol
      minus ) option will work in this case.
    - The \c hh length modifier is ignored (\c char argument is
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/stdlib.h avr-libc-r2546/include/stdlib.h
--- avr-libc-2.0.0-orig/include/stdlib.h	2016-02-08 01:59:49.000000000 +0300
+++ avr-libc-r2546/include/stdlib.h	2018-05-22 08:52:11.000000000 +0400
@@ -33,7 +33,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
 
-  $Id: stdlib.h 2503 2016-02-07 22:59:47Z joerg_wunsch $
+  $Id: stdlib.h 2524 2016-09-07 12:08:25Z joerg_wunsch $
 */
 
 #ifndef _STDLIB_H_
@@ -349,6 +349,15 @@
 
 extern double strtod(const char *__nptr, char **__endptr);
 
+/** \ingroup avr_stdlib
+    \fn  double atof (const char *nptr)
+
+    The atof() function converts the initial portion of the string pointed
+    to by \a nptr to double representation.
+
+    It is equivalent to calling
+	\code strtod(nptr, (char **)0); \endcode
+ */
 extern double atof(const char *__nptr);
 
 /** Highest number that can be generated by rand(). */
@@ -625,14 +634,14 @@
    one digit before the decimal-point character and the number of
    digits after it is equal to the precision \c prec; if the precision
    is zero, no decimal-point character appears.  If \c flags has the
-   DTOSTRE_UPPERCASE bit set, the letter \c 'E' (rather than \c 'e' ) will be
+   DTOSTR_UPPERCASE bit set, the letter \c 'E' (rather than \c 'e' ) will be
    used to introduce the exponent.  The exponent always contains two
    digits; if the value is zero, the exponent is \c "00".
 
-   If \c flags has the DTOSTRE_ALWAYS_SIGN bit set, a space character
+   If \c flags has the DTOSTR_ALWAYS_SIGN bit set, a space character
    will be placed into the leading position for positive numbers.
 
-   If \c flags has the DTOSTRE_PLUS_SIGN bit set, a plus sign will be
+   If \c flags has the DTOSTR_PLUS_SIGN bit set, a plus sign will be
    used instead of a space character in this case.
 
    The dtostre() function returns the pointer to the converted string \c s.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/string.h avr-libc-r2546/include/string.h
--- avr-libc-2.0.0-orig/include/string.h	2016-02-08 01:59:49.000000000 +0300
+++ avr-libc-r2546/include/string.h	2018-05-22 08:52:11.000000000 +0400
@@ -28,7 +28,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: string.h 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
+/* $Id: string.h 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 /*
    string.h
@@ -110,43 +110,499 @@
 	 - (((x) & 0177777) == 0) * 16)
 #endif /* DOXYGEN */
 
-extern int ffs (int __val) __ATTR_CONST__;
-extern int ffsl (long __val) __ATTR_CONST__;
-__extension__ extern int ffsll (long long __val) __ATTR_CONST__;
+/** \ingroup avr_string
+    \fn int ffs(int val);
+
+    \brief This function finds the first (least significant) bit set in the input value.
+
+    \returns The ffs() function returns the position of the first
+    (least significant) bit set in the word val, or 0 if no bits are set.
+    The least significant bit is position 1.
+
+    \note For expressions that are constant at compile time, consider
+    using the \ref _FFS macro instead.
+*/
+extern int ffs(int __val) __ATTR_CONST__;
+
+/** \ingroup avr_string
+    \fn int ffsl(long val);
+
+    \brief Same as ffs(), for an argument of type long. */
+extern int ffsl(long __val) __ATTR_CONST__;
+
+/** \ingroup avr_string
+    \fn int ffsll(long long val);
+
+    \brief Same as ffs(), for an argument of type long long. */
+__extension__ extern int ffsll(long long __val) __ATTR_CONST__;
+
+/** \ingroup avr_string
+    \fn void *memccpy(void *dest, const void *src, int val, size_t len)
+    \brief Copy memory area.
+
+    The memccpy() function copies no more than \p len bytes from memory
+    area \p src to memory area \p dest, stopping when the character \p val
+    is found.
+
+    \returns The memccpy() function returns a pointer to the next character
+    in \p dest after \p val, or NULL if \p val was not found in the first
+    \p len characters of \p src. */
 extern void *memccpy(void *, const void *, int, size_t);
+
+/** \ingroup avr_string
+    \fn void *memchr(const void *src, int val, size_t len)
+    \brief Scan memory for a character.
+
+    The memchr() function scans the first len bytes of the memory area pointed
+    to by src for the character val.  The first byte to match val (interpreted
+    as an unsigned character) stops the operation.
+
+    \returns The memchr() function returns a pointer to the matching byte or
+    NULL if the character does not occur in the given memory area.  */
 extern void *memchr(const void *, int, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn int memcmp(const void *s1, const void *s2, size_t len)
+    \brief Compare memory areas
+
+    The memcmp() function compares the first len bytes of the memory areas s1
+    and s2. The comparision is performed using unsigned char operations.
+
+    \returns The memcmp() function returns an integer less than, equal to, or
+    greater than zero if the first len bytes of s1 is found, respectively, to be
+    less than, to match, or be greater than the first len bytes of s2.
+
+    \note Be sure to store the result in a 16 bit variable since you may get
+    incorrect results if you use an unsigned char or char due to truncation.
+
+    \warning This function is not -mint8 compatible, although if you only care
+    about testing for equality, this function should be safe to use. */
 extern int memcmp(const void *, const void *, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn void *memcpy(void *dest, const void *src, size_t len)
+    \brief Copy a memory area.
+
+    The memcpy() function copies len bytes from memory area src to memory area
+    dest.  The memory areas may not overlap.  Use memmove() if the memory
+    areas do overlap.
+
+    \returns The memcpy() function returns a pointer to dest.  */
 extern void *memcpy(void *, const void *, size_t);
+
+/** \ingroup avr_string
+    \fn void *memmem(const void *s1, size_t len1, const void *s2, size_t len2)
+
+    The memmem() function finds the start of the first occurrence of the
+    substring \p s2 of length \p len2 in the memory area \p s1 of length
+    \p len1.
+
+    \return The memmem() function returns a pointer to the beginning of
+    the substring, or \c NULL if the substring is not found. If \p len2
+    is zero, the function returns \p s1. */
 extern void *memmem(const void *, size_t, const void *, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn void *memmove(void *dest, const void *src, size_t len)
+    \brief Copy memory area.
+
+    The memmove() function copies len bytes from memory area src to memory area
+    dest.  The memory areas may overlap.
+
+    \returns The memmove() function returns a pointer to dest.  */
 extern void *memmove(void *, const void *, size_t);
+
+/** \ingroup avr_string
+    \fn void *memrchr(const void *src, int val, size_t len)
+
+    The memrchr() function is like the memchr() function, except that it
+    searches backwards from the end of the \p len bytes pointed to by \p
+    src instead of forwards from the front. (Glibc, GNU extension.)
+
+    \return The memrchr() function returns a pointer to the matching
+    byte or \c NULL if the character does not occur in the given memory
+    area. */
 extern void *memrchr(const void *, int, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn void *memset(void *dest, int val, size_t len)
+    \brief Fill memory with a constant byte.
+
+    The memset() function fills the first len bytes of the memory area pointed
+    to by dest with the constant byte val.
+
+    \returns The memset() function returns a pointer to the memory area dest. */
 extern void *memset(void *, int, size_t);
+
+/** \ingroup avr_string
+    \fn char *strcat(char *dest, const char *src)
+    \brief Concatenate two strings.
+
+    The strcat() function appends the src string to the dest string
+    overwriting the '\\0' character at the end of dest, and then adds a
+    terminating '\\0' character.  The strings may not overlap, and the dest
+    string must have enough space for the result.
+
+    \returns The strcat() function returns a pointer to the resulting string
+    dest.  */
 extern char *strcat(char *, const char *);
+
+/** \ingroup avr_string
+    \fn char *strchr(const char *src, int val)
+    \brief Locate character in string.
+
+    The strchr() function returns a pointer to the first occurrence of
+    the character \p val in the string \p src.
+
+    Here "character" means "byte" - these functions do not work with
+    wide or multi-byte characters.
+
+    \returns The strchr() function returns a pointer to the matched
+    character or \c NULL if the character is not found. */
 extern char *strchr(const char *, int) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strchrnul(const char *s, int c)
+
+    The strchrnul() function is like strchr() except that if \p c is not
+    found in \p s, then it returns a pointer to the null byte at the end
+    of \p s, rather than \c NULL. (Glibc, GNU extension.)
+
+    \return The strchrnul() function returns a pointer to the matched
+    character, or a pointer to the null byte at the end of \p s (i.e.,
+    \c s+strlen(s)) if the character is not found.	*/
 extern char *strchrnul(const char *, int) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn int strcmp(const char *s1, const char *s2)
+    \brief Compare two strings.
+
+    The strcmp() function compares the two strings \p s1 and \p s2.
+
+    \returns The strcmp() function returns an integer less than, equal
+    to, or greater than zero if \p s1 is found, respectively, to be less
+    than, to match, or be greater than \p s2. A consequence of the
+    ordering used by strcmp() is that if \p s1 is an initial substring
+    of \p s2, then \p s1 is considered to be "less than" \p s2.	*/
 extern int strcmp(const char *, const char *) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strcpy(char *dest, const char *src)
+    \brief Copy a string.
+
+    The strcpy() function copies the string pointed to by src (including the
+    terminating '\\0' character) to the array pointed to by dest.  The strings
+    may not overlap, and the destination string dest must be large enough to
+    receive the copy.
+
+    \returns The strcpy() function returns a pointer to the destination
+    string dest.
+
+    \note If the destination string of a strcpy() is not large enough (that
+    is, if the programmer was stupid/lazy, and failed to check the size before
+    copying) then anything might happen.  Overflowing fixed length strings is
+    a favourite cracker technique. */
 extern char *strcpy(char *, const char *);
+
+/** \ingroup avr_string
+    \fn int strcasecmp(const char *s1, const char *s2)
+    \brief Compare two strings ignoring case.
+
+    The strcasecmp() function compares the two strings \p s1 and \p s2,
+    ignoring the case of the characters.
+
+    \returns The strcasecmp() function returns an integer less than,
+    equal to, or greater than zero if \p s1 is found, respectively, to
+    be less than, to match, or be greater than \p s2. A consequence of
+    the ordering used by strcasecmp() is that if \p s1 is an initial
+    substring of \p s2, then \p s1 is considered to be "less than"
+    \p s2. */
 extern int strcasecmp(const char *, const char *) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strcasestr(const char *s1, const char *s2)
+
+    The strcasestr() function finds the first occurrence of the
+    substring \p s2 in the string \p s1. This is like strstr(), except
+    that it ignores case of alphabetic symbols in searching for the
+    substring. (Glibc, GNU extension.)
+
+    \return The strcasestr() function returns a pointer to the beginning
+    of the substring, or \c NULL if the substring is not found. If \p s2
+    points to a string of zero length, the function returns \p s1. */
 extern char *strcasestr(const char *, const char *) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn size_t strcspn(const char *s, const char *reject)
+
+    The strcspn() function calculates the length of the initial segment
+    of \p s which consists entirely of characters not in \p reject.
+
+    \return The strcspn() function returns the number of characters in
+    the initial segment of \p s which are not in the string \p reject.
+    The terminating zero is not considered as a part of string.	*/
 extern size_t strcspn(const char *__s, const char *__reject) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strdup(const char *s1)
+    \brief Duplicate a string.
+
+    The strdup() function allocates memory and copies into it the string
+    addressed by s1, including the terminating null character.
+
+    \warning The strdup() function calls malloc() to allocate the memory
+    for the duplicated string! The user is responsible for freeing the
+    memory by calling free().
+
+    \returns The strdup() function returns a pointer to the resulting string
+    dest. If malloc() cannot allocate enough storage for the string, strdup()
+    will return NULL.
+
+    \warning Be sure to check the return value of the strdup() function to
+    make sure that the function has succeeded in allocating the memory!
+*/
 extern char *strdup(const char *s1);
+
+/** \ingroup avr_string
+    \fn size_t strlcat(char *dst, const char *src, size_t siz)
+    \brief Concatenate two strings.
+
+    Appends \p src to string \p dst of size \p siz (unlike strncat(),
+    \p siz is the full size of \p dst, not space left).  At most \p siz-1
+    characters will be copied.  Always NULL terminates (unless \p siz <=
+    \p strlen(dst)).
+
+    \returns The strlcat() function returns strlen(src) + MIN(siz,
+    strlen(initial dst)).  If retval >= siz, truncation occurred.  */
 extern size_t strlcat(char *, const char *, size_t);
+
+/** \ingroup avr_string
+    \fn size_t strlcpy(char *dst, const char *src, size_t siz)
+    \brief Copy a string.
+
+    Copy \p src to string \p dst of size \p siz.  At most \p siz-1
+    characters will be copied.  Always NULL terminates (unless \p siz == 0).
+
+    \returns The strlcpy() function returns strlen(src). If retval >= siz,
+    truncation occurred.  */
 extern size_t strlcpy(char *, const char *, size_t);
+
+/** \ingroup avr_string
+    \fn size_t strlen(const char *src)
+    \brief Calculate the length of a string.
+
+    The strlen() function calculates the length of the string src, not
+    including the terminating '\\0' character.
+
+    \returns The strlen() function returns the number of characters in
+    src.  */
 extern size_t strlen(const char *) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strlwr(char *s)
+    \brief Convert a string to lower case.
+
+    The strlwr() function will convert a string to lower case. Only the upper
+    case alphabetic characters [A .. Z] are converted.  Non-alphabetic
+    characters will not be changed.
+
+    \returns The strlwr() function returns a pointer to the converted
+    string. */
 extern char *strlwr(char *);
+
+/** \ingroup avr_string
+    \fn char *strncat(char *dest, const char *src, size_t len)
+    \brief Concatenate two strings.
+
+    The strncat() function is similar to strcat(), except that only the first
+    n characters of src are appended to dest.
+
+    \returns The strncat() function returns a pointer to the resulting string
+    dest.  */
 extern char *strncat(char *, const char *, size_t);
+
+/** \ingroup avr_string
+    \fn int strncmp(const char *s1, const char *s2, size_t len)
+    \brief Compare two strings.
+
+    The strncmp() function is similar to strcmp(), except it only compares the
+    first (at most) n characters of s1 and s2.
+
+    \returns The strncmp() function returns an integer less than, equal to, or
+    greater than zero if s1 (or the first n bytes thereof) is found,
+    respectively, to be less than, to match, or be greater than s2.  */
 extern int strncmp(const char *, const char *, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strncpy(char *dest, const char *src, size_t len)
+    \brief Copy a string.
+
+    The strncpy() function is similar to strcpy(), except that not more than n
+    bytes of src are copied. Thus, if there is no null byte among the first n
+    bytes of src, the result will not be null-terminated.
+
+    In the case where the length of src is less than that of n, the remainder
+    of dest will be padded with nulls.
+
+    \returns The strncpy() function returns a pointer to the destination
+    string dest.  */
 extern char *strncpy(char *, const char *, size_t);
+
+/** \ingroup avr_string
+    \fn int strncasecmp(const char *s1, const char *s2, size_t len)
+    \brief Compare two strings ignoring case.
+
+    The strncasecmp() function is similar to strcasecmp(), except it
+    only compares the first \p len characters of \p s1.
+
+    \returns The strncasecmp() function returns an integer less than,
+    equal to, or greater than zero if \p s1 (or the first \p len bytes
+    thereof) is found, respectively, to be less than, to match, or be
+    greater than \p s2. A consequence of the ordering used by
+    strncasecmp() is that if \p s1 is an initial substring of \p s2,
+    then \p s1 is considered to be "less than" \p s2.  */
 extern int strncasecmp(const char *, const char *, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn size_t strnlen(const char *src, size_t len)
+    \brief Determine the length of a fixed-size string.
+
+    The strnlen function returns the number of characters in the string
+    pointed to by src, not including the terminating '\\0' character, but at
+    most len. In doing this, strnlen looks only at the first len characters at
+    src and never beyond src+len.
+
+    \returns The strnlen function returns strlen(src), if that is less than
+    len, or len if there is no '\\0' character among the first len
+    characters pointed to by src. */
 extern size_t strnlen(const char *, size_t) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strpbrk(const char *s, const char *accept)
+
+    The strpbrk() function locates the first occurrence in the string
+    \p s of any of the characters in the string \p accept.
+
+    \return  The strpbrk() function returns a pointer to the character
+    in \p s that matches one of the characters in \p accept, or \c NULL
+    if no such character is found. The terminating zero is not
+    considered as a part of string: if one or both args are empty, the
+    result will be \c NULL. */
 extern char *strpbrk(const char *__s, const char *__accept) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strrchr(const char *src, int val)
+    \brief Locate character in string.
+
+    The strrchr() function returns a pointer to the last occurrence of the
+    character val in the string src.
+
+    Here "character" means "byte" - these functions do not work with wide or
+    multi-byte characters.
+
+    \returns The strrchr() function returns a pointer to the matched character
+    or NULL if the character is not found. */
 extern char *strrchr(const char *, int) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strrev(char *s)
+    \brief Reverse a string.
+
+    The strrev() function reverses the order of the string.
+
+    \returns The strrev() function returns a pointer to the beginning of the
+    reversed string.  */
 extern char *strrev(char *);
+
+/** \ingroup avr_string
+    \fn char *strsep(char **sp, const char *delim)
+    \brief Parse a string into tokens.
+
+    The strsep() function locates, in the string referenced by \p *sp,
+    the first occurrence of any character in the string \p delim (or the
+    terminating '\\0' character) and replaces it with a '\\0'.  The
+    location of the next character after the delimiter character (or \c
+    NULL, if the end of the string was reached) is stored in \p *sp. An
+    ``empty'' field, i.e. one caused by two adjacent delimiter
+    characters, can be detected by comparing the location referenced by
+    the pointer returned in \p *sp to '\\0'.
+
+    \return The strsep() function returns a pointer to the original
+    value of \p *sp. If \p *sp is initially \c NULL, strsep() returns
+    \c NULL. */
 extern char *strsep(char **, const char *);
+
+/** \ingroup avr_string
+    \fn size_t strspn(const char *s, const char *accept)
+
+    The strspn() function calculates the length of the initial segment
+    of \p s which consists entirely of characters in \p accept.
+
+    \return  The strspn() function returns the number of characters in
+    the initial segment of \p s which consist only of characters from \p
+    accept. The terminating zero is not considered as a part of string. */
 extern size_t strspn(const char *__s, const char *__accept) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strstr(const char *s1, const char *s2)
+    \brief Locate a substring.
+
+    The strstr() function finds the first occurrence of the substring \p
+    s2 in the string \p s1.  The terminating '\\0' characters are not
+    compared.
+
+    \returns The strstr() function returns a pointer to the beginning of
+    the substring, or \c NULL if the substring is not found. If \p s2
+    points to a string of zero length, the function returns \p s1. */
 extern char *strstr(const char *, const char *) __ATTR_PURE__;
+
+/** \ingroup avr_string
+    \fn char *strtok(char *s, const char *delim)
+    \brief Parses the string s into tokens.
+
+    strtok parses the string s into tokens. The first call to strtok
+    should have s as its first argument. Subsequent calls should have
+    the first argument set to NULL. If a token ends with a delimiter, this
+    delimiting character is overwritten with a '\\0' and a pointer to the next
+    character is saved for the next call to strtok. The delimiter string
+    delim may be different for each call.
+
+    \returns The strtok() function returns a pointer to the next token or
+    NULL when no more tokens are found.
+
+    \note strtok() is NOT reentrant. For a reentrant version of this function
+    see \c strtok_r().
+*/
 extern char *strtok(char *, const char *);
+
+/** \ingroup avr_string
+    \fn char *strtok_r(char *string, const char *delim, char **last)
+    \brief Parses string into tokens.
+
+    strtok_r parses string into tokens. The first call to strtok_r
+    should have string as its first argument. Subsequent calls should have
+    the first argument set to NULL. If a token ends with a delimiter, this
+    delimiting character is overwritten with a '\\0' and a pointer to the next
+    character is saved for the next call to strtok_r. The delimiter string
+    \p delim may be different for each call. \p last is a user allocated char*
+    pointer. It must be the same while parsing the same string. strtok_r is
+    a reentrant version of strtok().
+
+    \returns The strtok_r() function returns a pointer to the next token or
+    NULL when no more tokens are found. */
 extern char *strtok_r(char *, const char *, char **);
+
+/** \ingroup avr_string
+    \fn char *strupr(char *s)
+    \brief Convert a string to upper case.
+
+    The strupr() function will convert a string to upper case. Only the lower
+    case alphabetic characters [a .. z] are converted.  Non-alphabetic
+    characters will not be changed.
+
+    \returns The strupr() function returns a pointer to the converted
+    string.  The pointer is the same as that passed in since the operation is
+    perform in place. */
 extern char *strupr(char *);
 
 #ifndef __DOXYGEN__
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/util/atomic.h avr-libc-r2546/include/util/atomic.h
--- avr-libc-2.0.0-orig/include/util/atomic.h	2010-06-10 19:48:28.000000000 +0400
+++ avr-libc-r2546/include/util/atomic.h	2018-05-22 08:52:05.000000000 +0400
@@ -29,7 +29,7 @@
   POSSIBILITY OF SUCH DAMAGE.
 */
 
-/* $Id: atomic.h 2158 2010-06-10 15:48:28Z joerg_wunsch $ */
+/* $Id: atomic.h 2541 2017-06-11 15:41:47Z joerg_wunsch $ */
 
 #ifndef _UTIL_ATOMIC_H_
 #define _UTIL_ATOMIC_H_ 1
@@ -94,8 +94,8 @@
     Interrupt Status (I) bit of the SREG register. Exit paths from
     both block types are all managed automatically without the need
     for special considerations, i. e. the interrupt status will be
-    restored to the same value it has been when entering the
-    respective block.
+    restored to the same value it had when entering the respective
+    block (unless ATOMIC_FORCEON or NONATOMIC_FORCEOFF are used).
 
     A typical example that requires atomic access is a 16 (or more)
     bit variable that is shared between the main execution path and an
@@ -250,9 +250,10 @@
 
     This is a possible parameter for ATOMIC_BLOCK. When used, it will
     cause the ATOMIC_BLOCK to force the state of the SREG register on
-    exit, enabling the Global Interrupt Status flag bit. This saves on
-    flash space as the previous value of the SREG register does not
-    need to be saved at the start of the block.
+    exit, enabling the Global Interrupt Status flag bit. This saves a
+    small amout of flash space, a register, and one or more processor
+    cycles, since the previous value of the SREG register does not need
+    to be saved at the start of the block.
 
     Care should be taken that ATOMIC_FORCEON is only used when it is
     known that interrupts are enabled before the block's execution or
@@ -290,7 +291,8 @@
     This is a possible parameter for NONATOMIC_BLOCK. When used, it
     will cause the NONATOMIC_BLOCK to force the state of the SREG
     register on exit, disabling the Global Interrupt Status flag
-    bit. This saves on flash space as the previous value of the SREG
+    bit.  This saves a small amout of flash space, a register, and one
+    or more processor cycles, since the previous value of the SREG
     register does not need to be saved at the start of the block.
 
     Care should be taken that NONATOMIC_FORCEOFF is only used when it
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/util/delay.h avr-libc-r2546/include/util/delay.h
--- avr-libc-2.0.0-orig/include/util/delay.h	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/include/util/delay.h	2018-05-22 09:41:58.711992200 +0400
@@ -0,0 +1,302 @@
+/* Copyright (c) 2002, Marek Michalkiewicz
+   Copyright (c) 2004,2005,2007 Joerg Wunsch
+   Copyright (c) 2007  Florin-Viorel Petrov
+   All rights reserved.
+
+   Redistribution and use in source and binary forms, with or without
+   modification, are permitted provided that the following conditions are met:
+
+   * Redistributions of source code must retain the above copyright
+     notice, this list of conditions and the following disclaimer.
+
+   * Redistributions in binary form must reproduce the above copyright
+     notice, this list of conditions and the following disclaimer in
+     the documentation and/or other materials provided with the
+     distribution.
+
+   * Neither the name of the copyright holders nor the names of
+     contributors may be used to endorse or promote products derived
+     from this software without specific prior written permission.
+
+  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+  POSSIBILITY OF SUCH DAMAGE. */
+
+/* $Id: delay.h.in 2506 2016-02-08 10:05:45Z joerg_wunsch $ */
+
+#ifndef _UTIL_DELAY_H_
+#define _UTIL_DELAY_H_ 1
+
+#ifndef __DOXYGEN__
+#  ifndef __HAS_DELAY_CYCLES
+#    define __HAS_DELAY_CYCLES 1
+#  endif
+#endif  /* __DOXYGEN__ */
+
+#include <inttypes.h>
+#include <util/delay_basic.h>
+#include <math.h>
+
+/** \file */
+/** \defgroup util_delay <util/delay.h>: Convenience functions for busy-wait delay loops
+    \code
+    #define F_CPU 1000000UL  // 1 MHz
+    //#define F_CPU 14.7456E6
+    #include <util/delay.h>
+    \endcode
+
+    \note As an alternative method, it is possible to pass the
+    F_CPU macro down to the compiler from the Makefile.
+    Obviously, in that case, no \c \#define statement should be
+    used.
+
+    The functions in this header file are wrappers around the basic
+    busy-wait functions from <util/delay_basic.h>.  They are meant as
+    convenience functions where actual time values can be specified
+    rather than a number of cycles to wait for.  The idea behind is
+    that compile-time constant expressions will be eliminated by
+    compiler optimization so floating-point expressions can be used
+    to calculate the number of delay cycles needed based on the CPU
+    frequency passed by the macro F_CPU.
+
+    \note In order for these functions to work as intended, compiler
+    optimizations <em>must</em> be enabled, and the delay time
+    <em>must</em> be an expression that is a known constant at
+    compile-time.  If these requirements are not met, the resulting
+    delay will be much longer (and basically unpredictable), and
+    applications that otherwise do not use floating-point calculations
+    will experience severe code bloat by the floating-point library
+    routines linked into the application.
+
+    The functions available allow the specification of microsecond, and
+    millisecond delays directly, using the application-supplied macro
+    F_CPU as the CPU clock frequency (in Hertz).
+
+*/
+
+#if !defined(__DOXYGEN__)
+static __inline__ void _delay_us(double __us) __attribute__((__always_inline__));
+static __inline__ void _delay_ms(double __ms) __attribute__((__always_inline__));
+#endif
+
+#ifndef F_CPU
+/* prevent compiler error by supplying a default */
+# warning "F_CPU not defined for <util/delay.h>"
+/** \ingroup util_delay
+    \def F_CPU
+    \brief CPU frequency in Hz
+
+    The macro F_CPU specifies the CPU frequency to be considered by
+    the delay macros.  This macro is normally supplied by the
+    environment (e.g. from within a project header, or the project's
+    Makefile).  The value 1 MHz here is only provided as a "vanilla"
+    fallback if no such user-provided definition could be found.
+
+    In terms of the delay functions, the CPU frequency can be given as
+    a floating-point constant (e.g. 3.6864E6 for 3.6864 MHz).
+    However, the macros in <util/setbaud.h> require it to be an
+    integer value.
+ */
+# define F_CPU 1000000UL
+#endif
+
+#ifndef __OPTIMIZE__
+# warning "Compiler optimizations disabled; functions from <util/delay.h> won't work as designed"
+#endif
+
+#if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
+  !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
+  __STDC_HOSTED__
+#  include <math.h>
+#endif
+
+/**
+   \ingroup util_delay
+
+   Perform a delay of \c __ms milliseconds, using _delay_loop_2().
+
+   The macro F_CPU is supposed to be defined to a
+   constant defining the CPU clock frequency (in Hertz).
+
+   The maximal possible delay is 262.14 ms / F_CPU in MHz.
+
+   When the user request delay which exceed the maximum possible one,
+   _delay_ms() provides a decreased resolution functionality. In this
+   mode _delay_ms() will work with a resolution of 1/10 ms, providing
+   delays up to 6.5535 seconds (independent from CPU frequency).  The
+   user will not be informed about decreased resolution.
+
+   If the avr-gcc toolchain has __builtin_avr_delay_cycles()
+   support, maximal possible delay is 4294967.295 ms/ F_CPU in MHz. For
+   values greater than the maximal possible delay, overflows results in
+   no delay i.e., 0ms.
+
+   Conversion of \c __ms into clock cycles may not always result in
+   integer.  By default, the clock cycles rounded up to next
+   integer. This ensures that the user gets at least \c __ms
+   microseconds of delay.
+
+   Alternatively, by defining the macro \c __DELAY_ROUND_DOWN__, or
+   \c __DELAY_ROUND_CLOSEST__, before including this header file, the
+   algorithm can be made to round down, or round to closest integer,
+   respectively.
+
+   \note
+
+   The implementation of _delay_ms() based on
+   __builtin_avr_delay_cycles() is not backward compatible with older
+   implementations.  In order to get functionality backward compatible
+   with previous versions, the macro \c "__DELAY_BACKWARD_COMPATIBLE__"
+   must be defined before including this header file. Also, the
+   backward compatible algorithm will be chosen if the code is
+   compiled in a <em>freestanding environment</em> (GCC option
+   \c -ffreestanding), as the math functions required for rounding are
+   not available to the compiler then.
+
+ */
+void
+_delay_ms(double __ms)
+{
+	double __tmp ;
+#if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
+  !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
+  __STDC_HOSTED__
+	uint32_t __ticks_dc;
+	extern void __builtin_avr_delay_cycles(unsigned long);
+	__tmp = ((F_CPU) / 1e3) * __ms;
+
+	#if defined(__DELAY_ROUND_DOWN__)
+		__ticks_dc = (uint32_t)fabs(__tmp);
+
+	#elif defined(__DELAY_ROUND_CLOSEST__)
+		__ticks_dc = (uint32_t)(fabs(__tmp)+0.5);
+
+	#else
+		//round up by default
+		__ticks_dc = (uint32_t)(ceil(fabs(__tmp)));
+	#endif
+
+	__builtin_avr_delay_cycles(__ticks_dc);
+
+#else
+	uint16_t __ticks;
+	__tmp = ((F_CPU) / 4e3) * __ms;
+	if (__tmp < 1.0)
+		__ticks = 1;
+	else if (__tmp > 65535)
+	{
+		//	__ticks = requested delay in 1/10 ms
+		__ticks = (uint16_t) (__ms * 10.0);
+		while(__ticks)
+		{
+			// wait 1/10 ms
+			_delay_loop_2(((F_CPU) / 4e3) / 10);
+			__ticks --;
+		}
+		return;
+	}
+	else
+		__ticks = (uint16_t)__tmp;
+	_delay_loop_2(__ticks);
+#endif
+}
+
+/**
+   \ingroup util_delay
+
+   Perform a delay of \c __us microseconds, using _delay_loop_1().
+
+   The macro F_CPU is supposed to be defined to a
+   constant defining the CPU clock frequency (in Hertz).
+
+   The maximal possible delay is 768 us / F_CPU in MHz.
+
+   If the user requests a delay greater than the maximal possible one,
+   _delay_us() will automatically call _delay_ms() instead.  The user
+   will not be informed about this case.
+
+   If the avr-gcc toolchain has __builtin_avr_delay_cycles()
+   support, maximal possible delay is 4294967.295 us/ F_CPU in MHz. For
+   values greater than the maximal possible delay, overflow results in
+   no delay i.e., 0us.
+
+   Conversion of \c __us into clock cycles may not always result in
+   integer.  By default, the clock cycles rounded up to next
+   integer. This ensures that the user gets at least \c __us
+   microseconds of delay.
+
+   Alternatively, by defining the macro \c __DELAY_ROUND_DOWN__, or
+   \c __DELAY_ROUND_CLOSEST__, before including this header file, the
+   algorithm can be made to round down, or round to closest integer,
+   respectively.
+
+   \note
+
+   The implementation of _delay_ms() based on
+   __builtin_avr_delay_cycles() is not backward compatible with older
+   implementations.  In order to get functionality backward compatible
+   with previous versions, the macro \c __DELAY_BACKWARD_COMPATIBLE__
+   must be defined before including this header file. Also, the
+   backward compatible algorithm will be chosen if the code is
+   compiled in a <em>freestanding environment</em> (GCC option
+   \c -ffreestanding), as the math functions required for rounding are
+   not available to the compiler then.
+
+ */
+void
+_delay_us(double __us)
+{
+	double __tmp ;
+#if __HAS_DELAY_CYCLES && defined(__OPTIMIZE__) && \
+  !defined(__DELAY_BACKWARD_COMPATIBLE__) &&	   \
+  __STDC_HOSTED__
+	uint32_t __ticks_dc;
+	extern void __builtin_avr_delay_cycles(unsigned long);
+	__tmp = ((F_CPU) / 1e6) * __us;
+
+	#if defined(__DELAY_ROUND_DOWN__)
+		__ticks_dc = (uint32_t)fabs(__tmp);
+
+	#elif defined(__DELAY_ROUND_CLOSEST__)
+		__ticks_dc = (uint32_t)(fabs(__tmp)+0.5);
+
+	#else
+		//round up by default
+		__ticks_dc = (uint32_t)(ceil(fabs(__tmp)));
+	#endif
+
+	__builtin_avr_delay_cycles(__ticks_dc);
+
+#else
+	uint8_t __ticks;
+	double __tmp2 ;
+	__tmp = ((F_CPU) / 3e6) * __us;
+	__tmp2 = ((F_CPU) / 4e6) * __us;
+	if (__tmp < 1.0)
+		__ticks = 1;
+	else if (__tmp2 > 65535)
+	{
+		_delay_ms(__us / 1000.0);
+	}
+	else if (__tmp > 255)
+	{
+		uint16_t __ticks=(uint16_t)__tmp2;
+		_delay_loop_2(__ticks);
+		return;
+	}
+	else
+		__ticks = (uint8_t)__tmp;
+	_delay_loop_1(__ticks);
+#endif
+}
+
+
+#endif /* _UTIL_DELAY_H_ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/include/util/eu_dst.h avr-libc-r2546/include/util/eu_dst.h
--- avr-libc-2.0.0-orig/include/util/eu_dst.h	2016-01-25 22:25:12.000000000 +0300
+++ avr-libc-r2546/include/util/eu_dst.h	2018-05-22 08:52:05.000000000 +0400
@@ -26,7 +26,7 @@
  * POSSIBILITY OF SUCH DAMAGE.
  */
 
-/* $Id: eu_dst.h 2492 2015-10-27 09:07:56Z swfltek $ */
+/* $Id: eu_dst.h 2537 2017-03-31 19:46:35Z joerg_wunsch $ */
 
 /**
     Daylight Saving function for the European Union. To utilize this function, you must
@@ -88,24 +88,25 @@
                         n = 31 - d;
                         n /= 7; /* number of Sundays left in the month */
 
-                        d = d + 7 * n;  /* mday of final Sunday */
+                        d = d + 7 * n;  /* d: mday of final Sunday */
 
         if              (month == MARCH) {
-            if (d < mday)
+            if (mday < d) /* before last Sunday */
                 return 0;
-            if (d > mday)
+            if (mday > d) /* past last Sunday */
                 return ONE_HOUR;
-            if (hour < 2)
+            if (hour < 2) /* at last Sunday, before switching */
                 return 0;
-            return ONE_HOUR;
+            return ONE_HOUR; /* at last Sunday, after switching */
         }
-        if              (d < mday)
+	/* month == OCTOBER */
+        if              (mday < d) /* before last Sunday */
                             return ONE_HOUR;
-        if              (d > mday)
+        if              (mday > d) /* past last Sunday */
                             return 0;
-        if              (hour < 2)
+        if              (hour < 2) /* at last Sunday, before switching */
                             return ONE_HOUR;
-                        return 0;
+                        return 0; /* at last Sunday, after switchin */
 
     }
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/ccp_write.S avr-libc-r2546/libc/misc/ccp_write.S
--- avr-libc-2.0.0-orig/libc/misc/ccp_write.S	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/libc/misc/ccp_write.S	2018-05-22 08:51:58.000000000 +0400
@@ -0,0 +1,27 @@
+#ifndef __DOXYGEN__
+
+#include <avr/io.h>
+
+#if __AVR_XMEGA__
+
+# ifndef CCP_IOREG_gc
+#  define CCP_IOREG_gc	0xD8	/* IO Register Protection	*/
+# endif
+
+#include "asmdef.h"
+
+/*  void ccp_write_io (uint8_t *__ioaddr, uint8_t __value)
+ */
+ENTRY	ccp_write_io
+	; r24,25 - __ioaddr
+	; r22    - __value
+	X_movw	r26, r24			; load io addr into X
+	ldi		r18, CCP_IOREG_gc	; load IO reg change protection signature
+	sts		CCP, r18
+	st		x, r22				; write __value to __ioaddr
+	ret
+ENDFUNC
+
+#endif  /* __AVR_XMEGA__ && CCP_IOREG_gc */ 
+#endif  /* !__DOXYGEN__ */
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/eewr_block.S avr-libc-r2546/libc/misc/eewr_block.S
--- avr-libc-2.0.0-orig/libc/misc/eewr_block.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/misc/eewr_block.S	2018-05-22 08:51:59.000000000 +0400
@@ -26,7 +26,7 @@
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.	*/
 
-/* $Id: eewr_block.S 1979 2009-06-05 23:08:14Z dmix $	*/
+/* $Id: eewr_block.S 2528 2016-11-29 11:29:15Z pitchumani $	*/
 
 #ifndef	__DOXYGEN__
 
@@ -34,6 +34,9 @@
 
 #if	E2END && __AVR_ARCH__ > 1
 
+/* Skip for Xmega with valid page size. Refer. eewr_block_xmega.c.  */
+#if !(__AVR_XMEGA__ && defined (E2PAGESIZE) && (E2PAGESIZE))
+
 #include <avr/eeprom.h>
 #include "asmdef.h"
 #include "eedef.h"
@@ -71,6 +73,6 @@
 	ret
 
 ENDFUNC
-
+#endif  /* All except __AVR_XMEGA__ && E2PAGESIZE */
 #endif	/* E2END && __AVR_ARCH__ > 1 */
 #endif	/* !__DOXYGEN__ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/eewr_block_xmega.c avr-libc-r2546/libc/misc/eewr_block_xmega.c
--- avr-libc-2.0.0-orig/libc/misc/eewr_block_xmega.c	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/libc/misc/eewr_block_xmega.c	2018-05-22 08:51:59.000000000 +0400
@@ -0,0 +1,82 @@
+/* $Id$ */
+#ifndef __DOXYGEN__
+
+#include <avr/io.h>
+
+#if E2END && __AVR_XMEGA__ && defined(E2PAGESIZE) && (E2PAGESIZE)
+
+#include <assert.h>
+#include "sectionname.h"
+#include <avr/eeprom.h>
+
+extern void ccp_write_io (volatile uint8_t *__ioaddr, uint8_t __value);
+
+ATTRIBUTE_CLIB_SECTION
+static void
+eeprom_write_page (const uint8_t *sram, uint16_t eeprom_addr,
+					uint8_t byte_position, uint8_t nbytes)
+{
+  assert (eeprom_addr <= (uint16_t)(E2END - nbytes));
+
+  uint8_t i = byte_position;
+  uint8_t data_index = 0;
+
+  /* Wait till nvm is ready.  */
+  do {
+  } while ((NVM.STATUS & NVM_NVMBUSY_bm) == NVM_NVMBUSY_bm);
+
+  while (data_index < nbytes)
+  {
+    do {
+    } while ((NVM.STATUS & NVM_NVMBUSY_bm) == NVM_NVMBUSY_bm);
+
+
+    #if defined (NVM_EEMAPEN_bm)
+    /* enable memory map.  */
+    NVM_CTRLB = NVM_CTRLB | NVM_EEMAPEN_bm;
+    #endif
+
+    /* Load byte into page buffer.  */
+    *((uint8_t*)MAPPED_EEPROM_START + i) = sram[data_index];
+
+    data_index++;
+    i++;
+
+    #if defined (NVM_EEMAPEN_bm)
+    /* disable memory map.  */
+    NVM_CTRLB = NVM_CTRLB & ~NVM_EEMAPEN_bm;
+    #endif
+  }
+
+  /* Load eeprom address.  */
+  #if defined (NVM_ADDR2)
+    NVM.ADDR2 = 0;
+  #endif
+  NVM.ADDR1 = ((eeprom_addr >> 8) & 0xff);
+  NVM.ADDR0 = ((eeprom_addr & 0xff));
+  /* Issue EEPROM erase and write command.  */
+  NVM.CMD = NVM_CMD_ERASE_WRITE_EEPROM_PAGE_gc;
+  ccp_write_io (&NVM.CTRLA, NVM_CMDEX_bm);
+}
+
+/* void eeprom_write_block (const void *sram, void *eeprom_addr, size_t length)
+ */
+ATTRIBUTE_CLIB_SECTION
+void eeprom_write_block (const void *sram, void *eeprom_addr, size_t length)
+{
+  while (length)
+  {
+    uint8_t byte_position = ((uint16_t)eeprom_addr & (E2PAGESIZE-1));
+    uint8_t nbytes = E2PAGESIZE - byte_position;
+    nbytes = nbytes > length ? length : nbytes;
+    eeprom_write_page ((uint8_t*)sram, (uint16_t)eeprom_addr,
+                       byte_position, nbytes);
+    sram = (uint8_t*)sram + nbytes;
+    eeprom_addr = (uint8_t*)eeprom_addr + nbytes;
+    length -= nbytes;
+  }
+}
+
+#endif  /* E2END && __AVR_XMEGA__ && E2PAGESIZE */
+#endif  /* !__DOXYGEN__ */
+
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/Files.am avr-libc-r2546/libc/misc/Files.am
--- avr-libc-2.0.0-orig/libc/misc/Files.am	2012-08-14 17:41:46.000000000 +0400
+++ avr-libc-r2546/libc/misc/Files.am	2018-05-22 08:51:58.000000000 +0400
@@ -26,11 +26,14 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 #
-# $Id: Files.am 2298 2012-07-29 15:30:34Z dmix $
+# $Id: Files.am 2528 2016-11-29 11:29:15Z pitchumani $
 #
 
 misc_a_c_sources =
 
+eeprom_c_sources = \
+	eewr_block_xmega.c
+
 eeprom_asm_sources = \
 	eerd_block.S \
 	eerd_byte.S \
@@ -45,6 +48,11 @@
 	eewr_dword.S \
 	eewr_word.S
 
+dev_c_sources =
+
+dev_asm_sources = \
+	ccp_write.S
+
 misc_a_asm_sources = \
 	itoa.S \
 	itoa_ncheck.S \
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/itoa.S avr-libc-r2546/libc/misc/itoa.S
--- avr-libc-2.0.0-orig/libc/misc/itoa.S	2014-08-10 14:43:26.000000000 +0400
+++ avr-libc-r2546/libc/misc/itoa.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,10 +26,9 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: itoa.S 2420 2014-04-28 14:05:10Z pitchumani $	*/
+/* $Id: itoa.S 2542 2017-06-12 22:08:58Z joerg_wunsch $	*/
 
 #if	!defined (__DOXYGEN__)
-#if	!defined (__AVR_TINY__)
 
 #include "asmdef.h"
 
@@ -60,5 +59,4 @@
 
 ENDFUNC
 
-#endif	/* !__AVR_TINY__ */
 #endif	/* !__DOXYGEN__ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/itoa_ncheck.S avr-libc-r2546/libc/misc/itoa_ncheck.S
--- avr-libc-2.0.0-orig/libc/misc/itoa_ncheck.S	2014-08-10 14:43:26.000000000 +0400
+++ avr-libc-r2546/libc/misc/itoa_ncheck.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,10 +26,9 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: itoa_ncheck.S 2420 2014-04-28 14:05:10Z pitchumani $	*/
+/* $Id: itoa_ncheck.S 2542 2017-06-12 22:08:58Z joerg_wunsch $	*/
 
 #if	!defined (__DOXYGEN__)
-#if	!defined (__AVR_TINY__)
 
 #include "asmdef.h"
 
@@ -60,5 +59,4 @@
 
 ENDFUNC
 
-#endif	/* !__AVR_TINY__ */
 #endif	/* !__DOXYGEN__ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/Makefile.am avr-libc-r2546/libc/misc/Makefile.am
--- avr-libc-2.0.0-orig/libc/misc/Makefile.am	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/misc/Makefile.am	2018-05-22 08:51:59.000000000 +0400
@@ -26,13 +26,16 @@
 # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 # POSSIBILITY OF SUCH DAMAGE.
 #
-# $Id: Makefile.am 1981 2009-06-05 23:13:29Z dmix $
+# $Id: Makefile.am 2528 2016-11-29 11:29:15Z pitchumani $
 #
 
 include $(top_srcdir)/libc/misc/Files.am
 
 EXTRA_DIST = \
+	$(eeprom_c_sources) \
 	$(eeprom_asm_sources) \
+	$(dev_c_sources) \
+	$(dev_asm_sources) \
 	$(misc_a_asm_sources) \
 	$(misc_a_c_sources) \
 	$(misc_a_extra_dist)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/utoa.S avr-libc-r2546/libc/misc/utoa.S
--- avr-libc-2.0.0-orig/libc/misc/utoa.S	2014-08-10 14:43:26.000000000 +0400
+++ avr-libc-r2546/libc/misc/utoa.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,10 +26,9 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: utoa.S 2420 2014-04-28 14:05:10Z pitchumani $	*/
+/* $Id: utoa.S 2542 2017-06-12 22:08:58Z joerg_wunsch $	*/
 
 #if	!defined (__DOXYGEN__)
-#if	!defined (__AVR_TINY__)
 
 #include "asmdef.h"
 
@@ -60,5 +59,4 @@
 
 ENDFUNC
 
-#endif	/* !__AVR_TINY__ */
 #endif	/* !__DOXYGEN__ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/misc/utoa_ncheck.S avr-libc-r2546/libc/misc/utoa_ncheck.S
--- avr-libc-2.0.0-orig/libc/misc/utoa_ncheck.S	2014-08-10 14:43:26.000000000 +0400
+++ avr-libc-r2546/libc/misc/utoa_ncheck.S	2018-05-22 08:51:59.000000000 +0400
@@ -26,10 +26,9 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: utoa_ncheck.S 2420 2014-04-28 14:05:10Z pitchumani $	*/
+/* $Id: utoa_ncheck.S 2542 2017-06-12 22:08:58Z joerg_wunsch $	*/
 
 #if	!defined (__DOXYGEN__)
-#if	!defined (__AVR_TINY__)
 
 #include "asmdef.h"
 
@@ -77,7 +76,7 @@
 	st	Z+, digit
 
     ; Iterate until all digits are sucked out of VAL.
-	sbiw	val_lo, 0
+	X_sbiw	val_lo, 0
 	brne	1b
 
     ; Store the sign (if any)
@@ -93,5 +92,4 @@
 
 ENDFUNC
 
-#endif	/* !__AVR_TINY__ */
 #endif	/* !__DOXYGEN__ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/stdlib/atof.S avr-libc-r2546/libc/stdlib/atof.S
--- avr-libc-2.0.0-orig/libc/stdlib/atof.S	2010-06-08 16:01:51.000000000 +0400
+++ avr-libc-r2546/libc/stdlib/atof.S	2018-05-22 08:52:02.000000000 +0400
@@ -26,17 +26,7 @@
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: atof.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \ingroup avr_stdlib
-    \fn  double atof (const char *nptr)
-
-    The atof() function converts the initial portion of the string pointed
-    to by \a nptr to double representation.
-
-    It is equivalent to calling
-	\code strtod(nptr, (char **)0); \endcode
- */
+/* $Id: atof.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #ifndef	__DOXYGEN__
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/ffs.S avr-libc-r2546/libc/string/ffs.S
--- avr-libc-2.0.0-orig/libc/string/ffs.S	2010-06-13 17:14:47.000000000 +0400
+++ avr-libc-r2546/libc/string/ffs.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,22 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: ffs.S 2166 2010-06-13 13:14:47Z joerg_wunsch $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn int ffs (int val);
-
-    \brief This function finds the first (least significant) bit set in the input value.
-
-    \returns The ffs() function returns the position of the first
-    (least significant) bit set in the word val, or 0 if no bits are set.
-    The least significant bit is position 1.
-
-    \note For expressions that are constant at compile time, consider
-    using the \ref _FFS macro instead.
-*/
+/* $Id: ffs.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #ifndef	__DOXYGEN__
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/ffsl.S avr-libc-r2546/libc/string/ffsl.S
--- avr-libc-2.0.0-orig/libc/string/ffsl.S	2010-06-13 17:14:47.000000000 +0400
+++ avr-libc-r2546/libc/string/ffsl.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,14 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: ffsl.S 2166 2010-06-13 13:14:47Z joerg_wunsch $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn int ffsl (long val);
-
-    \brief Same as ffs(), for an argument of type long.	*/
+/* $Id: ffsl.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #ifndef	__DOXYGEN__
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/ffsll.S avr-libc-r2546/libc/string/ffsll.S
--- avr-libc-2.0.0-orig/libc/string/ffsll.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/ffsll.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,17 +26,10 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: ffsll.S 2191 2010-11-05 13:45:57Z arcanum $ */
+/* $Id: ffsll.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__AVR_TINY__)
 
-/** \file */
-
-/** \ingroup avr_string
-    \fn int ffsll (long long val);
-
-    \brief Same as ffs(), for an argument of type long long.	*/
-
 #ifndef	__DOXYGEN__
 
 #include "macros.inc"
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memccpy.S avr-libc-r2546/libc/string/memccpy.S
--- avr-libc-2.0.0-orig/libc/string/memccpy.S	2016-02-08 01:59:50.000000000 +0300
+++ avr-libc-r2546/libc/string/memccpy.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memccpy.S 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn void *memccpy(void *dest, const void *src, int val, size_t len)
-    \brief Copy memory area.
-
-    The memccpy() function copies no more than \p len bytes from memory
-    area \p src to memory area \p dest, stopping when the character \p val
-    is found.
-
-    \returns The memccpy() function returns a pointer to the next character
-    in \p dest after \p val, or NULL if \p val was not found in the first
-    \p len characters of \p src.	*/
+/* $Id: memccpy.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memchr.S avr-libc-r2546/libc/string/memchr.S
--- avr-libc-2.0.0-orig/libc/string/memchr.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/memchr.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memchr.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-	\fn void *memchr(const void *src, int val, size_t len)
-    \brief Scan memory for a character.
-
-    The memchr() function scans the first len bytes of the memory area pointed
-    to by src for the character val.  The first byte to match val (interpreted
-    as an unsigned character) stops the operation.
-
-    \returns The memchr() function returns a pointer to the matching byte or
-    NULL if the character does not occur in the given memory area.  */
-
-#if !defined(__AVR_TINY__)
+/* $Id: memchr.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -68,7 +54,12 @@
 	ld	__tmp_reg__, Z+
 	cp	__tmp_reg__, val_lo
 	brne	.L_memchr_loop
-	sbiw	ZL, 1		; undo post-increment
+	; undo post-increment
+#if !defined(__AVR_TINY__)
+	sbiw	ZL, 1
+#else
+	ld	__tmp_reg__, -Z
+#endif /*!__AVR_TINY__*/
 	X_movw	ret_lo, ZL
 	ret
 .L_memchr_notfound:
@@ -79,5 +70,3 @@
 	.size	_U(memchr), .L_memchr_end - _U(memchr)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memcmp.S avr-libc-r2546/libc/string/memcmp.S
--- avr-libc-2.0.0-orig/libc/string/memcmp.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/memcmp.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,25 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
   
-/* $Id: memcmp.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn int memcmp(const void *s1, const void *s2, size_t len)
-    \brief Compare memory areas
-    
-    The memcmp() function compares the first len bytes of the memory areas s1
-    and s2. The comparision is performed using unsigned char operations.
-    
-    \returns The memcmp() function returns an integer less than, equal to, or
-    greater than zero if the first len bytes of s1 is found, respectively, to be
-    less than, to match, or be greater than the first len bytes of s2.
-
-    \note Be sure to store the result in a 16 bit variable since you may get
-    incorrect results if you use an unsigned char or char due to truncation.
-
-    \warning This function is not -mint8 compatible, although if you only care
-    about testing for equality, this function should be safe to use. */
+/* $Id: memcmp.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memcpy.S avr-libc-r2546/libc/string/memcpy.S
--- avr-libc-2.0.0-orig/libc/string/memcpy.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/memcpy.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,18 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memcpy.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn void *memcpy(void *dest, const void *src, size_t len)
-    \brief Copy a memory area.
-
-    The memcpy() function copies len bytes from memory area src to memory area
-    dest.  The memory areas may not overlap.  Use memmove() if the memory
-    areas do overlap.
-
-    \returns The memcpy() function returns a pointer to dest.  */
+/* $Id: memcpy.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memmem.S avr-libc-r2546/libc/string/memmem.S
--- avr-libc-2.0.0-orig/libc/string/memmem.S	2016-02-08 01:59:50.000000000 +0300
+++ avr-libc-r2546/libc/string/memmem.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,20 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memmem.S 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn void *memmem(const void *s1, size_t len1, const void *s2, size_t len2)
-
-    The memmem() function finds the start of the first occurrence of the
-    substring \p s2 of length \p len2 in the memory area \p s1 of length
-    \p len1.
-
-    \return The memmem() function returns a pointer to the beginning of
-    the substring, or \c NULL if the substring is not found. If \p len2
-    is zero, the function returns \p s1.	*/
+/* $Id: memmem.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__AVR_TINY__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memmove.S avr-libc-r2546/libc/string/memmove.S
--- avr-libc-2.0.0-orig/libc/string/memmove.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/memmove.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,17 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memmove.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn void *memmove(void *dest, const void *src, size_t len)
-    \brief Copy memory area.
-
-    The memmove() function copies len bytes from memory area src to memory area
-    dest.  The memory areas may overlap.
-
-    \returns The memmove() function returns a pointer to dest.  */
+/* $Id: memmove.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memrchr.S avr-libc-r2546/libc/string/memrchr.S
--- avr-libc-2.0.0-orig/libc/string/memrchr.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/memrchr.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memrchr.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn void *memrchr(const void *src, int val, size_t len)
-
-    The memrchr() function is like the memchr() function, except that it
-    searches backwards from the end of the \p len bytes pointed to by \p
-    src instead of forwards from the front. (Glibc, GNU extension.)
-
-    \return The memrchr() function returns a pointer to the matching
-    byte or \c NULL if the character does not occur in the given memory
-    area.	*/
-
-#if !defined(__AVR_TINY__)
+/* $Id: memrchr.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -56,13 +42,13 @@
 
 ENTRY memrchr
 	X_movw	ZL, len_lo
-	adiw	ZL, 0
+	X_sbiw	ZL, 0
 	breq	2f			; len is 0, return NULL
 	add	ZL, src_lo
 	adc	ZH, src_hi
 
-1:	ld	r0, -Z
-	cp	r0, val
+1:	ld	__tmp_reg__, -Z
+	cp	__tmp_reg__, val
 	breq	2f			; val is found
 	subi	len_lo, lo8(1)
 	sbci	len_hi, hi8(1)
@@ -74,5 +60,3 @@
 ENDFUNC
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/memset.S avr-libc-r2546/libc/string/memset.S
--- avr-libc-2.0.0-orig/libc/string/memset.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/memset.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,17 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: memset.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn void *memset(void *dest, int val, size_t len)
-    \brief Fill memory with a constant byte.
-
-    The memset() function fills the first len bytes of the memory area pointed
-    to by dest with the constant byte val.
-
-    \returns The memset() function returns a pointer to the memory area dest. */
+/* $Id: memset.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strcasecmp.S avr-libc-r2546/libc/string/strcasecmp.S
--- avr-libc-2.0.0-orig/libc/string/strcasecmp.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strcasecmp.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strcasecmp.S 1944 2009-04-01 23:12:20Z arcanum $ */
+/* $Id: strcasecmp.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 /*
    strcasecmp.S
@@ -36,21 +36,6 @@
    Contributors:
      Created by Reiner Patommel
 */
-/** \file */
-
-/** \ingroup avr_string
-    \fn int strcasecmp(const char *s1, const char *s2)
-    \brief Compare two strings ignoring case.
-
-    The strcasecmp() function compares the two strings \p s1 and \p s2,
-    ignoring the case of the characters.
-
-    \returns The strcasecmp() function returns an integer less than,
-    equal to, or greater than zero if \p s1 is found, respectively, to
-    be less than, to match, or be greater than \p s2. A consequence of
-    the ordering used by strcasecmp() is that if \p s1 is an initial
-    substring of \p s2, then \p s1 is considered to be "less than"
-    \p s2.	*/
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strcasestr.S avr-libc-r2546/libc/string/strcasestr.S
--- avr-libc-2.0.0-orig/libc/string/strcasestr.S	2016-02-08 01:59:50.000000000 +0300
+++ avr-libc-r2546/libc/string/strcasestr.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strcasestr.S 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strcasestr(const char *s1, const char *s2)
-
-    The strcasestr() function finds the first occurrence of the
-    substring \p s2 in the string \p s1. This is like strstr(), except
-    that it ignores case of alphabetic symbols in searching for the
-    substring. (Glibc, GNU extension.)
-
-    \return The strcasestr() function returns a pointer to the beginning
-    of the substring, or \c NULL if the substring is not found. If \p s2
-    points to a string of zero length, the function returns \p s1. */
+/* $Id: strcasestr.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__AVR_TINY__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strcat.S avr-libc-r2546/libc/string/strcat.S
--- avr-libc-2.0.0-orig/libc/string/strcat.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strcat.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,22 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strcat.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strcat(char *dest, const char *src)
-    \brief Concatenate two strings.
-
-    The strcat() function appends the src string to the dest string
-    overwriting the '\\0' character at the end of dest, and then adds a
-    terminating '\\0' character.  The strings may not overlap, and the dest
-    string must have enough space for the result.
-
-    \returns The strcat() function returns a pointer to the resulting string
-    dest.  */
-
-#if !defined(__AVR_TINY__)
+/* $Id: strcat.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -62,7 +47,12 @@
 	ld	__tmp_reg__, X+
 	tst	__tmp_reg__
 	brne	.L_strcat_skip
-	sbiw	XL, 1		; undo post-increment
+	; undo post-increment
+#if !defined(__AVR_TINY__)
+	sbiw	XL, 1
+#else
+	ld	__tmp_reg__, -X
+#endif /* !__AVR_TINY__ */
 .L_strcat_loop:
 	ld	__tmp_reg__, Z+
 	st	X+, __tmp_reg__
@@ -74,5 +64,3 @@
 	.size	_U(strcat), .L_strcat_end - _U(strcat)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strchr.S avr-libc-r2546/libc/string/strchr.S
--- avr-libc-2.0.0-orig/libc/string/strchr.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strchr.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,24 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strchr.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strchr(const char *src, int val)
-    \brief Locate character in string.
-
-    The strchr() function returns a pointer to the first occurrence of
-    the character \p val in the string \p src.
-
-    Here "character" means "byte" - these functions do not work with
-    wide or multi-byte characters.
-
-    \returns The strchr() function returns a pointer to the matched
-    character or \c NULL if the character is not found. */
-
-#if !defined(__AVR_TINY__)
+/* $Id: strchr.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -72,12 +55,15 @@
 	clr	ret_hi
 	ret
 .L_strchr_found:
-	sbiw	ZL, 1		; undo post-increment
+	; undo post-increment
+#if !defined(__AVR_TINY__)
+	sbiw	ZL, 1
+#else
+	ld	__tmp_reg__, -Z
+#endif /*!__AVR_TINY__*/
 	X_movw	ret_lo, ZL
 	ret
 .L_strchr_end:
 	.size	_U(strchr), .L_strchr_end - _U(strchr)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strchrnul.S avr-libc-r2546/libc/string/strchrnul.S
--- avr-libc-2.0.0-orig/libc/string/strchrnul.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strchrnul.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strchrnul.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strchrnul(const char *s, int c)
-
-    The strchrnul() function is like strchr() except that if \p c is not
-    found in \p s, then it returns a pointer to the null byte at the end
-    of \p s, rather than \c NULL. (Glibc, GNU extension.)
-
-    \return The strchrnul() function returns a pointer to the matched
-    character, or a pointer to the null byte at the end of \p s (i.e.,
-    \c s+strlen(s)) if the character is not found.	*/
-
-#if !defined(__AVR_TINY__)
+/* $Id: strchrnul.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -54,16 +40,18 @@
 ENTRY strchrnul
 	X_movw	ZL, src_lo
 
-1:	ld	r0, Z+
-	cp	r0, val
-	cpse	r0, __zero_reg__
+1:	ld	__tmp_reg__, Z+
+	cp	__tmp_reg__, val
+	cpse	__tmp_reg__, __zero_reg__
 	brne	1b
-
-	sbiw	ZL, 1		; undo post-increment
+	; undo post-increment
+#if !defined(__AVR_TINY__)
+	sbiw	ZL, 1
+#else
+	ld	__tmp_reg__, -Z
+#endif /* !__AVR_TINY__ */
 	X_movw	ret_lo, ZL
 	ret
 ENDFUNC
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strcmp.S avr-libc-r2546/libc/string/strcmp.S
--- avr-libc-2.0.0-orig/libc/string/strcmp.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strcmp.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strcmp.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn int strcmp(const char *s1, const char *s2)
-    \brief Compare two strings.
-
-    The strcmp() function compares the two strings \p s1 and \p s2.
-
-    \returns The strcmp() function returns an integer less than, equal
-    to, or greater than zero if \p s1 is found, respectively, to be less
-    than, to match, or be greater than \p s2. A consequence of the
-    ordering used by strcmp() is that if \p s1 is an initial substring
-    of \p s2, then \p s1 is considered to be "less than" \p s2.	*/
+/* $Id: strcmp.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strcpy.S avr-libc-r2546/libc/string/strcpy.S
--- avr-libc-2.0.0-orig/libc/string/strcpy.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strcpy.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,25 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strcpy.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strcpy(char *dest, const char *src)
-    \brief Copy a string.
-
-    The strcpy() function copies the string pointed to by src (including the
-    terminating '\\0' character) to the array pointed to by dest.  The strings
-    may not overlap, and the destination string dest must be large enough to
-    receive the copy.
-
-    \returns The strcpy() function returns a pointer to the destination
-    string dest. 
-
-    \note If the destination string of a strcpy() is not large enough (that
-    is, if the programmer was stupid/lazy, and failed to check the size before
-    copying) then anything might happen.  Overflowing fixed length strings is
-    a favourite cracker technique. */
+/* $Id: strcpy.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strcspn.S avr-libc-r2546/libc/string/strcspn.S
--- avr-libc-2.0.0-orig/libc/string/strcspn.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strcspn.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,18 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strcspn.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn size_t strcspn(const char *s, const char *reject)
-    
-    The strcspn() function calculates the length of the initial segment
-    of \p s which consists entirely of characters not in \p reject.
-
-    \return The strcspn() function returns the number of characters in
-    the initial segment of \p s which are not in the string \p reject.
-    The terminating zero is not considered as a part of string.	*/
+/* $Id: strcspn.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__AVR_TINY__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strdup.c avr-libc-r2546/libc/string/strdup.c
--- avr-libc-2.0.0-orig/libc/string/strdup.c	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strdup.c	2018-05-22 08:51:58.000000000 +0400
@@ -26,32 +26,12 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strdup.c 1944 2009-04-01 23:12:20Z arcanum $ */
+/* $Id: strdup.c 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #include <stdlib.h>
 #include <string.h>
 #include "sectionname.h"
 
-/** \file */
-/** \ingroup avr_string
-    \fn char *strdup(const char *s1)
-    \brief Duplicate a string.
-
-    The strdup() function allocates memory and copies into it the string
-    addressed by s1, including the terminating null character.
-
-    \warning The strdup() function calls malloc() to allocate the memory
-    for the duplicated string! The user is responsible for freeing the
-    memory by calling free(). 
-    
-    \returns The strdup() function returns a pointer to the resulting string
-    dest. If malloc() cannot allocate enough storage for the string, strdup() 
-    will return NULL.
-
-    \warning Be sure to check the return value of the strdup() function to
-    make sure that the function has succeeded in allocating the memory!
-*/
-
 ATTRIBUTE_CLIB_SECTION
 char *
 strdup(const char *s1)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strlcat.S avr-libc-r2546/libc/string/strlcat.S
--- avr-libc-2.0.0-orig/libc/string/strlcat.S	2011-12-29 11:54:51.000000000 +0400
+++ avr-libc-r2546/libc/string/strlcat.S	2018-05-22 08:51:58.000000000 +0400
@@ -33,23 +33,7 @@
 
 */
 
-/* $Id: strlcat.S 2267 2011-12-29 07:53:03Z joerg_wunsch $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn size_t strlcat (char *dst, const char *src, size_t siz)
-    \brief Concatenate two strings.
-
-    Appends \p src to string \p dst of size \p siz (unlike strncat(),
-    \p siz is the full size of \p dst, not space left).  At most \p siz-1
-    characters will be copied.  Always NULL terminates (unless \p siz <=
-    \p strlen(dst)).
-
-    \returns The strlcat() function returns strlen(src) + MIN(siz,
-    strlen(initial dst)).  If retval >= siz, truncation occurred.  */
-
-#if !defined(__AVR_TINY__)
+/* $Id: strlcat.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -98,7 +82,7 @@
 	ld	__tmp_reg__, X+
 	tst	__tmp_reg__
 	brne	1b
-	sbiw	XL, 1
+	X_sbiw	XL, 1
 	rjmp	3f
 
   ; copy loop
@@ -128,5 +112,3 @@
 
 ENDFUNC
 #endif /* not __DOXYGEN__ */
-
-#endif /* not __AVR_TINY__ */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strlcpy.S avr-libc-r2546/libc/string/strlcpy.S
--- avr-libc-2.0.0-orig/libc/string/strlcpy.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strlcpy.S	2018-05-22 08:51:58.000000000 +0400
@@ -33,20 +33,7 @@
 
 */
 
-/* $Id: strlcpy.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn size_t strlcpy (char *dst, const char *src, size_t siz)
-    \brief Copy a string.
-
-    Copy \p src to string \p dst of size \p siz.  At most \p siz-1
-    characters will be copied.  Always NULL terminates (unless \p siz == 0).
-
-    \returns The strlcpy() function returns strlen(src). If retval >= siz,
-    truncation occurred.  */
-
+/* $Id: strlcpy.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__AVR_TINY__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strlen.S avr-libc-r2546/libc/string/strlen.S
--- avr-libc-2.0.0-orig/libc/string/strlen.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strlen.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,18 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strlen.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn size_t strlen(const char *src)
-    \brief Calculate the length of a string.
-
-    The strlen() function calculates the length of the string src, not
-    including the terminating '\\0' character.
-
-    \returns The strlen() function returns the number of characters in
-    src.  */
+/* $Id: strlen.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strlwr.S avr-libc-r2546/libc/string/strlwr.S
--- avr-libc-2.0.0-orig/libc/string/strlwr.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strlwr.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strlwr.S 1944 2009-04-01 23:12:20Z arcanum $ */
+/* $Id: strlwr.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 /*
    strlwr.S
@@ -37,19 +37,6 @@
      Created by Reiner Patommel
 */
 
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strlwr(char *s)
-    \brief Convert a string to lower case.
-
-    The strlwr() function will convert a string to lower case. Only the upper
-    case alphabetic characters [A .. Z] are converted.  Non-alphabetic
-    characters will not be changed.
-
-    \returns The strlwr() function returns a pointer to the converted
-    string. */
-
 #if !defined(__DOXYGEN__)
 
 #include "macros.inc"
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strncasecmp.S avr-libc-r2546/libc/string/strncasecmp.S
--- avr-libc-2.0.0-orig/libc/string/strncasecmp.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strncasecmp.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strncasecmp.S 1944 2009-04-01 23:12:20Z arcanum $ */
+/* $Id: strncasecmp.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 /*
    strncasecmp.S
@@ -36,21 +36,6 @@
    Contributors:
      Created by Reiner Patommel
 */
-/** \file */
-
-/** \ingroup avr_string
-    \fn int strncasecmp(const char *s1, const char *s2, size_t len)
-    \brief Compare two strings ignoring case.
-
-    The strncasecmp() function is similar to strcasecmp(), except it
-    only compares the first \p len characters of \p s1.
-
-    \returns The strncasecmp() function returns an integer less than,
-    equal to, or greater than zero if \p s1 (or the first \p len bytes
-    thereof) is found, respectively, to be less than, to match, or be
-    greater than \p s2. A consequence of the ordering used by
-    strncasecmp() is that if \p s1 is an initial substring of \p s2,
-    then \p s1 is considered to be "less than" \p s2.  */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strncat.S avr-libc-r2546/libc/string/strncat.S
--- avr-libc-2.0.0-orig/libc/string/strncat.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strncat.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,20 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strncat.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strncat(char *dest, const char *src, size_t len)
-    \brief Concatenate two strings.
-
-    The strncat() function is similar to strcat(), except that only the first
-    n characters of src are appended to dest.
-
-    \returns The strncat() function returns a pointer to the resulting string
-    dest.  */
-
-#if !defined(__AVR_TINY__)
+/* $Id: strncat.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -62,7 +49,7 @@
 	ld	__tmp_reg__, X+
 	tst	__tmp_reg__
 	brne	.L_strncat_skip
-	sbiw	XL, 1		; undo post-increment (point the the NUL)
+	X_sbiw	XL, 1		; undo post-increment (point to the NUL)
 .L_strncat_loop:
 	subi	len_lo, lo8(1)
 	sbci	len_hi, hi8(1)
@@ -81,5 +68,3 @@
 	.size	_U(strncat), .L_strncat_end - _U(strncat)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strncmp.S avr-libc-r2546/libc/string/strncmp.S
--- avr-libc-2.0.0-orig/libc/string/strncmp.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strncmp.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,19 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strncmp.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn int strncmp(const char *s1, const char *s2, size_t len)
-    \brief Compare two strings.
-
-    The strncmp() function is similar to strcmp(), except it only compares the
-    first (at most) n characters of s1 and s2.
-
-    \returns The strncmp() function returns an integer less than, equal to, or
-    greater than zero if s1 (or the first n bytes thereof) is found,
-    respectively, to be less than, to match, or be greater than s2.  */
+/* $Id: strncmp.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strncpy.S avr-libc-r2546/libc/string/strncpy.S
--- avr-libc-2.0.0-orig/libc/string/strncpy.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strncpy.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,22 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strncpy.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strncpy(char *dest, const char *src, size_t len)
-    \brief Copy a string.
-
-    The strncpy() function is similar to strcpy(), except that not more than n
-    bytes of src are copied. Thus, if there is no null byte among the first n
-    bytes of src, the result will not be null-terminated.
-
-    In the case where the length of src is less than that of n, the remainder
-    of dest will be padded with nulls.
-
-    \returns The strncpy() function returns a pointer to the destination
-    string dest.  */
+/* $Id: strncpy.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strnlen.S avr-libc-r2546/libc/string/strnlen.S
--- avr-libc-2.0.0-orig/libc/string/strnlen.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strnlen.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,21 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strnlen.S 1944 2009-04-01 23:12:20Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn size_t strnlen(const char *src, size_t len)
-    \brief Determine the length of a fixed-size string.
-
-    The strnlen function returns the number of characters in the string
-    pointed to by src, not including the terminating '\\0' character, but at
-    most len. In doing this, strnlen looks only at the first len characters at
-    src and never beyond src+len.
-
-    \returns The strnlen function returns strlen(src), if that is less than
-    len, or len if there is no '\\0' character among the first len
-    characters pointed to by src. */
+/* $Id: strnlen.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strpbrk.S avr-libc-r2546/libc/string/strpbrk.S
--- avr-libc-2.0.0-orig/libc/string/strpbrk.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strpbrk.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,22 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strpbrk.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strpbrk(const char *s, const char *accept)
-    
-    The strpbrk() function locates the first occurrence in the string
-    \p s of any of the characters in the string \p accept.
-
-    \return  The strpbrk() function returns a pointer to the character
-    in \p s that matches one of the characters in \p accept, or \c NULL
-    if no such character is found. The terminating zero is not
-    considered as a part of string: if one or both args are empty, the
-    result will \c NULL.	*/
-
-#if !defined(__AVR_TINY__)
+/* $Id: strpbrk.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #ifndef	__DOXYGEN__
 
@@ -69,18 +54,20 @@
 	breq	3f
   ; check an occurance
 	X_movw	ZL, acc_lo
-2:	ld	r0, Z+
-	cp	r0, ret_lo
-	cpse	r0, __zero_reg__
+2:	ld	__tmp_reg__, Z+
+	cp	__tmp_reg__, ret_lo
+	cpse	__tmp_reg__, __zero_reg__
 	brne	2b
 	brne	1b		; branch if end of accept[] is reached
   ; OK, is found
+#if !defined(__AVR_TINY__)
 	sbiw	XL, 1
+#else
+	ld	__tmp_reg__, -X
+#endif /* !__AVR_TINY__ */
 	X_movw	ret_lo, XL
 3:	ret
 
 	.size _U(strpbrk), . - _U(strpbrk)
 
 #endif	/* !__DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strrchr.S avr-libc-r2546/libc/string/strrchr.S
--- avr-libc-2.0.0-orig/libc/string/strrchr.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strrchr.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,23 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strrchr.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn char *strrchr(const char *src, int val)
-    \brief Locate character in string.
-
-    The strrchr() function returns a pointer to the last occurrence of the
-    character val in the string src.
-
-    Here "character" means "byte" - these functions do not work with wide or
-    multi-byte characters.
-
-    \returns The strrchr() function returns a pointer to the matched character
-    or NULL if the character is not found. */
-
-#if !defined(__AVR_TINY__)
+/* $Id: strrchr.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -71,11 +55,9 @@
 .L_strrchr_noteq:
 	tst	__tmp_reg__
 	brne	.L_strrchr_loop
-	sbiw	ret_lo, 1	; undo post-increment
+	X_sbiw	ret_lo, 1	; undo post-increment
 	ret
 .L_strrchr_end:
 	.size	_U(strrchr), .L_strrchr_end - _U(strrchr)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strrev.S avr-libc-r2546/libc/string/strrev.S
--- avr-libc-2.0.0-orig/libc/string/strrev.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strrev.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strrev.S 2191 2010-11-05 13:45:57Z arcanum $ */
+/* $Id: strrev.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 /*
    strrev.S
@@ -36,18 +36,6 @@
    Contributors:
      Created by Reiner Patommel
 */
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strrev(char *s)
-    \brief Reverse a string.
-
-    The strrev() function reverses the order of the string.
-
-    \returns The strrev() function returns a pointer to the beginning of the
-    reversed string.  */
-
-#if !defined(__AVR_TINY__)
 
 #if !defined(__DOXYGEN__)
 
@@ -70,7 +58,7 @@
 	ld	ltemp, Z+
 	tst	ltemp
 	brne	1b
-	sbiw	ZL, 2		; to last nonzero byte
+	X_sbiw	ZL, 2		; to last nonzero byte
 	rjmp	3f
   ; swap bytes
 2:	ld	ltemp, X
@@ -86,5 +74,3 @@
     .size _U(strrev), . - _U(strrev)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strsep.S avr-libc-r2546/libc/string/strsep.S
--- avr-libc-2.0.0-orig/libc/string/strsep.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strsep.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,26 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strsep.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strsep(char **sp, const char *delim)
-    \brief Parse a string into tokens.
-
-    The strsep() function locates, in the string referenced by \p *sp,
-    the first occurrence of any character in the string \p delim (or the
-    terminating '\\0' character) and replaces it with a '\\0'.  The
-    location of the next character after the delimiter character (or \c
-    NULL, if the end of the string was reached) is stored in \p *sp. An
-    ``empty'' field, i.e. one caused by two adjacent delimiter
-    characters, can be detected by comparing the location referenced by
-    the pointer returned in \p *sp to '\\0'.
-
-    \return The strsep() function returns a pointer to the original
-    value of \p *sp. If \p *sp is initially \c NULL, strsep() returns
-    \c NULL.	*/
+/* $Id: strsep.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
      
 #if !defined(__AVR_TINY__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strspn.S avr-libc-r2546/libc/string/strspn.S
--- avr-libc-2.0.0-orig/libc/string/strspn.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strspn.S	2018-05-22 08:51:58.000000000 +0400
@@ -26,18 +26,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strspn.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-/** \ingroup avr_string
-    \fn size_t strspn(const char *s, const char *accept)
-
-    The strspn() function calculates the length of the initial segment
-    of \p s which consists entirely of characters in \p accept.
-		 
-    \return  The strspn() function returns the number of characters in
-    the initial segment of \p s which consist only of characters from \p
-    accept. The terminating zero is not considered as a part of string.	*/
+/* $Id: strspn.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 #if !defined(__AVR_TINY__)
 
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strstr.S avr-libc-r2546/libc/string/strstr.S
--- avr-libc-2.0.0-orig/libc/string/strstr.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strstr.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strstr.S 2191 2010-11-05 13:45:57Z arcanum $ */
+/* $Id: strstr.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 /*
    strstr.S
@@ -37,22 +37,6 @@
      Philip Soeberg <philip@soeberg.net>
 */
 
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strstr(const char *s1, const char *s2)
-    \brief Locate a substring.
-
-    The strstr() function finds the first occurrence of the substring \p
-    s2 in the string \p s1.  The terminating '\\0' characters are not
-    compared.
-
-    \returns The strstr() function returns a pointer to the beginning of
-    the substring, or \c NULL if the substring is not found. If \p s2
-    points to a string of zero length, the function returns \p s1. */
-
-#if !defined(__AVR_TINY__)
-
 #if !defined(__DOXYGEN__)
 
 #include "macros.inc"
@@ -64,7 +48,7 @@
 
 #define chr1   r20
 #define	beg2   r21	/* begin of s2: s2[0]	*/
-#define chr2   r0
+#define chr2   __tmp_reg__
 
 ASSEMBLY_CLIB_SECTION
 .global _U(strstr)
@@ -103,12 +87,10 @@
 	ldi	s1_lo, lo8(1)
 	ldi	s1_hi, hi8(1)
 .L_match:
-	sbiw	s1_lo, 1	; restore after post-increment
+	X_sbiw	s1_lo, 1	; restore after post-increment
 .L_ret:
 	ret
 
 .size _U(strstr), . - _U(strstr)
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strtok.c avr-libc-r2546/libc/string/strtok.c
--- avr-libc-2.0.0-orig/libc/string/strtok.c	2016-02-08 01:59:50.000000000 +0300
+++ avr-libc-r2546/libc/string/strtok.c	2018-05-22 08:51:58.000000000 +0400
@@ -26,26 +26,8 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strtok.c 2503 2016-02-07 22:59:47Z joerg_wunsch $ */
+/* $Id: strtok.c 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
-/** \file */
-/** \ingroup avr_string
-    \fn char *strtok(char *s, const char *delim)
-    \brief Parses the string s into tokens.
-
-    strtok parses the string s into tokens. The first call to strtok
-    should have s as its first argument. Subsequent calls should have
-    the first argument set to NULL. If a token ends with a delimiter, this
-    delimiting character is overwritten with a '\\0' and a pointer to the next
-    character is saved for the next call to strtok. The delimiter string
-    delim may be different for each call.
-    
-    \returns The strtok() function returns a pointer to the next token or
-    NULL when no more tokens are found. 
-    
-    \note strtok() is NOT reentrant. For a reentrant version of this function
-    see \c strtok_r().
-*/
 
 #include <string.h>
 #include "sectionname.h"
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strtok_r.S avr-libc-r2546/libc/string/strtok_r.S
--- avr-libc-2.0.0-orig/libc/string/strtok_r.S	2010-11-09 22:39:46.000000000 +0300
+++ avr-libc-r2546/libc/string/strtok_r.S	2018-05-22 08:51:58.000000000 +0400
@@ -28,27 +28,7 @@
   POSSIBILITY OF SUCH DAMAGE.
 */
 
-/* $Id: strtok_r.S 2191 2010-11-05 13:45:57Z arcanum $ */
-
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strtok_r(char *string, const char *delim, char **last)
-    \brief Parses string into tokens.
-
-    strtok_r parses string into tokens. The first call to strtok_r
-    should have string as its first argument. Subsequent calls should have
-    the first argument set to NULL. If a token ends with a delimiter, this
-    delimiting character is overwritten with a '\\0' and a pointer to the next
-    character is saved for the next call to strtok_r. The delimiter string
-    \p delim may be different for each call. \p last is a user allocated char*
-    pointer. It must be the same while parsing the same string. strtok_r is
-    a reentrant version of strtok().
-
-    \returns The strtok_r() function returns a pointer to the next token or
-    NULL when no more tokens are found. */
-
-#if !defined(__AVR_TINY__)
+/* $Id: strtok_r.S 2542 2017-06-12 22:08:58Z joerg_wunsch $ */
 
 #if !defined(__DOXYGEN__)
 
@@ -105,13 +85,16 @@
 #define dch	r18
 
 ENTRY strtok_r
+#if defined(__AVR_TINY__)
+	push	dch
+#endif /* __AVR_TINY__ */
 	X_movw	ZL, lst_lo
 	ld	XL, Z+			; X = *last
 	ld	XH, Z
   ; check str
-	sbiw	str_lo, 0
+	X_sbiw	str_lo, 0
 	brne	1f
-	sbiw	XL, 0
+	X_sbiw	XL, 0
 	breq	.Lret			; end of string
 	X_movw	str_lo, XL		; continue parsing
 
@@ -137,7 +120,11 @@
 	cp	dch, __tmp_reg__	; __tmp_reg__ != 0
 	brne	7f
 	st	-X, __zero_reg__
+#if !defined(__AVR_TINY__)
 	adiw	XL, 1
+#else
+	ld	__tmp_reg__, X+
+#endif /* __AVR_TINY__ */
 	rjmp	.Lret
 7:	tst	dch
 	brne	6b
@@ -152,10 +139,11 @@
 .Lret:	X_movw	ZL, lst_lo		; *last = X
 	st	Z+, XL
 	st	Z, XH
+#if defined(__AVR_TINY__)
+	pop	dch
+#endif /* __AVR_TINY__ */
 	ret
 
 ENDFUNC
 
 #endif /* not __DOXYGEN__ */
-
-#endif /* !defined(__AVR_TINY__) */
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/libc/string/strupr.S avr-libc-r2546/libc/string/strupr.S
--- avr-libc-2.0.0-orig/libc/string/strupr.S	2010-06-08 16:01:55.000000000 +0400
+++ avr-libc-r2546/libc/string/strupr.S	2018-05-22 08:51:58.000000000 +0400
@@ -27,7 +27,7 @@
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE. */
 
-/* $Id: strupr.S 1944 2009-04-01 23:12:20Z arcanum $ */
+/* $Id: strupr.S 2515 2016-02-08 22:46:42Z joerg_wunsch $ */
 
 /*
    strupr.S
@@ -37,20 +37,6 @@
      Created by Reiner Patommel
 */
 
-/** \file */
-
-/** \ingroup avr_string
-    \fn char *strupr(char *s)
-    \brief Convert a string to upper case.
-
-    The strupr() function will convert a string to upper case. Only the lower
-    case alphabetic characters [a .. z] are converted.  Non-alphabetic
-    characters will not be changed.
-
-    \returns The strupr() function returns a pointer to the converted
-    string.  The pointer is the same as that passed in since the operation is
-    perform in place. */
-
 #if !defined(__DOXYGEN__)
 
 #include "macros.inc"
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/NEWS avr-libc-r2546/NEWS
--- avr-libc-2.0.0-orig/NEWS	2016-02-08 16:26:00.000000000 +0300
+++ avr-libc-r2546/NEWS	2018-05-22 08:52:05.000000000 +0400
@@ -1,3 +1,43 @@
+*** Changes since avr-libc-2.0.0:
+
+* Improvements and additions:
+
+  - Patch #9187 improved the library coverage for the AVR_TINY
+    architecture (ATtiny10 and relatives).  In particular, many
+    of the functions from <string.h> are now available there.
+
+  - Patch #8729 adds ISR_NOICF and ISR_FLATTEN to <avr/interrupt.h>
+
+* Bugs fixed:
+
+  [#36933] Documentation no longer correctly describes how to declare
+  [#41689] add static_assert to assert.h
+  [#48898] power_usart3_* functions no more defined in power.h
+  [#49020] dtostre() flags documentation error
+  [#49447] Example code for uart_putchar() has error in recursive call
+  strings for storage in program memory
+  [#50439] avr/iom32u4.h does not define PRTIM4
+  [#51755] iotn441.h & iotn841.h missing definitions for PUEA[0-7] and PUEB[0-3]
+  [no-id] util/eu_dst.h: fix reversed DST decision logic for March and October
+
+* New devices supported:
+
+* Contributed Patches:
+
+  [no-id] Define weak symbols for known memory region sizes based on device 
+  header definitions, starting with fuse region.
+  [#8961] Update test script for new simulavr and library layout
+  [#8964] Update tests isinf-01.c, signbit-01.c and modf-np.c
+  [#9163] New eeprom write block function for xmega using eeprom page write
+  [#8729] [avr/interrupt.h] Add ISR_NOICF, ISR_FLATTEN. Fix namespace of identifiers.
+  [#8536] Fix a typo within <stdio.h>
+  [#8649] small documentation fixes in
+  [#9187] [AVR_TINY]: Support 16-bit xtoa functons and more string functions.
+  [#9400] Add avrxmega3 multilibs
+
+* Other changes:
+
+
 *** Changes in avr-libc-2.0.0:
 
 * General:
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/xml/Atmel2libc.py avr-libc-r2546/xml/Atmel2libc.py
--- avr-libc-2.0.0-orig/xml/Atmel2libc.py	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/xml/Atmel2libc.py	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,547 @@
+#! /usr/bin/env python
+#
+# Copyright (c) 2004,2005  Theodore A. Roth
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+# * Redistributions of source code must retain the above copyright
+#   notice, this list of conditions and the following disclaimer.
+#
+# * Redistributions in binary form must reproduce the above copyright
+#   notice, this list of conditions and the following disclaimer in
+#   the documentation and/or other materials provided with the
+#   distribution.
+#
+# * Neither the name of the copyright holders nor the names of
+#   contributors may be used to endorse or promote products derived
+#   from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+# POSSIBILITY OF SUCH DAMAGE.
+#
+# $Id: Atmel2libc.py 1530 2007-12-20 20:43:54Z joerg_wunsch $
+#
+
+import string
+import re
+from xml.parsers import expat
+
+class Element:
+    'A parsed XML element'
+
+    def __init__(self,name,attributes,depth=0):
+        'Element constructor'
+        # The element's tag name
+        self.name = name
+        # The element's attribute dictionary
+        self.attributes = attributes
+        # The element's cdata
+        self.cdata = ''
+        # The element's child element list (sequence)
+        self.children = []
+
+        self.depth = depth
+        
+    def AddChild(self, element, depth=0):
+        'Add a reference to a child element'
+        element.depth = depth
+        self.children.append(element)
+        
+    def getAttribute(self,key):
+        'Get an attribute value'
+        return self.attributes.get(key)
+    
+    def getData(self):
+        'Get the cdata'
+        return self.cdata
+        
+    def getElements(self,name=''):
+        'Get a list of child elements'
+        #If no tag name is specified, return the all children
+        if not name:
+            return self.children
+        else:
+            # else return only those children with a matching tag name
+            elements = []
+            for element in self.children:
+                if element.name == name:
+                    elements.append(element)
+            return elements
+
+    def getSubTree (self, path):
+        '''Path is a list of element names.
+        The last element of the path is returned or None if the element is
+        not found. The first name in path, should match self.name.
+
+        This does not work if there are many children with the same name.
+        '''
+        if self.name != path[0]:
+            return None
+
+        if len (path) == 1:
+            # We're are the last element in the path.
+            return self
+
+        for child in self.children:
+            if child.name == path[1]:
+                return child.getSubTree (path[1:])
+
+        return None
+
+    def __repr__(self):
+        indent = '  ' * self.depth
+        s ='%s[ %s, %s, "%s", {' % (indent, self.name, self.attributes,
+                                      self.cdata)
+        cs = ''
+        for c in self.children:
+            cs += '\n%s' % (c)
+
+        if len (cs):
+            s += '%s\n%s}]' % (cs,indent)
+        else:
+            s += '}]'
+
+        return s
+
+class Xml2Obj:
+    'XML to Object'
+
+    encoding = 'utf-8'
+    
+    def __init__(self):
+        self.root = None
+        self.nodeStack = []
+        
+    def StartElement(self,name,attributes):
+        'SAX start element even handler'
+        # Instantiate an Element object
+        element = Element(name.encode(Xml2Obj.encoding),attributes)
+        
+        # Push element onto the stack and make it a child of parent
+        if len(self.nodeStack) > 0:
+            parent = self.nodeStack[-1]
+            parent.AddChild(element, parent.depth+1)
+        else:
+            self.root = element
+        self.nodeStack.append(element)
+        
+    def EndElement(self,name):
+        'SAX end element event handler'
+        self.nodeStack = self.nodeStack[:-1]
+
+    def CharacterData(self,data):
+        'SAX character data event handler'
+        if string.strip(data):
+            data = data.replace('&', '&amp;')
+            data = data.encode(Xml2Obj.encoding)
+            element = self.nodeStack[-1]
+            element.cdata += data
+            return
+
+    def Parse(self,filename):
+        # Create a SAX parser
+        Parser = expat.ParserCreate()
+
+        # SAX event handlers
+        Parser.StartElementHandler = self.StartElement
+        Parser.EndElementHandler = self.EndElement
+        Parser.CharacterDataHandler = self.CharacterData
+
+        # Parse the XML File
+        ParserStatus = Parser.Parse(open(filename,'r').read(), 1)
+        
+        return self.root
+
+def convert_vect_addr (addr):
+    """Atmel defines vector addresses as 16-bits wide words in the atmel files
+    while avr-libc defines them as byte addresses.
+
+    The incoming addr is a string that looks like this: '$0034'
+
+    We will convert that into a number and store it internally as such.
+    """
+    if addr[0] != '$':
+        raise NotHexNumberErr, addr
+
+    return int (addr[1:], 16) * 2
+
+def print_wrapped (indent, line):
+    ilen = len (indent)
+    llen = len (line)
+    print indent[:-1],
+    if ilen + llen > 78:
+        i = 78 - ilen
+        while i:
+            if line[i] == ' ':
+                print line[:i]
+                print_wrapped (indent+'  ', line[i+1:])
+                break
+            i -= 1
+        else:
+            # Couldn't find a place to wrap before col 78, try to find one
+            # after.
+            i = 79 - ilen
+            while i < llen:
+                if line[i] == ' ':
+                    print line[:i]
+                    print_wrapped (indent+'  ', line[i+1:])
+                    break
+                i += 1
+            else:
+                # Give up and just print the line.
+                print line
+    else:
+        print line
+
+def dump_header (root, depth=0):
+    name = root.getSubTree (['AVRPART', 'ADMIN', 'PART_NAME']).getData()
+    print '<?xml version="1.0"?>'
+    print '<!DOCTYPE device SYSTEM "Device.dtd">'
+    print '<device name="%s">' % (name)
+
+    # Avoid CVS changing ID in python script.
+    print '  <version>%s</version>' % ('$'+'Id$')
+    print '  <description></description>'
+
+def dump_footer (root):
+    print '</device>'
+
+def dump_memory_sizes (root):
+    path = ['AVRPART', 'MEMORY']
+    mem = root.getSubTree (path)
+
+    flash_size = int (mem.getElements ('PROG_FLASH')[0].getData ())
+    eep_size = int (mem.getElements ('EEPROM')[0].getData ())
+
+    isram = mem.getSubTree (['MEMORY', 'INT_SRAM'])
+    isram_size = int (isram.getElements ('SIZE')[0].getData ())
+    isram_start = isram.getElements ('START_ADDR')[0].getData ()[1:]
+
+    xsram = mem.getSubTree (['MEMORY', 'EXT_SRAM'])
+    try:
+        xsram_size = int (xsram.getElements ('SIZE')[0].getData ())
+    except ValueError:
+        # Some XSRAM entries come with just "NA" as the value
+        xsram_size = 0
+    xsram_start = xsram.getElements ('START_ADDR')[0].getData ()[1:]
+
+    print '  <memory_sizes>'
+    print '    <flash_size>0x%x</flash_size>' % (flash_size)
+    print '    <eeprom_size>0x%x</eeprom_size>' % (eep_size)
+    print '    <int_sram_size start_addr="0x%s">0x%x</int_sram_size>' % (
+        isram_start, isram_size)
+    print '    <ext_sram_size start_addr="0x%s">0x%x</ext_sram_size>' % (
+        xsram_start, xsram_size)
+    print '  </memory_sizes>'
+
+def dump_vectors (root, tradnames):
+    """Get the interupt vectors.
+    """
+
+    path = [ 'AVRPART', 'INTERRUPT_VECTOR' ]
+
+    irqs = root.getSubTree (path)
+
+    nvects = int (irqs.getElements ('NMB_VECTORS')[0].getData ())
+
+    vectors = []
+    for i in range (1, nvects+1):
+        try:
+            vect = irqs.getElements ('VECTOR%d' % (i))[0]
+        except IndexError:
+            # some devices have holes in the vector table =:-)
+            vectors.append(())
+            continue
+
+        name = vect.getElements ('SOURCE')[0].getData ()
+        saddr = vect.getElements ('PROGRAM_ADDRESS')[0].getData ()
+        desc = vect.getElements ('DEFINITION')[0].getData ()
+
+        addr = convert_vect_addr (saddr)
+
+        vectors.append ((addr, name, desc))
+
+    # Determine the size of the vector insn from the address of the 2nd vector.
+    insn_size = vectors[1][0]
+
+    print '  <interrupts insn_size="%d" num_vects="%d">' % (insn_size,
+                                                            nvects)
+    n = 0
+    for v in vectors:
+        # we are not really interested in the reset vector
+        if n == 0:
+            n += 1
+            continue
+        try:
+            name = re.sub('[/-]', '', v[1].upper())
+            name = re.sub(',', ' ', name)
+            # The ATmega16HVA file has a silly SPI;STC vector name
+            name = re.sub(';', '_', name)
+            name = re.sub(r'\s+', '_', name)
+            if re.match('^[A-Z0-9_]+$', name):
+                pass
+            else:
+                raise 'Invalid characters in vector name even after substitution', name
+
+            print '    <vector addr="0x%04x" num="%d" name="%s">' % (v[0], n, v[1])
+            print_wrapped ('      ', '<description>%s</description>' % (v[2]))
+            print '      <sig_name>%s_vect</sig_name>' % name
+            for altname in tradnames.Vecname(n):
+                print '      <alt_name>%s</alt_name>' % altname
+            print '    </vector>'
+        except IndexError:
+            # this catches holes in the vector table
+            pass
+        n += 1
+    print '  </interrupts>'
+
+def gather_io_info (root):
+    """
+    The bit information may be spread across multiple IO_MODULES.
+
+    Man that sucks. :-(
+
+    Oh, and it gets worse. They have duplicate bit elements, but the
+    duplicates are not quite complete (see SFIOR in the mega128 file). Now,
+    why couldn't they just list all the register info in a single linear
+    table, then in the modules, just list the registers used by the module and
+    look up the register info in the linear table?
+
+    So what we will do is walk all modules the extract register info and put
+    that info into a dictionary so we can look it up later.
+    """
+    io_reg_info = {}
+
+    path = ['AVRPART', 'IO_MODULE']
+    io_module = root.getSubTree (path)
+
+    # Get the list of all modules.
+    mod_list = io_module.getElements ('MODULE_LIST')[0].getData ()
+    mod_list = mod_list[1:-1].split (':')
+
+    for mod in mod_list:
+        # Get the list of registers for the module.
+        path = ['IO_MODULE', mod, 'LIST']
+        reg_list = io_module.getSubTree (path).getData ()
+        reg_list = reg_list[1:-1].split (':')
+        for reg in reg_list:
+            path[2] = reg
+            element = io_module.getSubTree (path)
+            if io_reg_info.has_key (reg):
+                # NOTE: The ATtiny2313.xml has a bug (There's 2 'ICR1H'
+                # entries in the reg list) that causes the following for loop
+                # to go infinite. Argh! Removing the extra entry seems to get
+                # things working again.
+                for child in element.getElements ():
+                    io_reg_info[reg].AddChild (child, element.depth+1)
+            else:
+                io_reg_info[reg] = element
+
+    return io_reg_info
+
+def dump_ioregs (root):
+    path = ['AVRPART', 'MEMORY', 'IO_MEMORY']
+    io_mem = root.getSubTree (path)
+    ioregs = io_mem.getElements ()
+
+    ioreg_info_dict = gather_io_info (root)
+
+    print '  <ioregisters>'
+
+    # Skip the first 6 elements since they are just give start and stop
+    # addresses.
+
+    for ioreg in ioregs[6:]:
+        name = ioreg.name
+        try:
+            reg_info = ioreg_info_dict[name]
+            try:
+                reg_desc = reg_info.getElements ('DESCRIPTION')[0].getData ()
+            except IndexError:
+                reg_desc = ''
+        except KeyError:
+            reg_info = None
+            reg_desc = ''
+
+        addr = ioreg.getElements ('IO_ADDR')[0].getData ()
+        try:
+            if addr[0] == '$':
+                addr = '0x' + addr[1:]
+            if addr == "NA":
+                addr = ioreg.getElements ('MEM_ADDR')[0].getData ()
+            else:
+                # Add 0x20 so all addresses are memory mapped.
+                addr = '0x%02x' % (int (addr, 16) + 0x20)
+
+            print '    <ioreg name="%s" addr="%s">' % (name, addr)
+            print_wrapped ('      ','<description>%s</description>' % (reg_desc))
+            print '      <alt_name></alt_name>'
+            for i in range (8):
+                if reg_info is None:
+                    continue
+                bit = 'BIT%d' % (i)
+                bit_el = reg_info.getSubTree ([name, bit])
+                if bit_el is None:
+                    continue
+                bit_name = bit_el.getElements ('NAME')[0].getData ()
+                try:
+                    bit_desc = bit_el.getElements ('DESCRIPTION')[0].getData ()
+                except IndexError:
+                    bit_desc = ''
+                try:
+                    bit_access = bit_el.getElements ('ACCESS')[0].getData ()
+                except IndexError:
+                    bit_access = 'FIXME!'
+                bit_init_val = bit_el.getElements ('INIT_VAL')[0].getData ()
+                print '      <bit_field name="%s"' % (bit_name),
+                print 'bit="%d"' % (i),
+                print 'access="%s"' % (bit_access),
+                print 'init="%s">' % (bit_init_val)
+                if bit_desc:
+                    print_wrapped ('        ',
+                                   '<description>%s</description>' % (bit_desc))
+                print '        <alt_name></alt_name>'
+                print '      </bit_field>'
+            print '    </ioreg>'
+        except IndexError:  # empty register declaration
+            pass
+
+    print '  </ioregisters>'
+
+def dump_boot_info (root):
+    path = ['AVRPART', 'MEMORY', 'BOOT_CONFIG']
+
+    info = root.getSubTree (path)
+    if info:
+        # The device has bootloader support.
+        try:
+            data = info.getElements ('NRWW_START_ADDR')[0].getData ()
+            if data[0] == '$':
+                data = '0x' + data[1:]
+            if data == 'x':
+                nrww_start = ''
+            else:
+                nrww_start = ' nrww_start="0x%x"' % (int (data, 16))
+        except IndexError:
+            nrww_start = ''
+
+        try:
+            data = info.getElements ('NRWW_STOP_ADDR')[0].getData ()
+            if data[0] == '$':
+                data = '0x' + data[1:]
+            if data == 'x':
+                nrww_end = ''
+            else:
+                nrww_end = ' nrww_end="0x%x"' % (int (data, 16))
+        except IndexError:
+            nrww_end = ''
+
+        try:
+            data = info.getElements ('RWW_START_ADDR')[0].getData ()
+            if data[0] == '$':
+                data = '0x' + data[1:]
+            try:
+                rww_start = ' rww_start="0x%x"' % (int (data, 16))
+            except ValueError:
+                rww_start = ''
+        except IndexError:
+            rww_start = ''
+
+        try:
+            data = info.getElements ('RWW_STOP_ADDR')[0].getData ()
+            if data[0] == '$':
+                data = '0x' + data[1:]
+            try:
+                rww_end = ' rww_end="0x%x"' % (int (data, 16))
+            except ValueError:
+                rww_end = ''
+        except IndexError:
+            rww_end = ''
+
+        # The Atmel files give the pagesize in words, we need it in bytes.
+
+        pagesize = 'pagesize="%d"' % ( \
+            2 * int (info.getElements ('PAGESIZE')[0].getData ()))
+
+        rww = '%s%s' % (rww_start, rww_end)
+        nrww = '%s%s' % (nrww_start, nrww_end)
+        print '  <bootloader %s%s%s>' % (pagesize, rww, nrww)
+
+        for i in range (8):
+            try:
+                mode = info.getElements ('BOOTSZMODE%d' % (i))[0]
+            except IndexError:
+                continue
+
+            data = mode.getElements ('PAGES')[0].getData ()
+            if data == 'x':
+                data = 'FIXME!'
+            pages = 'pages="%s"' % (data)
+
+            data = mode.getElements ('BOOTSTART')[0].getData ()
+            if data[0] == '$':
+                data = '0x' + data[1:]
+            if data == 'x':
+                start = 'start="FIXME: Broken xml from Atmel!"'
+            else:
+                start = 'start="0x%x"' % (int (data,16))
+
+            print '    <mode num="%d" %s %s />' % (i, pages, start)
+
+        print '  </bootloader>'
+
+class HeaderToVec:
+    'Parse header file for traditional vector names'
+
+    def __init__(self):
+        self.vects = {}
+
+    def Read(self, fname):
+        'Read header file'
+        f = open(fname)
+        r = re.compile(r'#\s*define\s+(SIG_[A-Z0-9_]+)\s+_VECTOR[(](\d+)[)]')
+        for line in f:
+            m = r.match(line)
+            if m != None:
+                intno = int(m.group(2))
+                try:
+                    x = self.vects[intno]
+                except KeyError:
+                    x = []
+                x.append(m.group(1))
+                self.vects[intno] = x
+        f.close()
+
+    def Vecname(self, idx):
+        try:
+            return self.vects[idx]
+        except KeyError:
+            return ''
+
+
+if __name__ == '__main__':
+    import sys
+
+    parser = Xml2Obj()
+    root = parser.Parse(sys.argv[1])
+
+    tradheader = HeaderToVec()
+    tradheader.Read(sys.argv[2])
+
+    dump_header (root)
+    dump_memory_sizes (root)
+    dump_vectors (root, tradheader)
+    dump_ioregs (root)
+    dump_boot_info (root)
+    dump_footer (root)
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/xml/avrgcc-header avr-libc-r2546/xml/avrgcc-header
--- avr-libc-2.0.0-orig/xml/avrgcc-header	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/xml/avrgcc-header	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,1354 @@
+#! /bin/sh
+# Copyright (c) 2008 Atmel Corporation
+#   All rights reserved.
+#
+#   Redistribution and use in source and binary forms, with or without
+#   modification, are permitted provided that the following conditions are met:
+#
+#   * Redistributions of source code must retain the above copyright
+#     notice, this list of conditions and the following disclaimer.
+#
+#   * Redistributions in binary form must reproduce the above copyright
+#     notice, this list of conditions and the following disclaimer in
+#     the documentation and/or other materials provided with the
+#     distribution.
+#
+#   * Neither the name of the copyright holders nor the names of
+#     contributors may be used to endorse or promote products derived
+#     from this software without specific prior written permission.
+#
+#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+#  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+#  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+#  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+#  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+#  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+#  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+#  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+#  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+#  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+#  POSSIBILITY OF SUCH DAMAGE.
+
+# $Id: avrgcc-header 2167 2010-06-13 13:15:56Z joerg_wunsch $
+
+# Convert Atmel XML Device file to AVR GCC I/O header file.
+# Needs: xmlstarlet (executable: xml), sed, grep, uniq, mv, rm, echo, sort.
+
+usage() {
+cat << EOF
+usage: $0 -d <xml device file> -h <io header file> [-x]
+    -d <xml device file>    XML Device File (Input)
+    -h <io header file>     I/O Header File (Output). 
+                            If file exists, it will be overwritten.
+    -x                      Optional XMEGA header file output
+EOF
+}
+
+
+abort() {
+    echo $@
+    exec /bin/false
+}
+
+
+# Get options
+devicefile=
+headerfile=
+xmega=
+while test $# -gt 0
+do
+    case "$1" in
+    -d) devicefile="$2"; shift;;
+    -h) headerfile="$2"; shift;;
+    -x) xmega="1";;
+    --)	shift; break;;
+    -*) usage; exit 1;;
+     *) break;;         # terminate while loop
+    esac
+    shift
+done
+# all command line switches are processed,
+
+
+# Test parameters.
+if test "$devicefile" = ""; then
+    usage
+    abort "Error: No device file specified."
+fi
+if test "$headerfile" = ""; then 
+    usage
+    abort "Error: No header file specified."
+fi
+
+
+set -x
+
+
+if test -e "$headerfile"; then rm "$headerfile"; fi
+
+
+# Header
+#-------------------
+
+# Get device name.
+DEVICE=$(xml sel -T -t -v /AVRPART/ADMIN/PART_NAME $devicefile)
+
+# todo: upper-case function not found. Use this value in idempotent guard.
+#DEVICEUPPER=$(xml sel -T -t -v "upper-case(/AVRPART/ADMIN/PART_NAME)" $devicefile)
+
+# Get the current year to place in copyright statement.
+YEAR=$(date --rfc-3339=date | cut -d '-' -f 1)
+
+cat << eof > $headerfile
+/* Copyright (c) $YEAR Atmel Corporation
+   All rights reserved.
+
+   Redistribution and use in source and binary forms, with or without
+   modification, are permitted provided that the following conditions are met:
+
+   * Redistributions of source code must retain the above copyright
+     notice, this list of conditions and the following disclaimer.
+
+   * Redistributions in binary form must reproduce the above copyright
+     notice, this list of conditions and the following disclaimer in
+     the documentation and/or other materials provided with the
+     distribution.
+
+   * Neither the name of the copyright holders nor the names of
+     contributors may be used to endorse or promote products derived
+     from this software without specific prior written permission.
+
+  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+  POSSIBILITY OF SUCH DAMAGE. */
+
+/* \$Id\$ */
+
+/* avr/$headerfile - definitions for ${DEVICE} */
+
+/* This file should only be included from <avr/io.h>, never directly. */
+
+#ifndef _AVR_IO_H_
+#  error "Include <avr/io.h> instead of this file."
+#endif
+
+#ifndef _AVR_IOXXX_H_
+#  define _AVR_IOXXX_H_ "$headerfile"
+#else
+#  error "Attempt to include more than one <avr/ioXXX.h> file."
+#endif 
+
+
+#ifndef _AVR_${DEVICE}_H_
+#define _AVR_${DEVICE}_H_ 1
+
+
+eof
+
+
+
+if test -n "$xmega" ; then
+
+# XMEGA AVR
+#==================
+
+
+# Build IO groups temporary XML file
+#------------------------------------
+if test -e $headerfile-iogroups.xml; then
+    rm -f $headerfile-iogroups.xml
+fi
+
+# Get set of register group names.
+GROUP_NAMES=$(xml sel -T -t -m /AVRPART/V2/modules/module/registers -s "A:T:-" "@offset" -v "concat(@name,' ')" $devicefile)
+
+# Create base iogroups temporary xml file.
+echo "<AVRPART>" | sed "s,>,>\r,g" >> $headerfile-iogroups.xml
+for i in $GROUP_NAMES ; do \
+    xml sel -t -m '/AVRPART/V2/modules/module/registers[@name='\'${i}\'']' -c . $devicefile | sed s,registers,group,g | sed "s,/>,>,g" >> $headerfile-iogroups.xml
+    TYPE=$(xml sel -T -t -m '/AVRPART/V2/modules/module/registers[@name='\'${i}\'']' -v "@implements" $devicefile)
+    xml sel -t -m '/AVRPART/V2/templates/module/registers[@name='\'${TYPE}\'']' -c . $devicefile >> $headerfile-iogroups.xml
+    echo "</group>" | sed "s,>,>\r,g" >> $headerfile-iogroups.xml
+done
+echo "</AVRPART>" | sed "s,>,>\r,g" >> $headerfile-iogroups.xml
+
+# Make all groups have consistent width of offset address.
+for i in $GROUP_NAMES ; do \
+    value=$(printf "0x%04X" $(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']' -v "@offset" $headerfile-iogroups.xml))
+    xml ed -O -u '/AVRPART/group[@name='\'${i}\'']/@offset' -v "$value" $headerfile-iogroups.xml > $headerfile-temp.xml
+    mv -f $headerfile-temp.xml $headerfile-iogroups.xml
+done
+
+# Re-sort iogroups temporary XML file.
+xml sel -t -e AVRPART -m "/AVRPART/group" -s "A:T:-" "@offset" -c . $headerfile-iogroups.xml > $headerfile-temp.xml
+mv -f $headerfile-temp.xml $headerfile-iogroups.xml
+
+# Re-get set of register group names.
+GROUP_NAMES=$(xml sel -T -t -m /AVRPART/group -s "A:T:-" "@offset" -v "concat(@name,' ')" $headerfile-iogroups.xml)
+
+# Add absolute address to registers.
+for i in $GROUP_NAMES ; do \
+    GROUP_OFFSET=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']' -v "@offset" $headerfile-iogroups.xml)
+    REG_NAMES=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers/child::*' -v "concat(@name,' ')" $headerfile-iogroups.xml)
+    for j in $REG_NAMES ; do \
+        value=$(printf "0x%04X" $(($GROUP_OFFSET + $(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers/child::*[@name='\'${j}\'']' -v "@offset" $headerfile-iogroups.xml))))
+        xml ed -O -a '/AVRPART/group[@name='\'${i}\'']/registers/child::*[@name='\'${j}\'']' -t attr -n "address" -v "$value" $headerfile-iogroups.xml > $headerfile-temp.xml
+        mv -f $headerfile-temp.xml $headerfile-iogroups.xml
+    done
+done
+
+
+
+# XMEGA Global Registers
+#---------------------------
+echo "/* Ungrouped common registers */" >> $headerfile
+for i in $GROUP_NAMES ; do
+    REGISTERS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@globalregs='\'true\'']' -v "concat(@name,' ')" $headerfile-iogroups.xml)
+    for j in $REGISTERS ; do
+        REG_OFFSETS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@globalregs='\'true\''][@name='\'${j}\'']/child::*' -v "concat(@offset,' ')" $headerfile-iogroups.xml | sort)
+        for k in $REG_OFFSETS ; do
+            REG_NAME=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@globalregs='\'true\''][@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@name" $headerfile-iogroups.xml)
+            if test -n "$REG_NAME" ; then
+                REG_SIZE=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@size" $headerfile-iogroups.xml)
+                REG_ADDRESS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@address" $headerfile-iogroups.xml)
+                REG_TEXT=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@text" $headerfile-iogroups.xml)
+                if test -n "$REG_SIZE" ; then
+                    if test "$REG_SIZE" = "1" ; then
+                        echo "#define ${REG_NAME}  _SFR_MEM8(${REG_ADDRESS})  /* ${REG_TEXT} */" >> $headerfile
+                    fi
+                    if test "$REG_SIZE" = "2" ; then
+                        echo "#define ${REG_NAME}  _SFR_MEM16(${REG_ADDRESS})  /* ${REG_TEXT} */" >> $headerfile
+                    fi
+                fi
+            fi
+        done
+        echo "" >> $headerfile
+    done
+done
+echo "" >> $headerfile
+
+
+
+# XMEGA types
+#-----------------
+cat << eof >> $headerfile
+/* C Language Only */
+#if !defined (__ASSEMBLER__)
+
+#include <stdint.h>
+
+typedef volatile uint8_t register8_t;
+typedef volatile uint16_t register16_t;
+typedef volatile uint32_t register32_t;
+
+
+#ifdef _WORDREGISTER
+#undef _WORDREGISTER
+#endif
+#define _WORDREGISTER(regname)   \\
+    __extension__ union \\
+    { \\
+        register16_t regname; \\
+        struct \\
+        { \\
+            register8_t regname ## L; \\
+            register8_t regname ## H; \\
+        }; \\
+    }
+
+#ifdef _DWORDREGISTER
+#undef _DWORDREGISTER
+#endif
+#define _DWORDREGISTER(regname)  \\
+    __extension__ union \\
+    { \\
+        register32_t regname; \\
+        struct \\
+        { \\
+            register8_t regname ## 0; \\
+            register8_t regname ## 1; \\
+            register8_t regname ## 2; \\
+            register8_t regname ## 3; \\
+        }; \\
+    }
+
+
+eof
+
+
+# XMEGA Register and Enumerator Structures
+#-----------------------------------------
+
+echo "/*" >> $headerfile
+echo "==========================================================================" >> $headerfile
+echo "IO Module Structures" >> $headerfile
+echo "==========================================================================" >> $headerfile
+echo "*/" >> $headerfile
+echo "" >> $headerfile
+
+MODULES=$(xml sel -T -t -m "/AVRPART/V2/templates/module" -v "concat(@class,' ')" $devicefile)
+for i in $MODULES ; do
+    MODULE_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']' -v "@text" $devicefile)
+    
+    # Generate register structures.
+    REGISTERS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers' -v "concat(@name,' ')" $devicefile)
+    for j in $REGISTERS ; do
+        GLOBALREGS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']' -v "@globalregs" $devicefile)
+        
+        if test "$GLOBALREGS" != "true" ; then
+
+            echo "/*" >> $headerfile
+            echo "--------------------------------------------------------------------------" >> $headerfile
+            echo "$i - $MODULE_TEXT" >> $headerfile
+            echo "--------------------------------------------------------------------------" >> $headerfile
+            echo "*/" >> $headerfile
+            echo "" >> $headerfile
+
+            REGISTERS_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']' -v "@text" $devicefile)
+            echo "/* ${REGISTERS_TEXT} */" >> $headerfile
+            echo "typedef struct ${j}_struct" >> $headerfile
+            echo "{" >> $headerfile
+            
+            REG_OFFSETS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*' -v "concat(@offset,' ')" $devicefile | sort)
+            for k in $REG_OFFSETS ; do
+                REG_NAME=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@name" $devicefile)
+                REG_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@text" $devicefile)
+                REG_SIZE=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@size" $devicefile)
+                
+                if test -z "$REG_NAME" ; then
+                    echo "    register8_t reserved_${k};" >> $headerfile
+                else
+                    if test -n "$REG_SIZE" ; then
+                        if test "$REG_SIZE" = "1" ; then
+                            echo "    register8_t ${REG_NAME};  /* ${REG_TEXT} */" >> $headerfile
+                        elif test "$REG_SIZE" = "2" ; then
+                            echo "    _WORDREGISTER(${REG_NAME});  /* ${REG_TEXT} */" >> $headerfile
+                        fi
+                    else
+                        REG_IMPLEMENTS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@implements" $devicefile)
+                        echo "    ${REG_IMPLEMENTS}_t ${REG_NAME};  /* ${REG_TEXT} */" >> $headerfile
+                    fi
+                fi
+            done
+
+            echo "} ${j}_t;" >> $headerfile
+            echo "" >> $headerfile
+
+        fi
+    done
+    
+    # Generate enumerator structures.
+    ENUMERATORS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/enumerator' -v "concat(@name,' ')" $devicefile)
+    for j in $ENUMERATORS ; do
+        ENUMERATOR_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/enumerator[@name='\'${j}\'']' -v "@text" $devicefile)
+        echo "/* ${ENUMERATOR_TEXT} */" >> $headerfile
+        echo "typedef enum ${j}_enum" >> $headerfile
+        echo "{" >> $headerfile
+        
+        # Get enum shift value from bitfield data in a different part of the V2 data.
+        ENUM_SHIFT=
+        for m in $REGISTERS ; do
+            REG_OFFSETS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${m}\'']/child::*' -v "concat(@offset,' ')" $devicefile | sort)
+            for n in $REG_OFFSETS ; do
+                BITFIELD_NAMES=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${m}\'']/child::*[@offset='\'${n}\'']/bitfield' -v "concat(@name,' ')" $devicefile)
+                for p in $BITFIELD_NAMES ; do
+                    BITFIELD_ENUM=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${m}\'']/child::*[@offset='\'${n}\'']/bitfield[@name='\'${p}\'']' -v "@enum" $devicefile)
+                    if test "$BITFIELD_ENUM" = "$j" ; then
+                        
+                        # The enum shift value is equal to the number of lsb 0 bits 
+                        # in the mask value of the bitfield that has a matching enum name.
+                        ENUM_SHIFT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${m}\'']/child::*[@offset='\'${n}\'']/bitfield[@name='\'${p}\'']' \
+                            -v "@mask" $devicefile | \
+                            sed "s,0x.2,1,g" | \
+                            sed "s,0x.4,2,g" | \
+                            sed "s,0x.6,1,g" | \
+                            sed "s,0x.8,3,g" | \
+                            sed "s,0x.C,2,g" | \
+                            sed "s,0x.E,1,g" | \
+                            sed "s,0x10,4,g" | \
+                            sed "s,0x30,4,g" | \
+                            sed "s,0x70,4,g" | \
+                            sed "s,0xF0,4,g" | \
+                            sed "s,0x20,5,g" | \
+                            sed "s,0x60,5,g" | \
+                            sed "s,0xE0,5,g" | \
+                            sed "s,0x40,6,g" | \
+                            sed "s,0xC0,6,g" | \
+                            sed "s,0x80,7,g" | \
+                            sed "s,0x..,0,g" )
+                        
+                        # Match only the first enum value found so break out.
+                        break 3
+                    fi
+                done
+            done
+        done
+
+        ENUMS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/enumerator[@name='\'${j}\'']/enum' -v "concat(@name,' ')" $devicefile)
+        for k in $ENUMS ; do
+            ENUM_VALUE=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/enumerator[@name='\'${j}\'']/enum[@name='\'${k}\'']' -v "@val" $devicefile)
+            ENUM_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/enumerator[@name='\'${j}\'']/enum[@name='\'${k}\'']' -v "@text" $devicefile)
+            echo "    ${j}_${k}_gc = (${ENUM_VALUE}<<${ENUM_SHIFT}),  /* ${ENUM_TEXT} */" >> $headerfile
+        done
+        
+        echo "} ${j}_t;" >> $headerfile
+        echo "" >> $headerfile
+    done
+    echo "" >> $headerfile
+done
+echo "" >> $headerfile
+
+
+
+
+# XMEGA Register Structure Instances
+#--------------------------------------
+echo "/*" >> $headerfile
+echo "==========================================================================" >> $headerfile
+echo "IO Module Instances. Mapped to memory." >> $headerfile
+echo "==========================================================================" >> $headerfile
+echo "*/" >> $headerfile
+echo "" >> $headerfile
+for i in $(xml sel -T -t -m /AVRPART/group -s "A:T:-" "@offset" -v "concat(@name,' ')" $headerfile-iogroups.xml | sed "s,GPIO ,,g" | sed "s,CPU ,,g") ; do
+    IMPLEMENTS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']' -v @implements $headerfile-iogroups.xml)
+    OFFSET=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']' -v @offset $headerfile-iogroups.xml)
+    TEXT=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']' -v @text $headerfile-iogroups.xml)
+    echo "#define ${i}    (*(${IMPLEMENTS}_t *) ${OFFSET})  /* ${TEXT} */" >> $headerfile
+done
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+echo "#endif /* !defined (__ASSEMBLER__) */" >> $headerfile
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+
+# XMEGA Flattened fully qualified IO register names
+#---------------------------------------------------
+
+echo "/* ========== Flattened fully qualified IO register names ========== */" >> $headerfile
+echo "" >> $headerfile
+
+for i in $GROUP_NAMES ; do
+    GROUP_TEXT=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']' -v "@text" $headerfile-iogroups.xml)
+    echo "/* ${i} - ${GROUP_TEXT} */" >> $headerfile
+    
+    REGISTERS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers' -v "concat(@name,' ')" $headerfile-iogroups.xml)
+    for j in $REGISTERS ; do
+    
+        REG_OFFSETS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*' -v "concat(@offset,' ')" $headerfile-iogroups.xml | sort)
+        for k in $REG_OFFSETS ; do
+            REG_NAME=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@name" $headerfile-iogroups.xml)
+            if test -n "$REG_NAME" ; then
+                REG_SIZE=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@size" $headerfile-iogroups.xml)
+                REG_ADDRESS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@address" $headerfile-iogroups.xml)
+                if test -n "$REG_SIZE" ; then
+                    if test "$REG_SIZE" = "1" ; then
+                        echo "#define ${i}_${REG_NAME}  _SFR_MEM8(${REG_ADDRESS})" >> $headerfile
+                    fi
+                    if test "$REG_SIZE" = "2" ; then
+                        echo "#define ${i}_${REG_NAME}  _SFR_MEM16(${REG_ADDRESS})" >> $headerfile
+                    fi
+                else
+                    REG_IMPLEMENTS=$(xml sel -T -t -m '/AVRPART/group[@name='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@implements" $headerfile-iogroups.xml)
+                  
+
+                    MODULES=$(xml sel -T -t -m "/AVRPART/V2/templates/module" -v "concat(@class,' ')" $devicefile)
+                    for m in $MODULES ; do
+                        REGISTERS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${m}\'']/registers' -v "concat(@name,' ')" $devicefile)
+                        for n in $REGISTERS ; do
+                            if test "$n" = "$REG_IMPLEMENTS" ; then
+                                REG_OFFSETS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${m}\'']/registers[@name='\'${n}\'']/child::*' -v "concat(@offset,' ')" $devicefile | sort)
+                                for p in $REG_OFFSETS ; do
+                                    SUBREG_NAME=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${m}\'']/registers[@name='\'${n}\'']/child::*[@offset='\'${p}\'']' -v "@name" $devicefile)
+                                    SUBREG_SIZE=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${m}\'']/registers[@name='\'${n}\'']/child::*[@offset='\'${p}\'']' -v "@size" $devicefile)
+                                    SUBREG_OFFSET=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${m}\'']/registers[@name='\'${n}\'']/child::*[@offset='\'${p}\'']' -v "@offset" $devicefile)
+                                    if test -n "$SUBREG_NAME" ; then
+                                        ADDRESS=$(printf "0x%04X" $(($REG_ADDRESS + $SUBREG_OFFSET)))
+                                        if test "$SUBREG_SIZE" = "1" ; then
+                                            echo "#define ${i}_${REG_NAME}_${SUBREG_NAME}  _SFR_MEM8(${ADDRESS})" >> $headerfile
+                                        fi
+                                        if test "$SUBREG_SIZE" = "2" ; then
+                                            echo "#define ${i}_${REG_NAME}_${SUBREG_NAME}  _SFR_MEM16(${ADDRESS})" >> $headerfile
+                                        fi
+                                    fi
+                                done
+                                break 2
+                            fi
+                        done
+                    done    
+                fi
+            fi
+        done
+    done
+    echo "" >> $headerfile
+done
+echo "" >> $headerfile
+
+
+
+#echo "#endif /* !defined (__ASSEMBLER__) */" >> $headerfile
+#echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+# XMEGA Bitfield definitions
+#---------------------------------------------------
+
+echo "/*================== Bitfield Definitions ================== */" >> $headerfile
+echo "" >> $headerfile
+MODULE_NAMES=$(xml sel -T -t -m /AVRPART/V2/templates/module -v "concat(@class,' ')" $devicefile)
+for i in $MODULE_NAMES ; do
+    PREV_MODULE_NAME=
+    MODULE_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']' -v "@text" $devicefile)
+    
+    REGISTER_GROUPS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers' -v "concat(@name,' ')" $devicefile)
+    for j in $REGISTER_GROUPS ; do
+    
+        REG_OFFSETS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*' -v "concat(@offset,' ')" $devicefile | sort)
+        for k in $REG_OFFSETS ; do
+            REGNAME=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']' -v "@name" $devicefile)
+            BITFIELDS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']/bitfield' -v "concat(@name,' ')" $devicefile)
+            
+            if test -n "$BITFIELDS" ; then
+                if test -z $PREV_MODULE_NAME ; then
+                    echo "/* ${i} - ${MODULE_TEXT} */" >> $headerfile
+                    PREV_MODULE_NAME=$i
+                fi
+
+                echo "/* ${j}.${REGNAME}  bit masks and bit positions */" >> $headerfile
+                
+                for m in $BITFIELDS ; do
+                    BITFIELD_GROUP_MASK=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']/bitfield[@name='\'${m}\'']' -v "@mask" $devicefile)
+                    BITFIELD_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'${i}\'']/registers[@name='\'${j}\'']/child::*[@offset='\'${k}\'']/bitfield[@name='\'${m}\'']' -v "@text" $devicefile)
+                    BITFIELD_GROUP_POSITION=$(echo $BITFIELD_GROUP_MASK | \
+                        sed "s,0x.2,1,g" | \
+                        sed "s,0x.4,2,g" | \
+                        sed "s,0x.6,1,g" | \
+                        sed "s,0x.8,3,g" | \
+                        sed "s,0x.C,2,g" | \
+                        sed "s,0x.E,1,g" | \
+                        sed "s,0x10,4,g" | \
+                        sed "s,0x30,4,g" | \
+                        sed "s,0x70,4,g" | \
+                        sed "s,0xF0,4,g" | \
+                        sed "s,0x20,5,g" | \
+                        sed "s,0x60,5,g" | \
+                        sed "s,0xE0,5,g" | \
+                        sed "s,0x40,6,g" | \
+                        sed "s,0xC0,6,g" | \
+                        sed "s,0x80,7,g" | \
+                        sed "s,0x..,0,g" )
+
+                    BITFIELD_MASK=$(($BITFIELD_GROUP_MASK >> $BITFIELD_GROUP_POSITION))
+                    if test $(( $BITFIELD_MASK )) -gt 1 ; then
+                        DEFINITION=" ${j}_${m}_gm "
+                        grep "${DEFINITION}" $headerfile
+                        if test $? -eq 0 ; then
+                            echo "/*${DEFINITION} Predefined. */" >> $headerfile
+                        else
+                            echo "#define ${j}_${m}_gm  ${BITFIELD_GROUP_MASK}  /* ${BITFIELD_TEXT} group mask. */" >> $headerfile
+                        fi
+                        
+                        DEFINITION=" ${j}_${m}_gp "
+                        grep "${DEFINITION}" $headerfile
+                        if test $? -eq 0 ; then
+                            echo "/*${DEFINITION} Predefined. */" >> $headerfile
+                        else
+                            echo "#define ${j}_${m}_gp  ${BITFIELD_GROUP_POSITION}  /* ${BITFIELD_TEXT} group position. */" >> $headerfile
+                        fi
+                        
+                        BITNUM="0"
+                        while test $(($BITFIELD_MASK & 0x01)) -eq 1 ; do
+                            DEFINITION=" ${j}_${m}${BITNUM}_bm "
+                            grep "${DEFINITION}" $headerfile
+                            if test $? -eq 0 ; then
+                                echo "/*${DEFINITION} Predefined. */" >> $headerfile
+                            else
+                                echo "#define ${j}_${m}${BITNUM}_bm  (1<<${BITFIELD_GROUP_POSITION})  /* ${BITFIELD_TEXT} bit ${BITNUM} mask. */" >> $headerfile
+                            fi
+                            
+                            DEFINITION=" ${j}_${m}${BITNUM}_bp "
+                            grep "${DEFINITION}" $headerfile
+                            if test $? -eq 0 ; then
+                                echo "/*${DEFINITION} Predefined. */" >> $headerfile
+                            else
+                                echo "#define ${j}_${m}${BITNUM}_bp  ${BITFIELD_GROUP_POSITION}  /* ${BITFIELD_TEXT} bit ${BITNUM} position. */" >> $headerfile
+                            fi
+                            
+                            BITFIELD_GROUP_POSITION=$(($BITFIELD_GROUP_POSITION + 1))
+                            BITFIELD_MASK=$(($BITFIELD_MASK >> 1))
+                            BITNUM=$(($BITNUM + 1))
+                        done
+                    else
+                        DEFINITION=" ${j}_${m}_bm "
+                        grep "${DEFINITION}" $headerfile
+                        if test $? -eq 0 ; then
+                            echo "/*${DEFINITION} Predefined. */" >> $headerfile
+                        else
+                            echo "#define ${j}_${m}_bm  ${BITFIELD_GROUP_MASK}  /* ${BITFIELD_TEXT} bit mask. */" >> $headerfile
+                        fi
+                        
+                        DEFINITION=" ${j}_${m}_bp "
+                        grep "${DEFINITION}" $headerfile
+                        if test $? -eq 0 ; then
+                            echo "/*${DEFINITION} Predefined. */" >> $headerfile
+                        else
+                            echo "#define ${j}_${m}_bp  ${BITFIELD_GROUP_POSITION}  /* ${BITFIELD_TEXT} bit position. */" >> $headerfile
+                        fi
+                    fi
+                    echo "" >> $headerfile
+                    
+                done
+                echo "" >> $headerfile
+            fi
+        done
+    done
+done
+echo "" >> $headerfile
+
+
+# XMEGA Generic Port Pin definitions
+#---------------------------------------------------
+cat << eof >> $headerfile
+// Generic Port Pins
+
+#define PIN0_bm 0x01 
+#define PIN0_bp 0
+#define PIN1_bm 0x02
+#define PIN1_bp 1
+#define PIN2_bm 0x04 
+#define PIN2_bp 2
+#define PIN3_bm 0x08 
+#define PIN3_bp 3
+#define PIN4_bm 0x10 
+#define PIN4_bp 4
+#define PIN5_bm 0x20 
+#define PIN5_bp 5
+#define PIN6_bm 0x40 
+#define PIN6_bp 6
+#define PIN7_bm 0x80 
+#define PIN7_bp 7
+
+
+eof
+
+
+
+# XMEGA Interrupt Vector definitions
+#---------------------------------------------------
+echo "/* ========== Interrupt Vector Definitions ========== */" >> $headerfile
+echo "/* Vector 0 is the reset vector */" >> $headerfile
+echo "" >> $headerfile
+INTERRUPT_MODULES=$(xml sel -T -t -m /AVRPART/V2/interrupts/interrupt-group -v "concat(@module,' ')" $devicefile)
+for i in $INTERRUPT_MODULES ; do
+    echo "/* ${i} interrupt vectors */" >> $headerfile
+    MODULE_REF=$(xml sel -T -t -m '/AVRPART/V2/interrupts/interrupt-group[@module='\'${i}\'']' -v "@ref" $devicefile)
+    MODULE_OFFSET=$(xml sel -T -t -m '/AVRPART/V2/interrupts/interrupt-group[@module='\'${i}\'']' -v "@offset" $devicefile)
+    
+    INTERRUPTS=$(xml sel -T -t -m '/AVRPART/V2/templates/module/interrupt-group[@name='\'${MODULE_REF}\'']/int' -s "A:T:-" "@offset" -v "concat(@name,' ')" $devicefile)
+    for j in $INTERRUPTS ; do
+        INT_OFFSET=$(xml sel -T -t -m '/AVRPART/V2/templates/module/interrupt-group[@name='\'${MODULE_REF}\'']/int[@name='\'${j}\'']' -v "@offset" $devicefile)
+        INT_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module/interrupt-group[@name='\'${MODULE_REF}\'']/int[@name='\'${j}\'']' -v "@text" $devicefile)
+        VECTOR_NUM=$(($MODULE_OFFSET + $INT_OFFSET))
+        echo "#define ${i}_${j}_vect_num  ${VECTOR_NUM}" >> $headerfile
+        echo "#define ${i}_${j}_vect      _VECTOR(${VECTOR_NUM})  /* ${INT_TEXT} */" >> $headerfile
+    done
+    echo "" >> $headerfile
+done
+echo "" >> $headerfile
+
+# todo: Remove hard-coded vector size.
+echo "#define _VECTOR_SIZE 4 /* Size of individual vector. */" >> $headerfile
+VECTOR_NUM=$(($VECTOR_NUM + 1))
+echo "#define _VECTORS_SIZE (${VECTOR_NUM} * _VECTOR_SIZE)" >> $headerfile
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+# XMEGA Constant definitions
+#---------------------------------------------------
+echo "/* ========== Constants ========== */" >> $headerfile
+echo "" >> $headerfile
+
+MEMSPACE_NAMES=$(xml sel -T -t -m "/AVRPART/V2/memspaces/memspace" -v "concat(@name,' ')" $devicefile)
+for i in $MEMSPACE_NAMES ; do
+    MEMSPACE_START=$(xml sel -T -t -m '/AVRPART/V2/memspaces/memspace[@name='\'${i}\'']' -v "@start" $devicefile)
+    MEMSPACE_SIZE=$(( $(xml sel -T -t -m '/AVRPART/V2/memspaces/memspace[@name='\'${i}\'']' -v "@size" $devicefile) ))
+    MEMSPACE_PAGE_SIZE=$(( $(xml sel -T -t -m '/AVRPART/V2/memspaces/memspace[@name='\'${i}\'']' -v "@pagesize" $devicefile) ))
+    echo "#define ${i}_START     (${MEMSPACE_START})" >> $headerfile
+    echo "#define ${i}_SIZE      (${MEMSPACE_SIZE})" >> $headerfile
+    echo "#define ${i}_PAGE_SIZE (${MEMSPACE_PAGE_SIZE})" >> $headerfile
+    echo "#define ${i}_END       (${i}_START + ${i}_SIZE - 1)" >> $headerfile
+    echo "" >> $headerfile
+done
+
+echo "#define FLASHEND     PROGMEM_END" >> $headerfile
+echo "#define SPM_PAGESIZE PROGMEM_PAGE_SIZE" >> $headerfile
+echo "#define RAMSTART     INTERNAL_SRAM_START" >> $headerfile
+echo "#define RAMSIZE      INTERNAL_SRAM_SIZE" >> $headerfile
+echo "#define RAMEND       INTERNAL_SRAM_END" >> $headerfile
+echo "#define XRAMSTART    EXTERNAL_SRAM_START" >> $headerfile
+echo "#define XRAMSIZE     EXTERNAL_SRAM_SIZE" >> $headerfile
+if test $(( $(xml sel -T -t -m "/AVRPART/V2/memspaces/memspace[@name='EXTERNAL_SRAM']" -v "@size" $devicefile) )) -gt 0 ; then
+    echo "#define XRAMEND      EXTERNAL_SRAM_END" >> $headerfile
+else
+    echo "#define XRAMEND      INTERNAL_SRAM_END" >> $headerfile
+fi
+echo "#define E2END        EEPROM_END" >> $headerfile
+echo "#define E2PAGESIZE   EEPROM_PAGE_SIZE" >> $headerfile
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+# XMEGA Fuse information
+#---------------------------------------------------
+FUSECOUNT=$(xml sel -T -t -v 'count(/AVRPART/V2/templates/module/registers[@memspace='\'FUSE\'']/reg)' $devicefile)
+echo "/* ========== Fuses ========== */" >> $headerfile
+echo "#define FUSE_MEMORY_SIZE ${FUSECOUNT}" >> $headerfile
+echo "" >> $headerfile
+FUSEBYTES=$(xml sel -T -t -m '/AVRPART/V2/templates/module/registers[@memspace='\'FUSE\'']/reg' -s "A:T:-" "@offset" -v "concat(@offset,' ')" $devicefile)
+FUSEBYTENUM=0
+for i in $FUSEBYTES ; do
+    FUSEBYTENAME=$(xml sel -T -t -m '/AVRPART/V2/templates/module/registers[@memspace='\'FUSE\'']/reg[@offset='\'${i}\'']' -v "@name" $devicefile)
+    if test -z "$FUSEBYTENAME" ; then
+        echo "/* Fuse Byte ${FUSEBYTENUM} Reserved */" >> $headerfile
+    else
+        echo "/* Fuse Byte ${FUSEBYTENUM} */" >> $headerfile
+        FUSEBITFIELDS=$(xml sel -T -t -m '/AVRPART/V2/templates/module/registers[@memspace='\'FUSE\'']/reg[@offset='\'${i}\'']/bitfield' -s "A:T:-" "@mask" -v "concat(@name,' ')" $devicefile)
+        for j in $FUSEBITFIELDS ; do
+            FUSEBITFIELD_TEXT=$(xml sel -T -t -m '/AVRPART/V2/templates/module/registers[@memspace='\'FUSE\'']/reg[@offset='\'${i}\'']/bitfield[@name='\'${j}\'']' \
+                -v "@text" $devicefile)
+            FUSEBITFIELD_MASK=$(xml sel -T -t -m '/AVRPART/V2/templates/module/registers[@memspace='\'FUSE\'']/reg[@offset='\'${i}\'']/bitfield[@name='\'${j}\'']' \
+                -v "@mask" $devicefile)
+            FUSEBITFIELD_SHIFT=$(echo "$FUSEBITFIELD_MASK" | \
+                sed "s,0x.2,1,g" | \
+                sed "s,0x.4,2,g" | \
+                sed "s,0x.6,1,g" | \
+                sed "s,0x.8,3,g" | \
+                sed "s,0x.C,2,g" | \
+                sed "s,0x.E,1,g" | \
+                sed "s,0x10,4,g" | \
+                sed "s,0x30,4,g" | \
+                sed "s,0x70,4,g" | \
+                sed "s,0xF0,4,g" | \
+                sed "s,0x20,5,g" | \
+                sed "s,0x60,5,g" | \
+                sed "s,0xE0,5,g" | \
+                sed "s,0x40,6,g" | \
+                sed "s,0xC0,6,g" | \
+                sed "s,0x80,7,g" | \
+                sed "s,0x..,0,g" )
+            FUSEBITFIELD_MASK=$(( $FUSEBITFIELD_MASK >> $FUSEBITFIELD_SHIFT ))
+            if test $(( $FUSEBITFIELD_MASK )) -gt 1 ; then 
+                BITNUM=0
+                while test $(($FUSEBITFIELD_MASK & 0x01)) -eq 1 ; do
+                    echo "#define FUSE_${j}${BITNUM}  (unsigned char)~_BV(${FUSEBITFIELD_SHIFT})  /* ${FUSEBITFIELD_TEXT} Bit ${BITNUM} */" >> $headerfile
+                    FUSEBITFIELD_MASK=$(($FUSEBITFIELD_MASK >> 1))
+                    BITNUM=$(($BITNUM + 1))
+                    FUSEBITFIELD_SHIFT=$(($FUSEBITFIELD_SHIFT + 1))
+                done
+            else
+                echo "#define FUSE_${j}  (unsigned char)~_BV(${FUSEBITFIELD_SHIFT})  /* ${FUSEBITFIELD_TEXT} */" >> $headerfile
+            fi
+        done
+        echo "#define FUSE${FUSEBYTENUM}_DEFAULT  (0xFF)" >> $headerfile
+    fi
+    echo "" >> $headerfile
+    FUSEBYTENUM=$((FUSEBYTENUM + 1))
+done
+echo "" >> $headerfile
+# todo: Default XMEGA fuse values are currently hardcoded to 0xFF.
+
+
+
+# XMEGA Lockbit information
+#---------------------------------------------------
+echo "/* ========== Lock Bits ========== */" >> $headerfile
+LOCK_BITS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'NVM\'']/registers/reg[@name='\'LOCKBITS\'']/bitfield[@name='\'LB\'']' -v "@name" $devicefile)
+if test -n "$LOCK_BITS" ; then
+    echo "#define __LOCK_BITS_EXIST" >> $headerfile
+fi
+
+BOOT_LOCK_APPLICATION_TABLE_BITS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'NVM\'']/registers/reg[@name='\'LOCKBITS\'']/bitfield[@name='\'BLBAT\'']' -v "@name" $devicefile)
+if test -n "$BOOT_LOCK_APPLICATION_TABLE_BITS" ; then
+    echo "#define __BOOT_LOCK_APPLICATION_TABLE_BITS_EXIST" >> $headerfile
+fi
+
+BOOT_LOCK_APPLICATION_BITS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'NVM\'']/registers/reg[@name='\'LOCKBITS\'']/bitfield[@name='\'BLBA\'']' -v "@name" $devicefile)
+if test -n "$BOOT_LOCK_APPLICATION_BITS" ; then
+    echo "#define __BOOT_LOCK_APPLICATION_BITS_EXIST" >> $headerfile
+fi
+
+BOOT_LOCK_BOOT_BITS=$(xml sel -T -t -m '/AVRPART/V2/templates/module[@class='\'NVM\'']/registers/reg[@name='\'LOCKBITS\'']/bitfield[@name='\'BLBB\'']' -v "@name" $devicefile)
+if test -n "$BOOT_LOCK_BOOT_BITS" ; then
+    echo "#define __BOOT_LOCK_BOOT_BITS_EXIST" >> $headerfile
+fi
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+# XMEGA Signature information
+#----------------------------------------------
+SIGNATURE_0=$(xml sel -T -t -m "/AVRPART/ADMIN/SIGNATURE" -v "ADDR000" $devicefile | sed "s,\\$,0x,g")
+SIGNATURE_1=$(xml sel -T -t -m "/AVRPART/ADMIN/SIGNATURE" -v "ADDR001" $devicefile | sed "s,\\$,0x,g")
+SIGNATURE_2=$(xml sel -T -t -m "/AVRPART/ADMIN/SIGNATURE" -v "ADDR002" $devicefile | sed "s,\\$,0x,g")
+echo "/* ========== Signature ========== */" >> $headerfile
+echo "#define SIGNATURE_0 ${SIGNATURE_0}" >> $headerfile
+echo "#define SIGNATURE_1 ${SIGNATURE_1}" >> $headerfile
+echo "#define SIGNATURE_2 ${SIGNATURE_2}" >> $headerfile
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+else
+
+
+# Classic AVR
+#==================
+
+# Registers and bit numbers.
+#-----------------------------
+
+# Get register section from input file and remove some unused elements.
+xml sel -t -c /AVRPART/MEMORY/IO_MEMORY $devicefile | \
+    xml ed -O \
+        -d /IO_MEMORY/IO_START_ADDR \
+        -d /IO_MEMORY/IO_STOP_ADDR \
+        -d /IO_MEMORY/EXT_IO_START_ADDR \
+        -d /IO_MEMORY/EXT_IO_STOP_ADDR \
+        -d /IO_MEMORY/MEM_START_ADDR \
+        -d /IO_MEMORY/MEM_STOP_ADDR > $headerfile-iomemory.xml
+
+# Get list of register names.
+REGNAMES=$(xml el $headerfile-iomemory.xml | sed "s,IO_MEMORY$,,g" | cut -d '/' -f 2 | sed "s,\r,,g" | uniq)
+
+# Convert temporary working XML file to PYX.
+xml pyx $headerfile-iomemory.xml > $headerfile-iomemory.pyx
+
+# For each register...
+MAX_ADDRESS_WIDTH=0
+for i in $REGNAMES ; do \
+    
+    # Get IO address.
+    IOADDR=$(xml sel -t -v /IO_MEMORY/$i/IO_ADDR $headerfile-iomemory.xml | sed "s,\r,," | sed "s,NA,," | sed "s,\\$,0x,g")
+    
+    # Get Memory address.
+    MEMADDR=$(xml sel -t -v /IO_MEMORY/$i/MEM_ADDR $headerfile-iomemory.xml | sed "s,\r,," | sed "s,\\$,0x,g")
+    
+    # Check for max width of address
+    WIDTH=$(( $(echo "$IOADDR" | wc -m) ))
+    if test $WIDTH -gt $MAX_ADDRESS_WIDTH ; then
+        MAX_ADDRESS_WIDTH=$WIDTH
+    fi
+    WIDTH=$(( $(echo "$MEMADDR" | wc -m) ))
+    if test $WIDTH -gt $MAX_ADDRESS_WIDTH ; then
+        MAX_ADDRESS_WIDTH=$WIDTH
+    fi
+    
+    # Get initialization value (if exists).
+    INIT=$(xml sel -t -v /IO_MEMORY/$i/INIT $headerfile-iomemory.xml | sed "s,\r,,")
+    
+    # Determine type of address.
+    if test -z "$IOADDR"; then
+        TYPE="mem"
+    else
+        TYPE="io"
+    fi
+    
+    # Convert named register element to REGISTER element with attributes in the PYX file.
+    sed -i "s,(${i}$,(REGISTER\nAname $i\nAtype $TYPE\nAio_addr $IOADDR\nAmem_addr $MEMADDR\nAsize 8\nAinit $INIT," $headerfile-iomemory.pyx
+    sed -i "s,)${i}$,)REGISTER," $headerfile-iomemory.pyx
+done
+# Subtract 3 from max address width: 2 for "0x" and 1 for line feed when echoing to wc.
+MAX_ADDRESS_WIDTH=$(( $MAX_ADDRESS_WIDTH - 3 ))
+
+
+#   - Convert temporary PYX file back to temporary XML file.
+#   - Remove unused (previously converted) elements, and common registers we won't keep.
+#   - Convert named bit mask elements to BIT elements with attributes
+#   - Sort the register names based on the memory address element.
+#   - Save it to the temporary XML file.
+xml depyx $headerfile-iomemory.pyx | \
+    xml ed -O \
+        -d "/IO_MEMORY/REGISTER/IO_ADDR" \
+        -d "/IO_MEMORY/REGISTER/MEM_ADDR" \
+        -d "/IO_MEMORY/REGISTER/INIT" \
+        -d "/IO_MEMORY/REGISTER[@name='SREG']" \
+        -d "/IO_MEMORY/REGISTER[@name='SP']" \
+        -d "/IO_MEMORY/REGISTER[@name='SPL']" \
+        -d "/IO_MEMORY/REGISTER[@name='SPH']" | \
+    sed 's,<.*_MASK>0x01</,<BIT value="0" name=",g' | \
+    sed 's,<.*_MASK>0x02</,<BIT value="1" name=",g' | \
+    sed 's,<.*_MASK>0x04</,<BIT value="2" name=",g' | \
+    sed 's,<.*_MASK>0x08</,<BIT value="3" name=",g' | \
+    sed 's,<.*_MASK>0x10</,<BIT value="4" name=",g' | \
+    sed 's,<.*_MASK>0x20</,<BIT value="5" name=",g' | \
+    sed 's,<.*_MASK>0x40</,<BIT value="6" name=",g' | \
+    sed 's,<.*_MASK>0x80</,<BIT value="7" name=",g' | \
+    sed 's,_MASK>$,"/>,g' | \
+    xml sel -t -e IO_MEMORY -n -m "/IO_MEMORY/REGISTER" -s "A:T:-" "@mem_addr" -c . -n > $headerfile-iomemory.xml
+
+# Remove temporary PYX file.
+rm $headerfile-iomemory.pyx
+
+# Calculate the set of word size register names needed.
+#   - Get list of all register names, each name followed by an EOL.
+#   - Convert to Unix line endings (for sed patterns to work).
+#   - Cut off ending '_L' of register names.
+#   - Cut off ending '_H' of register names.
+#   - Cut off ending 'L' of register names.
+#   - Cut off ending 'H' of register names.
+#   - Get list of only duplicate register names.
+#   - Remove duplicates.
+REGNAMES_WORD=$(xml sel -T -t -m "/IO_MEMORY/REGISTER" -v "@name" -n $headerfile-iomemory.xml | \
+    sed "s,\r\n,\n,g" | \
+    sed "s,_L$,,g" | \
+    sed "s,_H$,,g" | \
+    sed "s,L$,,g" | \
+    sed "s,H$,,g" | \
+    uniq -d | \
+    uniq)
+
+# Add word registers to temporary working XML file.
+#   - For each word register...
+for i in $REGNAMES_WORD ; do \
+    
+    # Get the register type from the Low register, 
+    #   convert to Unix line endings.
+    TYPE=$(xml sel -t -m '/IO_MEMORY/REGISTER[@name='\'${i}L\'']' -v "@type" $headerfile-iomemory.xml | sed "s,\r,,")
+    
+    # Get the io address from the Low register,
+    #   convert to Unix line endings.
+    IOADDR=$(xml sel -t -m '/IO_MEMORY/REGISTER[@name='\'${i}L\'']' -v "@io_addr" $headerfile-iomemory.xml | sed "s,\r,,")
+    
+    # Get the memory address from the Low register,
+    #   convert to Unix line endings.
+    MEMADDR=$(xml sel -t -m '/IO_MEMORY/REGISTER[@name='\'${i}L\'']' -v "@mem_addr" $headerfile-iomemory.xml | sed "s,\r,,")
+    
+    #   - Insert a new element before the Low register, name it as the word register
+    #   - Append a 'name' attribute
+    #   - Append a 'type' attribute
+    #   - Append a 'io_addr' attribute
+    #   - Append a 'mem_addr' attribute
+    #   - Append a 'size' attribute
+    #   - Rename the element to REGISTER
+    #   - Save to a 2nd temporary XML file.
+    xml ed -O -i '/IO_MEMORY/REGISTER[@name='\'${i}L\'']' --type "elem" -n "$i" -v "" \
+        -a '/IO_MEMORY/'${i} --type "attr" -n "name" -v "$i" \
+        -a '/IO_MEMORY/'${i} --type "attr" -n "type" -v "$TYPE" \
+        -a '/IO_MEMORY/'${i} --type "attr" -n "io_addr" -v "$IOADDR" \
+        -a '/IO_MEMORY/'${i} --type "attr" -n "mem_addr" -v "$MEMADDR" \
+        -a '/IO_MEMORY/'${i} --type "attr" -n "size" -v "16" \
+        -r '/IO_MEMORY/'${i} -v "REGISTER" $headerfile-iomemory.xml > $headerfile-iomem2.xml
+    
+    # Move 2nd temporary XML file to first.
+    mv $headerfile-iomem2.xml $headerfile-iomemory.xml
+done
+
+
+# Fix width of all addresses.
+ALLREGS=$(xml sel -T -t -m "/IO_MEMORY/REGISTER" -v "concat(@name,' ')" $headerfile-iomemory.xml)
+for i in $ALLREGS ; do
+    MEM_ADDR=$(xml sel -T -t -m '/IO_MEMORY/REGISTER[@name='\'${i}\'']' -v "@mem_addr" $headerfile-iomemory.xml)
+    if test -n "$MEM_ADDR" ; then
+        NEW_MEM_ADDR=$(printf "0x%0${MAX_ADDRESS_WIDTH}X" $(( $MEM_ADDR )) )
+        xml ed -O -u '/IO_MEMORY/REGISTER[@name='\'${i}\'']/@mem_addr' -v "$NEW_MEM_ADDR" $headerfile-iomemory.xml > $headerfile-tmp.xml
+        mv $headerfile-tmp.xml $headerfile-iomemory.xml
+    fi
+    IO_ADDR=$(xml sel -T -t -m '/IO_MEMORY/REGISTER[@name='\'${i}\'']' -v "@io_addr" $headerfile-iomemory.xml)
+    if test -n "$IO_ADDR" ; then
+        NEW_IO_ADDR=$(printf "0x%0${MAX_ADDRESS_WIDTH}X" $(( $IO_ADDR )) )
+        xml ed -O -u '/IO_MEMORY/REGISTER[@name='\'${i}\'']/@io_addr' -v "$NEW_IO_ADDR" $headerfile-iomemory.xml > $headerfile-tmp.xml
+        mv $headerfile-tmp.xml $headerfile-iomemory.xml
+    fi
+done
+
+
+# Output data from temporary working XML file to avr-libc I/O header file.
+#   Replace hyphens with underscores.
+echo "/* Registers and associated bit numbers. */" >> $headerfile
+xml sel -T \
+    -t -m "/IO_MEMORY/REGISTER[@type='io']" -s "A:T:-" "@io_addr" -n -v "concat('#define ',@name,' _SFR_IO',@size,'(',@io_addr,')')" -n \
+       -m "BIT[@value]" -s "A:T:-" "@value" -v "concat('#define ',@name,' ',@value)" -n \
+    -t -m "/IO_MEMORY/REGISTER[@type='mem']" -s "A:T:-" "@mem_addr" -n -v "concat('#define ',@name,' _SFR_MEM',@size,'(',@mem_addr,')')" -n \
+       -m "BIT[@value]" -s "A:T:-" "@value" -v "concat('#define ',@name,' ',@value)" -n \
+    -t -n -n $headerfile-iomemory.xml | \
+sed "s,-,_,g" >> $headerfile
+
+
+# Check for ADC 16-bit register and create ADCW with guard for assembly.
+ADC=$(grep "#define ADC " $headerfile | cut -d ' ' -f 3)
+if test -n "$ADC" ; then
+    sed -i "s,#define ADC ,#ifndef __ASSEMBLER__\\n#define ADC $ADC\\n#endif\\n#define ADCW ,g" $headerfile
+fi
+
+# Create list of 8-bit registers that have no associated bit names.
+REGS_NO_BITNAMES=$(xml sel -T -t -m "/IO_MEMORY/REGISTER[@size='8']" \
+    -i "count(BIT)=0" -v "@name" -n $headerfile-iomemory.xml | sed "s,\r\n,\n,g")
+
+# Create list of 8-bit registers in the XML file that have hyphens in the names.
+REGS_WITH_HYPHENS=$(xml sel -T -t -m "/IO_MEMORY/REGISTER[@size='8']" \
+    -i "contains(@name, '-')" -v "@name" -n \
+    -b -m "BIT" \
+    -i "contains(@name, '-')" -v "@name" -n \
+    $headerfile-iomemory.xml | sed "s,\r\n,\n,g")
+
+
+# Interrupt vectors.
+#----------------------
+NMB_VECTORS=$(xml sel -T -t -v /AVRPART/INTERRUPT_VECTOR/NMB_VECTORS $devicefile | sed "s,\r,,g")
+VECTOR_SIZE=$(( $(xml sel -T -t -v /AVRPART/INTERRUPT_VECTOR/VECTOR2/PROGRAM_ADDRESS $devicefile | sed "s,\\$,0x,g" | sed "s,\r,,g") * 2 ))
+echo "/* Interrupt vectors */" >> $headerfile
+echo "/* Vector 0 is the reset vector */" >> $headerfile
+VECTORS=$(xml sel -T -t -m "/AVRPART/INTERRUPT_VECTOR/*[PROGRAM_ADDRESS]" -s "A:T:-" "PROGRAM_ADDRESS" -v "concat(name(),' ')" $devicefile)
+for i in $VECTORS ; do
+    if test "$i" != "VECTOR1" ; then
+        VECTOR_SOURCE=$(xml sel -T -t -m "/AVRPART/INTERRUPT_VECTOR/$i" -v "SOURCE" $devicefile | \
+            sed "s,Reserved.*,Reserved,g" | \
+            sed "s/,//g" | \
+            sed "s, ,_,g")
+        if test "$VECTOR_SOURCE" != "Reserved" ; then
+            VECTOR_NUM=$(( $(echo $i | sed "s,VECTOR,,g") - 1))
+            VECTOR_DESC=$(xml sel -T -t -m "/AVRPART/INTERRUPT_VECTOR/$i" -v "DEFINITION" $devicefile)
+            echo "#define ${VECTOR_SOURCE}_vect_num  ${VECTOR_NUM}" >> $headerfile
+            echo "#define ${VECTOR_SOURCE}_vect      _VECTOR(${VECTOR_NUM})  /* ${VECTOR_DESC} */" >> $headerfile
+        fi
+    fi
+done
+echo "" >> $headerfile
+echo "#define _VECTOR_SIZE ${VECTOR_SIZE} /* Size of individual vector. */" >> $headerfile
+echo "#define _VECTORS_SIZE (${NMB_VECTORS} * _VECTOR_SIZE)" >> $headerfile
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+# Constants
+#-------------
+echo "/* Constants */" >> $headerfile
+
+# SPM_PAGESIZE
+SPM_PAGESIZE=$(( $(xml sel -T -t -v "/AVRPART/MEMORY/BOOT_CONFIG/PAGESIZE" $devicefile) * 2))
+echo "#define SPM_PAGESIZE (${SPM_PAGESIZE})" >> $headerfile
+
+# RAMSTART
+RAMSTART=$(xml sel -T -t -v "/AVRPART/MEMORY/INT_SRAM/START_ADDR" $devicefile | sed "s,\\$,0x,g") 
+echo "#define RAMSTART     (${RAMSTART})" >> $headerfile
+
+# RAMSIZE
+RAMSIZE=$(xml sel -T -t -v "/AVRPART/MEMORY/INT_SRAM/SIZE" $devicefile)
+echo "#define RAMSIZE      (${RAMSIZE})" >> $headerfile
+
+# RAMEND
+echo "#define RAMEND       (RAMSTART + RAMSIZE - 1)" >> $headerfile
+
+# XRAMSTART
+XRAMSTART=$(xml sel -T -t -v "/AVRPART/MEMORY/EXT_SRAM/START_ADDR" $devicefile | sed "s,\\$,0x,g")
+echo "#define XRAMSTART    (${XRAMSTART})" >> $headerfile
+
+# XRAMSIZE
+XRAMSIZE=$(xml sel -T -t -v "/AVRPART/MEMORY/EXT_SRAM/SIZE" $devicefile)
+echo "#define XRAMSIZE     (${XRAMSIZE})" >> $headerfile
+
+# XRAMEND
+if test $XRAMSIZE -gt 0 ; then
+    echo "#define XRAMEND      (XRAMSIZE - 1)" >> $headerfile
+else
+    echo "#define XRAMEND      (RAMEND)" >> $headerfile
+fi
+
+# E2END
+EEPROM_SIZE=$(( $(xml sel -T -t -v "/AVRPART/MEMORY/EEPROM" $devicefile) ))
+if test $EEPROM_SIZE -gt 0 ; then
+    EEPROM_LAST=$(( $EEPROM_SIZE - 1 ))
+else
+    EEPROM_LAST=0
+fi
+E2END=$(printf "0x%X" $EEPROM_LAST)
+echo "#define E2END        (${E2END})" >> $headerfile
+
+# E2PAGESIZE
+E2PAGESIZE=$(xml sel -T -t -v "/AVRPART/PROGRAMMING/EepromPageSize" $devicefile)
+echo "#define E2PAGESIZE   (${E2PAGESIZE})" >> $headerfile
+
+# FLASHEND
+FLASHEND=$(printf "0x%X" $(( $(xml sel -T -t -v "/AVRPART/MEMORY/PROG_FLASH" $devicefile) - 1)) )
+echo "#define FLASHEND     (${FLASHEND})" >> $headerfile
+
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+# Fuse information
+#---------------------
+xml sel -T -t -o "/* Fuses */" -n $devicefile >> $headerfile
+
+# Certain XML files have "templates", others do not. Use V1 information.
+NUM_FUSE_BYTES=$(xml sel -T -t -m /AVRPART/FUSE -v "count(LOW) + count(HIGH) + count(EXTENDED)" $devicefile)
+echo "#define FUSE_MEMORY_SIZE ${NUM_FUSE_BYTES}" >> $headerfile
+echo "" >> $headerfile
+
+if test $NUM_FUSE_BYTES -eq 1 ; then
+    # Single Fuse Byte
+    xml sel -t -e AVRPART -m /AVRPART/FUSE/LOW -c . $devicefile | \
+        xml pyx | \
+        sed "s,(FUSE,(FUSE\nAbitnum ,g" | \
+        sed "s,)FUSE.*,)FUSE,g" | \
+        sed "s,-\\$,-,g" | \
+        xml depyx | \
+        xml sel -T \
+        -t -i "count(/AVRPART/LOW)" -o "/* Fuse Byte */" -n \
+        -t -m "/AVRPART/LOW/FUSE[@bitnum]" -s "A:T:-" "@bitnum" -v "concat('#define FUSE_',NAME,'  (unsigned char)~_BV(',@bitnum,')  /* ',TEXT,' */')" -n \
+        -t -i "count(/AVRPART/LOW)" -o "#define FUSE_DEFAULT ("  \
+           -m "/AVRPART/LOW/FUSE" -i "DEFAULT=0" -v "concat('FUSE_',NAME,' &amp; ')" \
+        -t -i "count(/AVRPART/LOW)" -o ")" -n -n | \
+        sed "s, \& ),)," | \
+        sed "s,DEFAULT (),DEFAULT (0xFF)," >> $headerfile
+else
+    # Low Fuse Byte
+    xml sel -t -e AVRPART -m /AVRPART/FUSE/LOW -c . $devicefile | \
+        xml pyx | \
+        sed "s,(FUSE,(FUSE\nAbitnum ,g" | \
+        sed "s,)FUSE.*,)FUSE,g" | \
+        sed "s,-\\$,-,g" | \
+        xml depyx | \
+        xml sel -T \
+        -t -i "count(/AVRPART/LOW)" -o "/* Low Fuse Byte */" -n \
+        -t -m "/AVRPART/LOW/FUSE[@bitnum]" -s "A:T:-" "@bitnum" -v "concat('#define FUSE_',NAME,'  (unsigned char)~_BV(',@bitnum,')  /* ',TEXT,' */')" -n \
+        -t -i "count(/AVRPART/LOW)" -o "#define LFUSE_DEFAULT ("  \
+           -m "/AVRPART/LOW/FUSE" -i "DEFAULT=0" -v "concat('FUSE_',NAME,' &amp; ')" \
+        -t -i "count(/AVRPART/LOW)" -o ")" -n -n | \
+        sed "s, \& ),)," | \
+        sed "s,DEFAULT (),DEFAULT (0xFF)," >> $headerfile
+        
+    # High Fuse Byte    
+    xml sel -t -e AVRPART -m /AVRPART/FUSE/HIGH -c . $devicefile | \
+        xml pyx | \
+        sed "s,(FUSE,(FUSE\nAbitnum ,g" | \
+        sed "s,)FUSE.*,)FUSE,g" | \
+        sed "s,-\\$,-,g" | \
+        xml depyx | \
+        xml sel -T \
+        -t -i "count(/AVRPART/HIGH)" -o "/* High Fuse Byte */" -n \
+        -t -m "/AVRPART/HIGH/FUSE[@bitnum]" -s "A:T:-" "@bitnum" -v "concat('#define FUSE_',NAME,'  (unsigned char)~_BV(',@bitnum,')  /* ',TEXT,' */')" -n \
+        -t -i "count(/AVRPART/HIGH)" -o "#define HFUSE_DEFAULT (" \
+           -m "/AVRPART/HIGH/FUSE" -i "DEFAULT=0" -v "concat('FUSE_',NAME,' &amp; ')" \
+        -t -i "count(/AVRPART/HIGH)" -o ")" -n -n | \
+        sed "s, \& ),)," | \
+        sed "s,DEFAULT (),DEFAULT (0xFF)," >> $headerfile
+
+    # Extended Fuse Byte
+    xml sel -t -e AVRPART -m /AVRPART/FUSE/EXTENDED -c . $devicefile | \
+        xml pyx | \
+        sed "s,(FUSE,(FUSE\nAbitnum ,g" | \
+        sed "s,)FUSE.*,)FUSE,g" | \
+        sed "s,-\\$,-,g" | \
+        xml depyx | \
+        xml sel -T \
+        -t -i "count(/AVRPART/EXTENDED)" -o "/* Extended Fuse Byte */" -n \
+        -t -m "/AVRPART/EXTENDED/FUSE[@bitnum]" -s "A:T:-" "@bitnum" -v "concat('#define FUSE_',NAME,'  (unsigned char)~_BV(',@bitnum,')  /* ',TEXT,' */')" -n \
+        -t -i "count(/AVRPART/EXTENDED)" -o "#define EFUSE_DEFAULT (" \
+           -m "/AVRPART/EXTENDED/FUSE" -i "DEFAULT=0" -v "concat('FUSE_',NAME,' &amp; ')" \
+        -t -i "count(/AVRPART/EXTENDED)" -o ")" -n -n | \
+        sed "s, \& ),)," | \
+        sed "s,DEFAULT (),DEFAULT (0xFF)," >> $headerfile
+fi
+echo "" >> $headerfile
+
+
+
+# Lockbit information
+#-----------------------
+xml sel -T -t -o "/* Lock Bits */" -n $devicefile >> $headerfile
+
+# Normal V2 information location.
+xml sel -T -t -i "count(/AVRPART/V2/templates/module[@class='LOCKBIT']/registers/reg/bitfield[@name='LB'])" -o "#define __LOCK_BITS_EXIST" -n \
+        -i "count(/AVRPART/V2/templates/module[@class='LOCKBIT']/registers/reg/bitfield[@name='BLB0'])" -o "#define __BOOT_LOCK_BITS_0_EXIST" -n \
+        -i "count(/AVRPART/V2/templates/module[@class='LOCKBIT']/registers/reg/bitfield[@name='BLB1'])" -o "#define __BOOT_LOCK_BITS_1_EXIST" -n $devicefile >> $headerfile
+
+# Certain XML files have "templates", others do not. Use alternate XPath.
+xml sel -T -t -i "count(/AVRPART/LOCKBIT/V2/module[@class='LOCKBIT']/registers/reg/bitfield[@name='LB'])" -o "#define __LOCK_BITS_EXIST" -n \
+        -i "count(/AVRPART/LOCKBIT/V2/module[@class='LOCKBIT']/registers/reg/bitfield[@name='BLB0'])" -o "#define __BOOT_LOCK_BITS_0_EXIST" -n \
+        -i "count(/AVRPART/LOCKBIT/V2/module[@class='LOCKBIT']/registers/reg/bitfield[@name='BLB1'])" -o "#define __BOOT_LOCK_BITS_1_EXIST" -n $devicefile >> $headerfile
+
+xml sel -T -t -n -n $devicefile >> $headerfile
+
+
+
+# Signature information
+#--------------------------
+SIGNATURE_0=$(xml sel -T -t -m "/AVRPART/ADMIN/SIGNATURE" -v "ADDR000" $devicefile | sed "s,\\$,0x,g")
+SIGNATURE_1=$(xml sel -T -t -m "/AVRPART/ADMIN/SIGNATURE" -v "ADDR001" $devicefile | sed "s,\\$,0x,g")
+SIGNATURE_2=$(xml sel -T -t -m "/AVRPART/ADMIN/SIGNATURE" -v "ADDR002" $devicefile | sed "s,\\$,0x,g")
+echo "/* Signature */" >> $headerfile
+echo "#define SIGNATURE_0 ${SIGNATURE_0}" >> $headerfile
+echo "#define SIGNATURE_1 ${SIGNATURE_1}" >> $headerfile
+echo "#define SIGNATURE_2 ${SIGNATURE_2}" >> $headerfile
+echo "" >> $headerfile
+echo "" >> $headerfile
+
+
+
+# Device Pin information
+#---------------------------
+# Only available in AVR Studio 4 XML V1 information. V2 does not have this data.
+echo "/* Device Pin Definitions */" >> $headerfile
+# Get all package types.
+PACKAGE_TYPES=$(xml sel -T -t -v '/AVRPART/PACKAGE/PACKAGES' $devicefile | cut -d '[' -f 2 | cut -d ']' -f 1 | cut -d ':' -f 1- --output-delimiter=' ')
+# Determine which package has the most number of pins.
+PACKAGE_MAX=0
+PACKAGE_SELECTED=
+for i in $PACKAGE_TYPES ; do
+    PACKAGE_SIZE=$(xml sel -T -t -v /AVRPART/PACKAGE/${i}/NMB_PIN $devicefile | sed "s,\r,,g")
+    if test $PACKAGE_SIZE -gt $PACKAGE_MAX ; then
+        PACKAGE_MAX=$PACKAGE_SIZE
+        PACKAGE_SELECTED=$i
+    fi
+done
+# Check to make sure that package information is included in the XML file.
+if test -n $PACKAGE_SELECTED ; then
+    # Get list of pins from selected package, and check each pin.
+    PINS=$(xml sel -T -t -m /AVRPART/PACKAGE/$PACKAGE_SELECTED/* -v "name()" -o ' ' $devicefile | sed "s,\r,,g" | sed "s,NMB_PIN,,g")
+    for i in $PINS ; do
+        TARGET=
+        MAP_LIST=
+        
+        # The XML files are inconsistent in their format. Try several options.
+        
+        # Check for NAME tag.
+        NAME=$(xml sel -T -t -m /AVRPART/PACKAGE/$PACKAGE_SELECTED/${i}/NAME -v . -o ' ' $devicefile | sed "s,\r,,g")
+        if test $NAME ; then
+            # Get list of mappings. Inside brackets, colon delimited. The first one in the list is the target information.
+            TARGET=$(echo $NAME | cut -d '[' -f 2 | cut -d ']' -f 1 | cut -d ':' -f 1 --output-delimiter=' ')
+            MAP_LIST=$(echo $NAME | cut -d '[' -f 2 | cut -d ']' -f 1 | cut -d ':' -f 2- --output-delimiter=' ')
+        else
+            # Check for PIN_NAME and ALT_NAME tags.
+            PIN_NAME=$(xml sel -T -t -m /AVRPART/PACKAGE/$PACKAGE_SELECTED/${i}/PIN_NAME -v . -o ' ' $devicefile | sed "s,\r,,g")
+            ALT_NAME=$(xml sel -T -t -m /AVRPART/PACKAGE/$PACKAGE_SELECTED/${i}/ALT_NAME -v . -o ' ' $devicefile | sed "s,\r,,g")
+
+            if test -n "$PIN_NAME" -a -n "$ALT_NAME"  ; then
+                # Determine which field has the target and which has the mappings.
+                TARGET=$ALT_NAME
+                MAP_LIST=$(echo $PIN_NAME | sed "s,^[*]$,&,")
+                if test -z $MAP_LIST ; then
+                    MAP_LIST=$ALT_NAME
+                    TARGET=$PIN_NAME
+                fi
+                
+                # Get list of mappings. Inside brackets, colon delimited.
+                MAP_LIST=$(echo $MAP_LIST | cut -d '[' -f 2 | cut -d ']' -f 1 | cut -d ':' -f 1- --output-delimiter=' ')
+                
+                # Make sure target isn't just a blank character.
+                TARGET=$(echo $TARGET | sed "s, ,,g")
+            fi
+        fi
+        
+        if test -n "$TARGET" -a -n "$MAP_LIST" ; then
+            # Make transformations on map list.
+            #     Remove active low character signified by single quote
+            #     Replace '+' with "_P"
+            #     Replace '-' with "_N"
+            MAP_LIST=$(echo $MAP_LIST | sed "s,',,g" | sed "s,+,_P,g" | sed "s,-,_N,g")
+
+            #     Remove these pin mappings because they cannot be manipulated by software.
+            for j in TOSC1 TOSC2 PDI PDO TCK TMS TDO TDI AVCC AREF AGND HWB RESET XTAL1 XTAL2 VCC GND NC; do
+                MAP_LIST=$(echo $MAP_LIST | sed "s,${j},,g")
+            done
+
+            TARGET_LETTER=$(echo $TARGET | sed "s,^P,,g" | sed "s,[0-9]$,,g")
+            TARGET_NUMBER=$(echo $TARGET | sed "s,^P[A-Z],,g")
+
+            # Add definitions to map alternate pin names to register definitions.
+            for j in $MAP_LIST ; do
+                echo "#define ${j}_DDR   DDR${TARGET_LETTER}" >> $headerfile
+                echo "#define ${j}_PORT  PORT${TARGET_LETTER}" >> $headerfile
+                echo "#define ${j}_PIN   PIN${TARGET_LETTER}" >> $headerfile
+                echo "#define ${j}_BIT   ${TARGET_NUMBER}" >> $headerfile
+                echo "" >> $headerfile
+            done
+        fi
+    done
+fi
+
+
+# End of XMEGA/Classic
+fi
+
+
+# Ending idempotent guard.
+#--------------------------
+echo "#endif /* _AVR_${DEVICE}_H_ */" >> $headerfile
+echo "" >> $headerfile
+
+# Convert to Unix line endings.
+#-------------------------------
+sed -i "s,\r\n,\n,g" $headerfile
+
+
+# Set permissions on the file
+#------------------------------
+chmod 644 $headerfile
+
+
+# I/O Header File and XML Device File Verification
+#--------------------------------------------------
+LOGFILE=$headerfile.log
+# Turn off printing of commands for the verification.
+set +ex
+
+if test -e $LOGFILE ; then
+    rm -f $LOGFILE
+fi
+
+echo Checking for package information in XML file... | tee -a $LOGFILE
+PACKAGE_TYPES=$(xml sel -t -v '/AVRPART/PACKAGE/PACKAGES' $devicefile | cut -d ']' -f 1 | cut -d ':' -f 1- --output-delimiter=' ')
+if test -z "$PACKAGE_TYPES" ; then
+    echo "Package types missing from XML file." | tee -a $LOGFILE
+fi
+echo | tee -a $LOGFILE
+
+echo Checking for misspelled preprocessor directives in header file... | tee -a $LOGFILE
+grep "#" $headerfile | cut -d '#' -f 2 | cut -d ' ' -f 1 | sort | uniq | tee -a $LOGFILE
+echo | tee -a $LOGFILE
+
+echo Checking for duplicate definitions in header file... | tee -a $LOGFILE
+grep "#define" $headerfile | cut -d '#' -f 2 | cut -d ' ' -f 2 | sort | uniq -d | uniq | tee -a $LOGFILE
+echo | tee -a $LOGFILE
+
+echo Checking for hyphens in defined names in header file... | tee -a $LOGFILE
+grep "#define" $headerfile | cut -d '#' -f 2 | cut -d ' ' -f 2 | grep '-' | tee -a $LOGFILE
+echo | tee -a $LOGFILE
+
+echo Checking for hyphens in register and bit names in XML device file... | tee -a $LOGFILE
+echo "$REGS_WITH_HYPHENS" | tee -a $LOGFILE
+echo | tee -a $LOGFILE
+
+echo Checking for invalid signature... | tee -a $LOGFILE
+if test "$SIGNATURE_0" = "0x0" -a "$SIGNATURE_1" = "0x0" -a "$SIGNATURE_2" = "0x0" ; then
+    echo "  Invalid signature: ${SIGNATURE_0} ${SIGNATURE_1} ${SIGNATURE_2}" | tee -a $LOGFILE
+fi
+echo | tee -a $LOGFILE
+
+echo Checking for registers that have no associated bit names... | tee -a $LOGFILE
+echo "$REGS_NO_BITNAMES" | tee -a $LOGFILE
+echo | tee -a $LOGFILE
+
+# todo:
+# Properly get all preprocessor directives
+# Check directives against a known dictionary.
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/xml/Descparser.py avr-libc-r2546/xml/Descparser.py
--- avr-libc-2.0.0-orig/xml/Descparser.py	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/xml/Descparser.py	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,255 @@
+#! /usr/bin/env python
+#
+# Copyright (c) 2004  Theodore A. Roth
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+# * Redistributions of source code must retain the above copyright
+#   notice, this list of conditions and the following disclaimer.
+#
+# * Redistributions in binary form must reproduce the above copyright
+#   notice, this list of conditions and the following disclaimer in
+#   the documentation and/or other materials provided with the
+#   distribution.
+#
+# * Neither the name of the copyright holders nor the names of
+#   contributors may be used to endorse or promote products derived
+#   from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+# POSSIBILITY OF SUCH DAMAGE.
+#
+# $Id: Descparser.py 910 2005-10-21 21:00:01Z joerg_wunsch $
+#
+
+import os, sys, types
+
+from xml.sax import make_parser
+from xml.sax.handler import ContentHandler
+
+class XML_Mixin:
+    children = {}
+    def __init__ (self, attrs):
+        self.xml_members = []
+        for name in attrs.getNames ():
+            if attrs.getType (name) == 'CDATA':
+                self.xml_members.append (name)
+                setattr (self, name, attrs.getValue (name))
+        self.data = ''
+
+    def create_child (self, name, attrs):
+        return self.children[name] (attrs)
+
+    def add_child (self, name, obj):
+        self.xml_members.append (name)
+        setattr (self, name, obj)
+
+    def characters (self, ch):
+        self.data += ch
+
+    def __str__ (self):
+        s = '[ data = "%s"; ' % (self.data)
+        for member in self.xml_members:
+            s += '%s = %s; ' % (member, str (getattr (self, member)))
+        s += ']\n'
+        return s
+
+class PCData (XML_Mixin):
+    def __repr__ (self):
+        return '"%s"' % (self.data)
+
+class MemorySizes (XML_Mixin):
+    children = {
+        'flash_size': PCData,
+        'eeprom_size': PCData,
+        'int_sram_size': PCData,
+        'ext_sram_size': PCData
+        }
+
+class Vector (XML_Mixin):
+    children = {
+        'description': PCData,
+        'sig_name': PCData,
+        'alt_name': PCData
+        }
+    def add_child (self, name, obj):
+        if name == "alt_name":
+            try:
+                x = getattr (self, name)
+                x.data.append(obj.data)
+                setattr (self, name, x)
+            except AttributeError:
+                x = obj.data
+                obj.data = [x]
+                self.xml_members.append (name)
+                setattr (self, name, obj)
+        else:
+            self.xml_members.append (name)
+            setattr (self, name, obj)
+
+
+class Interrupts (dict, XML_Mixin):
+    children = {
+        'vector': Vector
+        }
+
+    def __init__ (self, attrs):
+        dict.__init__ (self)
+        XML_Mixin.__init__ (self, attrs)
+
+    def add_child (self, name, obj):
+        # Use the Vector 'num' attr as the key for the child object.
+        if self.has_key (obj.num):
+            raise 'Duplicate vector entry', obj
+        self[obj.num] = obj
+
+class BitField (XML_Mixin):
+    children = {
+        'description': PCData,
+        'alt_name': PCData
+        }
+
+class IORegister (XML_Mixin):
+    children = {
+        'description': PCData,
+        'alt_name': PCData,
+        'bit_field': BitField,
+        }
+
+    def add_child (self, name, obj):
+        if name == 'bit_field':
+            if not hasattr (self, name):
+                setattr (self, name, {})
+            # Use the BitField 'bit' attr as the key for the child object.
+            self.bit_field[obj.bit] = obj
+        else:
+            XML_Mixin.add_child (self, name, obj)
+
+class IORegisterDict (dict, XML_Mixin):
+    children = {
+        'ioreg': IORegister
+        }
+
+    def __init__ (self, attrs):
+        dict.__init__ (self)
+        XML_Mixin.__init__ (self, attrs)
+
+    def add_child (self, name, obj):
+        # Use the IORegister 'name' attr as the key for the child object.
+        if self.has_key (obj.name):
+            raise 'Duplicate io register entry', obj
+        self[obj.name] = obj
+
+class BootMode (XML_Mixin):
+    pass
+
+class BootLoader (dict, XML_Mixin):
+    children = {
+        'mode': BootMode
+        }
+
+    def __init__ (self, attrs):
+        dict.__init__ (self)
+        XML_Mixin.__init__ (self, attrs)
+
+    def add_child (self, name, obj):
+        # Use the BootMode 'num' attr as the key for the child object.
+        if self.has_key (obj.num):
+            raise 'Duplicate boot mode entry', obj
+
+        self[obj.num] = obj
+
+class Device (XML_Mixin):
+    children = {
+        'version': PCData,
+        'description': PCData,
+        'memory_sizes': MemorySizes,
+        'interrupts': Interrupts,
+        'ioregisters': IORegisterDict,
+        'bootloader': BootLoader
+        }
+
+class DescHandler (ContentHandler):
+    """Content Handler for the device description xml files.
+    """
+
+    def __init__ (self):
+        self.depth = 0
+        self.stack = []
+
+    def push (self, name, obj):
+        self.stack.append ([name, obj])
+
+    def pop (self):
+        return self.stack.pop ()
+
+    def get_curr_obj (self):
+        return self.stack[-1][1]
+
+    def startElement (self, name, attrs):
+        if self.depth == 0:
+            obj = Device (attrs)
+            self.dev = obj
+        else:
+            # Look up the elements class in the parent's children dict.
+            parent = self.get_curr_obj ()
+            obj = parent.create_child (name, attrs)
+
+        self.push (name, obj)
+        self.depth += 1
+
+    def endElement (self, name):
+        self.depth -= 1
+
+        # Pull the current element off the stack and add it to the parent.
+        (cname, cobj) = self.pop ()
+
+        cobj.data = ' '.join (cobj.data.split ())
+
+        try:
+            parent = self.get_curr_obj ()
+            parent.add_child (cname, cobj)
+        except IndexError:
+            # We're back at the root element, so we're done.
+            pass
+
+        #print '%s%s %s' % ('  '*self.depth, cname, cobj)
+
+    def characters (self, ch):
+        self.get_curr_obj().characters (ch)
+
+    def endDocument (self):
+        #print self.dev
+        pass
+
+if __name__ == '__main__':
+    parser = make_parser ()
+
+    handler = DescHandler ()
+    parser.setContentHandler (handler)
+
+    if len(sys.argv) > 1:
+        parser.parse (open (sys.argv[1]))
+    else:
+        parser.parse (open ('desc-90s1200.xml'))
+
+    l = parser.getContentHandler().dev.interrupts.keys()
+    l.sort(lambda x, y: cmp(int(x), int(y)))
+    for key in l:
+        ele = parser.getContentHandler().dev.interrupts[key]
+        print "/* " + ele.description.data + " */"
+        print "#define " + ele.sig_name.data + "\t_VECTOR(" + key + ")"
+        for x in ele.alt_name.data:
+            print "#define " + x + "\t_VECTOR(" + key + ")"
+        print ""
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/xml/Device.dtd avr-libc-r2546/xml/Device.dtd
--- avr-libc-2.0.0-orig/xml/Device.dtd	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/xml/Device.dtd	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,148 @@
+<!--
+Copyright (c) 2004, Theodore A. Roth
+All rights reserved.
+
+Redistribution and use in source and binary forms, with or without
+modification, are permitted provided that the following conditions are met:
+
+* Redistributions of source code must retain the above copyright
+  notice, this list of conditions and the following disclaimer.
+
+* Redistributions in binary form must reproduce the above copyright
+  notice, this list of conditions and the following disclaimer in
+  the documentation and/or other materials provided with the
+  distribution.
+
+* Neither the name of the copyright holders nor the names of
+  contributors may be used to endorse or promote products derived
+  from this software without specific prior written permission.
+
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+POSSIBILITY OF SUCH DAMAGE.
+-->
+
+<!-- $Id: Device.dtd 909 2005-10-21 20:55:19Z joerg_wunsch $ -->
+
+<!--
+
+This file provides a Document Type Definition (DTD) for XML data files which
+describe everything thing we need to generate the <avr/io*.h> header files.
+
+Although ATMEL supplies XML device files already with AvrStudio >= 4.x, they
+contain far more data than we need. In addition, there is information that we
+need which they do not provide. Also, it may not be legal for us to include
+those files with avr-libc.
+
+I have written a python program (Atmel2libc.py) which will read ATMEL's XML
+files and spit out a file which will validate against this DTD so that we can
+leverage the data in those files. We will still have to manually add some data
+to our generated xml files before we can use them to generate our headers.
+
+-->
+
+<!ELEMENT device (
+    version,
+    description?,
+    memory_sizes,
+    interrupts,
+    ioregisters,
+    bootloader?
+)>
+    <!ATTLIST device
+        name CDATA #REQUIRED
+    >
+
+    <!ELEMENT version (#PCDATA)>
+    <!ELEMENT description (#PCDATA)>
+
+    <!ELEMENT memory_sizes (
+        flash_size,
+        eeprom_size,
+        int_sram_size,
+        ext_sram_size
+    )>
+        <!ELEMENT flash_size (#PCDATA)>
+        <!ELEMENT eeprom_size (#PCDATA)>
+        <!ELEMENT int_sram_size (#PCDATA)>
+            <!ATTLIST int_sram_size start_addr CDATA #REQUIRED>
+        <!ELEMENT ext_sram_size (#PCDATA)>
+            <!ATTLIST ext_sram_size start_addr CDATA #REQUIRED>
+
+    <!ELEMENT interrupts (vector+)>
+        <!-- insn_size in bytes -->
+        <!ATTLIST interrupts
+            insn_size (2 | 4) #REQUIRED
+            num_vects CDATA #REQUIRED
+        >
+        <!ELEMENT vector (
+            description?,
+            sig_name,
+	    alt_name*
+        )>
+            <!ATTLIST vector
+                addr CDATA #REQUIRED
+                num CDATA #REQUIRED
+                name CDATA #REQUIRED
+            >
+            <!ELEMENT sig_name (#PCDATA)>
+
+    <!ELEMENT ioregisters (ioreg+)>
+    <!ELEMENT ioreg (
+        description?,
+        alt_name*,
+        bit_field*
+    )>
+        <!ATTLIST ioreg
+            name CDATA #REQUIRED
+            addr CDATA #REQUIRED
+        >
+
+        <!ELEMENT alt_name (#PCDATA)>
+
+        <!ELEMENT bit_field (
+            description?,
+            alt_name*
+        )>
+            <!ATTLIST bit_field
+                name CDATA #REQUIRED
+                bit CDATA #REQUIRED
+                access CDATA #REQUIRED
+                init CDATA #REQUIRED
+            >
+
+    <!-- If the is no bootloader element in the XML file, the device does not
+         have bootloader support. -->
+
+    <!-- The pagesize value is in bytes. Atmel's datasheets give it in
+         words. -->
+
+    <!-- Some recent ATtiny devices have boot loader support, but only
+         have non-read while write (NRWW) behaviour throughout the
+         entire flash, and no separate bootloader area.  So do not
+         insist on getting mode elements. -->
+    <!ELEMENT bootloader (mode*)>
+        <!ATTLIST bootloader
+            pagesize CDATA #REQUIRED
+            rww_start CDATA #IMPLIED
+            rww_end CDATA #IMPLIED
+            nrww_start CDATA #IMPLIED
+            nrww_end CDATA #IMPLIED
+        >
+
+        <!-- The boot mode size is (pagesize * pages). -->
+
+        <!ELEMENT mode EMPTY>
+            <!ATTLIST mode
+                num CDATA #REQUIRED
+                pages CDATA #REQUIRED
+                start CDATA #REQUIRED
+            >
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/xml/patch-headers.py avr-libc-r2546/xml/patch-headers.py
--- avr-libc-2.0.0-orig/xml/patch-headers.py	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/xml/patch-headers.py	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,437 @@
+#! /usr/bin/env python
+#
+# Copyright (c) 2005,2006,2007  Joerg Wunsch
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+# * Redistributions of source code must retain the above copyright
+#   notice, this list of conditions and the following disclaimer.
+#
+# * Redistributions in binary form must reproduce the above copyright
+#   notice, this list of conditions and the following disclaimer in
+#   the documentation and/or other materials provided with the
+#   distribution.
+#
+# * Neither the name of the copyright holders nor the names of
+#   contributors may be used to endorse or promote products derived
+#   from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+# POSSIBILITY OF SUCH DAMAGE.
+#
+# $Id: patch-headers.py 1530 2007-12-20 20:43:54Z joerg_wunsch $
+#
+
+import os, sys, time, types, re
+
+from types import *
+
+from xml.sax import make_parser
+from xml.sax.handler import ContentHandler
+
+from Descparser import *
+from Atmel2libc import *
+
+home = os.environ['HOME']
+
+xmls = home + "/src/jtagII/xml/Partdescriptionfiles"
+headers = home + "/src/avr-libc/include/avr"
+
+docfilename = "vectortable.dox"
+
+# Mapping between header name and device name.  In case of a header
+# name that covers more than one device, the device names form a tuple
+# where the device with the largest feature set is listed as the first
+# one.
+table = {
+    "io1200.h": "AT90S1200",
+    "io2313.h": "AT90S2313",
+    "io2323.h": "AT90S2323",
+    "io2333.h": "AT90S2333",
+    "io2343.h": "AT90S2343",
+    # no XML files
+    #"io43u32x.h": "AT43USB320",
+    #"io43u35x.h": "AT43USB355",
+    "io4414.h": "AT90S4414",
+    "io4433.h": "AT90S4433",
+    "io4434.h": "AT90S4434",
+    # no XML file
+    #"io76c711.h": "AT76C711",
+    "io8515.h": "AT90S8515",
+    # no XML file
+    #"io8534.h": "AT90C8534",
+    "io8535.h": "AT90S8535",
+    "io86r401.h": "AT86RF401",
+    # still no XML file
+    #"io90pwm1.h": "AT90PWM1",
+    "io90pwm216.h": "AT90PWM216",
+    "io90pwm2b.h": "AT90PWM2B",
+    "io90pwm316.h": "AT90PWM316",
+    "io90pwm3b.h": "AT90PWM3B",
+    "io90pwmx.h": ("AT90PWM3", "AT90PWM2", "AT90PWM1"),
+    # no XML file
+    #"ioat94k.h": "AT94k",
+    "iocanxx.h": ("AT90CAN128", "AT90CAN32", "AT90CAN64"),
+    "iom103.h": "ATmega103",
+    "iom128.h": "ATmega128",
+    #"iom1280.h" => "iomxx0_1.h"
+    #"iom1281.h" => "iomxx0_1.h"
+    "iom1284p.h": "ATmega1284P",
+    "iom16.h": "ATmega16",
+    "iom161.h": "ATmega161",
+    "iom162.h": "ATmega162",
+    "iom163.h": "ATmega163",
+    #"iom164.h" => "iomxx4.h"
+    "iom165.h": "ATmega165",
+    "iom165p.h": "ATmega165P",
+    #"iom168.h" => "iomx8.h"
+    "iom168p.h": "ATmega168P",
+    "iom169.h": "ATmega169",
+    "iom169p.h": "ATmega169P",
+    #"iom16hva.h" => "iomxxhva.h"
+    #"iom2560.h" => "iomxx0_1.h"
+    #"iom2561.h" => "iomxx0_1.h"
+    "iom32.h": "ATmega32",
+    "iom323.h": "ATmega323",
+    "iom325.h": "ATmega325",
+    "iom3250.h": ("ATmega3250", "ATmega3250P"),
+    "iom328p.h": "ATmega328P",
+    "iom329.h": "ATmega329",
+    "iom3290.h": ("ATmega3290", "ATmega3290P"),
+    "iom32hvb.h": "ATmega32HVB",
+    "iom406.h": "ATmega406",
+    #"iom48.h" => "iomx8.h"
+    "iom48p.h": "ATmega48P",
+    "iom64.h": "ATmega64",
+    #"iom640.h" => "iomxx0_1.h"
+    #"iom644.h" => "iomxx4.h"
+    "iom645.h": "ATmega645",
+    "iom6450.h": "ATmega6450",
+    "iom649.h": "ATmega649",
+    "iom6490.h": "ATmega6490",
+    "iom8.h": "ATmega8",
+    "iom8515.h": "ATmega8515",
+    "iom8535.h": "ATmega8535",
+    #"iom88.h" => "iomx8.h"
+    "iom88p.h": "ATmega88P",
+    #"iom8hva.h" => "iomxxhva.h"
+    "iomx8.h": ("ATmega168", "ATmega48", "ATmega88"),
+    "iomxx0_1.h": ("ATmega640", "ATmega1280", "ATmega1281", "ATmega2560", "ATmega2561"),
+    "iomxx4.h": ("ATmega324P", "ATmega164P", "ATmega644P", "ATmega644"),
+    # ATmega8HVA XML still missing
+    #"iomxxhva.h": ("ATmega8HVA", "ATmega16HVA"),
+    "iomxxhva.h": ("ATmega16HVA"),
+    "iotn11.h": "ATtiny11",
+    "iotn12.h": "ATtiny12",
+    "iotn13.h": "ATtiny13",
+    "iotn15.h": "ATtiny15",
+    "iotn22.h": "ATtiny22",
+    "iotn2313.h": "ATtiny2313",
+    #"iotn24.h" => "iotnx4.h"
+    #"iotn25.h" => "iotnx5.h"
+    "iotn26.h": "ATtiny26",
+    #"iotn261.h" => "iotnx61.h"
+    "iotn28.h": "ATtiny28",
+    "iotn43u.h": "ATtiny43U",
+    #"iotn44.h" => "iotnx4.h"
+    #"iotn45.h" => "iotnx5.h"
+    #"iotn461.h" => "iotnx61.h"
+    "iotn48.h": "ATtiny48",
+    #"iotn84.h" => "iotnx4.h"
+    #"iotn85.h" => "iotnx5.h"
+    #"iotn861.h" => "iotnx61.h"
+    # No XML file (yet)
+    #"iotn88.h": "ATtiny88",
+    "iotnx4.h": ("ATtiny24", "ATtiny44", "ATtiny84"),
+    "iotnx5.h": ("ATtiny45", "ATtiny25", "ATtiny85"),
+    "iotnx61.h": ("ATtiny261", "ATtiny461", "ATtiny861"),
+    #"iousb1286.h" => "iousbxx6_7.h"
+    #"iousb1287.h" => "iousbxx6_7.h"
+    #"iousb162.h" => "iousbxx2.h"
+    #"iousb646.h" => "iousbxx6_7.h"
+    #"iousb647.h" => "iousbxx6_7.h"
+    #"iousb82.h" => "iousbxx2.h"
+    "iousbxx2.h": ("AT90USB162", "AT90USB82"),
+    "iousbxx6_7.h": ("AT90USB1287", "AT90USB1286", "AT90USB647", "AT90USB646"),
+}
+
+def create_tabs (string):
+    "Create a number of tabs according to the length of string"
+    x = ''
+    lim = (32 - len(string) + 7) / 8
+    if lim <= 0:
+        lim = 1
+    for i in range(0, lim):
+        x += "\t"
+    return x
+
+
+parser = make_parser ()
+
+handler = DescHandler ()
+parser.setContentHandler (handler)
+
+print "Converting XML files:"
+for header in table.keys():
+    try:
+        xmlfile = table[header] + ".xml"
+        basedev = table[header]
+    except TypeError:
+        # in case we've got a tuple of device names
+        xmlfile = table[header][0] + ".xml"
+        basedev = ", ".join(table[header])
+    inputxml = xmls + "/" + xmlfile
+    outputxml = xmlfile
+
+    if os.access(xmlfile, os.F_OK):
+        continue
+
+    sys.stdout.write(basedev + "... ")
+
+    parser1 = Xml2Obj()
+    root = parser1.Parse(inputxml)
+
+    tradheader = HeaderToVec()
+    tradheader.Read(headers + "/" + header)
+
+    savedstdout = sys.stdout
+    sys.stdout = open(outputxml, "w")
+    dump_header (root)
+    dump_memory_sizes (root)
+    dump_vectors (root, tradheader)
+    dump_ioregs (root)
+    dump_boot_info (root)
+    dump_footer (root)
+    sys.stdout.close()
+    sys.stdout = savedstdout
+
+    print "done."
+
+r = re.compile(r'#\s*define\s+((SIG_)?[A-Z0-9_]+(_vect)?)\s+_VECTOR[(](\d+)[)]')
+
+print "Patching headers:"
+docs = {}
+nlist = table.keys()
+nlist.sort()
+for header in nlist:
+    devname = table[header]
+    try:
+        xmlfile = devname + ".xml"
+        basedev = devname
+    except TypeError:
+        # in case we've got a tuple of device names
+        xmlfile = devname[0] + ".xml"
+        basedev = ", ".join(devname)
+    hfile = headers + "/" + header
+
+    sys.stdout.write(basedev + "... ")
+
+    #parser = Xml2Obj()
+    parser.parse (open (xmlfile))
+
+    h = open(hfile)
+    lines = h.readlines()
+    h.close()
+
+    parseddev = parser.getContentHandler().dev
+
+    # Find any interrupt vector definitions, and rewrite them.
+    endcount = len(lines)
+    idx = 0
+    while idx < endcount:
+        line = lines[idx]
+        try:
+            m = r.match(line)
+        except TypeError:
+            print line
+            exit(0)
+        if m != None:
+            firstidx = idx
+            key = m.group(4)            # this is the vector number
+            ele = parseddev.interrupts[key]
+
+            if lines[idx - 1].find(ele.description.data) >= 0:
+                # there is a /* description */ comment in the previous line,
+                # drop it
+                if idx - 1 < firstidx:
+                    firstidx = idx - 1
+
+            lastidx = idx + 1
+            while r.match(lines[lastidx]) and r.match(lines[lastidx]).group(4) == key:
+                # more vector definitions follow, skip them
+                lastidx += 1
+
+            while re.match('^$', lines[lastidx]):
+                # blank lines follow, skip them, too
+                lastidx += 1
+
+            # Now, lastidx points to the first line not belonging
+            # to our current vector definition.  lastidx - firtidx
+            # is the number of lines affected.
+
+            count = lastidx - firstidx
+            del lines[firstidx:lastidx]
+
+            # now, build a new vector entry
+            vecttext = []
+            newcount = 0
+            if len(ele.description.data) > 0:
+                vecttext.append("/* " + ele.description.data + " */\n")
+                newcount += 1
+            vecttext.append("#define " + ele.sig_name.data +
+                            create_tabs(ele.sig_name.data) +
+                            "_VECTOR(" + key + ")\n")
+            newcount += 1
+            try:
+                for x in ele.alt_name.data:
+                    vecttext.append("#define " + x +
+                                    create_tabs(x) + "_VECTOR(" + key + ")\n")
+                    newcount += 1
+            except AttributeError:
+                # no alt_name present
+                pass
+            vecttext.append('\n')
+            newcount += 1
+
+            # insert new vector entry
+            lines[firstidx:firstidx] = vecttext
+
+            endcount += newcount - count
+            # back off beyond what we've just been working on
+            idx = firstidx + newcount
+
+            # collect documentation for this vector
+            try:
+                if type(devname) is TupleType:
+                    for d in devname:
+                        docs[ele.sig_name.data][2].append(d)
+                else:
+                    docs[ele.sig_name.data][2].append(devname)
+            except KeyError:
+                try:
+                    if type(devname) is TupleType:
+                        docs[ele.sig_name.data] = (ele.alt_name.data,
+                                                   ele.description.data,
+                                                   [])
+                        for d in devname:
+                            docs[ele.sig_name.data][2].append(d)
+                    else:
+                        docs[ele.sig_name.data] = (ele.alt_name.data,
+                                                   ele.description.data,
+                                                   [devname])
+                except AttributeError:
+                    # no alt name
+                    pass
+        else:
+            # no match, increment index
+            idx += 1
+
+    newh = open(header, "w")
+    for line in lines:
+        newh.writelines(line)
+    newh.close()
+    print "done."
+
+# Try to find the name of the person running this script.
+user = 'The avr-libc developer group.'
+if os.name == 'posix':
+    import pwd
+    gecos=pwd.getpwnam(os.getlogin())[4]
+    x = gecos.split(',')[0]
+    if re.match('^[A-Z][a-z]* [A-Z][a-z]*', x):
+        # if at least two capitalized words are present, trust that
+        user = x
+
+sys.stdout.write("Writing documentation to " + docfilename + "... ")
+savedstdout = sys.stdout
+sys.stdout = open(docfilename, "w")
+
+print """/* Note: this file has been automatically generated. */
+/* DO NOT EDIT, or your changes WILL BE LOST! */
+
+/* Copyright (c) %d %s
+   All rights reserved.
+
+   Redistribution and use in source and binary forms, with or without
+   modification, are permitted provided that the following conditions are met:
+
+   * Redistributions of source code must retain the above copyright
+     notice, this list of conditions and the following disclaimer.
+
+   * Redistributions in binary form must reproduce the above copyright
+     notice, this list of conditions and the following disclaimer in
+     the documentation and/or other materials provided with the
+     distribution.
+
+   * Neither the name of the copyright holders nor the names of
+     contributors may be used to endorse or promote products derived
+     from this software without specific prior written permission.
+
+   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+   POSSIBILITY OF SUCH DAMAGE. */
+""" % (time.localtime()[0], user)
+
+# avoid CVS munging with this here in the script
+print '/* $Id' + '$ */\n'
+
+print '''
+/** \\addtogroup avr_interrupts
+
+@{
+
+\\anchor avr_signames
+<small>
+<table border="3">
+  <tr>
+    <td width="20%"><strong>Vector name</strong></td>
+    <td width="20%"><strong>Old vector name</strong></td>
+    <td width="20%"><strong>Description</strong></td>
+    <td width="40%"><strong>Applicable for device</strong></td>
+  </tr>
+'''
+
+vecs = docs.keys()
+vecs.sort()
+for vecname in vecs:
+    x = docs[vecname]
+    nlines = len(x[2])
+    print '  <tr>'
+    print '    <td>' + vecname + '</td>'
+    try:
+        print '    <td>' + x[0] + '</td>'
+    except TypeError:
+        print '    <td>' + ', '.join(x[0]) + '</td>'
+    print '    <td>' + x[1] + '</td>'
+    print '    <td>' + ', '.join(x[2]) + '</td>'
+    print '  </tr>'
+
+print """</table>
+</small>
+
+@}*/
+"""
+
+sys.stdout.close()
+sys.stdout = savedstdout
+
+print "done."
diff -urBbN --exclude Makefile.in avr-libc-2.0.0-orig/xml/Validate.py avr-libc-r2546/xml/Validate.py
--- avr-libc-2.0.0-orig/xml/Validate.py	1970-01-01 04:00:00.000000000 +0400
+++ avr-libc-r2546/xml/Validate.py	2018-05-22 08:51:53.000000000 +0400
@@ -0,0 +1,56 @@
+#! /usr/bin/env python
+#
+# Copyright (c) 2004  Theodore A. Roth
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#
+# * Redistributions of source code must retain the above copyright
+#   notice, this list of conditions and the following disclaimer.
+#
+# * Redistributions in binary form must reproduce the above copyright
+#   notice, this list of conditions and the following disclaimer in
+#   the documentation and/or other materials provided with the
+#   distribution.
+#
+# * Neither the name of the copyright holders nor the names of
+#   contributors may be used to endorse or promote products derived
+#   from this software without specific prior written permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+# POSSIBILITY OF SUCH DAMAGE.
+#
+# $Id: Validate.py 605 2004-11-02 16:01:29Z troth $
+#
+
+#
+# Simple script for validating xml files.
+#
+# Usage: ./Validate.py foo.xml bar.xml ...
+#
+
+import os
+import sys
+import glob
+
+from xml.parsers.xmlproc import xmlval
+from xml.parsers.xmlproc.utils import ErrorPrinter
+
+for arg in sys.argv[1:]:
+    for filename in glob.glob (arg):
+        print 'Validating %s' % (arg)
+
+        parser = xmlval.XMLValidator()
+        parser.set_error_handler(ErrorPrinter(parser, out=sys.stdout))
+
+        parser.parse_resource (arg)
