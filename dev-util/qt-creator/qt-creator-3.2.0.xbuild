# Copyright 2010-2014 Chernov A.A.
# Distributed under the terms of the GNU General Public License v2

DESCRIPTION="Lightweight IDE for C++ development centering around Qt"

HOMEPAGE="http://qt-project.org/wiki/Category:Tools::QtCreator"

LICENSE="LGPL-2.1"

MIN_QT_PV="5.3.1"

DEPEND="dev-lang/perl"
RDEPEND=">=dev-qt/qtbase-${MIN_QT_PV}
		>=dev-qt/qtsvg-${MIN_QT_PV}
		>=dev-qt/qtscript-${MIN_QT_PV}
		>=dev-qt/qttools-${MIN_QT_PV}
		>=dev-qt/qtdeclarative-${MIN_QT_PV}"

MY_P=${PN}-opensource-src-${PV}

SRC_URI="http://download.qt-project.org/official_releases/qtcreator/3.2/${PV}/${MY_P}.tar.gz"

SOURCES_DIR="${MY_P}"

PATH=${PERL_PATH}:${PREFIX}/qt5/bin:${PATH}

src_unpack()
{
	unpack_one "${MY_P}.tar.gz" ign
	cd "${MY_P}"
}

src_prepare()
{
	epatch "${P}-mingw.patch"
}

src_configure()
{
	qmake -recursive
}

src_install()
{
	make INSTALL_ROOT=${INSTDIR}/${PREFIX}/qt5/QtCreator install
	if [ $? -eq 0 ]
	then
		eend "make install successfull."
	else
		eerror "make install failed!"
	fi
}
