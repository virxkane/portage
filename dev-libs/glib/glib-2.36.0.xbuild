# Copyright 2010-2013 Chernov A.A.
# Distributed under the terms of the GNU General Public License v2

DESCRIPTION="The GLib library of C routines"

HOMEPAGE="http://ftp.gnome.org/pub/GNOME/sources/glib/"

LICENSE="LGPL-2"

#   external dependencies:
# python???

RDEPEND="sys-devel/gettext
		sys-libs/zlib
		>=dev-libs/libffi-3.0.0"
DEPEND="dev-util/pkgconfig
		sys-devel/libiconv"

SRC_URI="http://ftp.gnome.org/pub/GNOME/sources/${PN}/2.36/${P}.tar.xz"

src_prepare()
{
	epatch "${PN}-2.34.3-no-python.patch"
	epatch "${P}-xxx.patch"
	AT_M4DIR="m4macros" eautoreconf
}

src_configure()
{
	econf --disable-debug --enable-shared \
		--with-threads=win32 --disable-gtk-doc --disable-modular-tests
	
	# to-do: disable libelf in generated config.h
	cat config.h | sed -e 's/^#define\ HAVE_LIBELF\ 1.*$/\/\/\ removed by Caine./' > config.h.new
	mv -f config.h.new config.h
}
